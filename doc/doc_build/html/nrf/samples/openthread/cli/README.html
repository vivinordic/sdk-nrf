<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thread: CLI &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script src="../../../_static/tabs.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../../_static/js/ncs.js"
></script>
<script src="../../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Thread: CoAP Client" href="../coap_client/README.html" />
    <link rel="prev" title="Thread samples" href="../../thread.html" />
<link
  href="../../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../protocols.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications.html">Applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../samples.html">Samples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../bl.html">Bluetooth samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../crypto.html">Cryptography samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../edge.html">Edge Impulse samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gazell.html">Gazell samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matter.html">Matter samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nfc.html">NFC samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nrf5340.html">nRF5340 samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nrf9160.html">nRF9160 samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tfm.html">Trusted Firmware-M (TF-M) samples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../thread.html">Thread samples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Thread: CLI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user-interface">User interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-and-running">Building and running</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../coap_client/README.html">Thread: CoAP Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../coap_server/README.html">Thread: CoAP Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../coprocessor/README.html">Thread: Co-processor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../zigbee.html">Zigbee samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wifi.html">Wi-Fi samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other.html">Other samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../samples.html">Samples</a></li>
          <li class="breadcrumb-item"><a href="../../thread.html">Thread samples</a></li>
      <li class="breadcrumb-item active">Thread: CLI</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/samples/openthread/cli/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="thread-cli">
<span id="ot-cli-sample"></span><h1>Thread: CLI<a class="headerlink" href="#thread-cli" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#requirements" id="id6">Requirements</a></p></li>
<li><p><a class="reference internal" href="#overview" id="id7">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#certification-tests-with-cli-sample" id="id8">Certification tests with CLI sample</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#user-interface" id="id9">User interface</a></p>
<ul>
<li><p><a class="reference internal" href="#diagnostic-module" id="id10">Diagnostic module</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuration" id="id11">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#configuration-files" id="id12">Configuration files</a></p></li>
<li><p><a class="reference internal" href="#fem-support" id="id13">FEM support</a></p></li>
<li><p><a class="reference internal" href="#memory-optimization" id="id14">Memory optimization</a></p></li>
<li><p><a class="reference internal" href="#serial-transport" id="id15">Serial transport</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-and-running" id="id16">Building and running</a></p>
<ul>
<li><p><a class="reference internal" href="#testing" id="id17">Testing</a></p></li>
<li><p><a class="reference internal" href="#power-consumption-measurements" id="id18">Power consumption measurements</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dependencies" id="id19">Dependencies</a></p></li>
</ul>
</div>
<p>The <a class="reference internal" href="../../../protocols/thread/index.html#ug-thread"><span class="std std-ref">Thread</span></a> CLI sample demonstrates how to send commands to a Thread device using the OpenThread Command Line Interface (CLI).
The CLI is integrated into the Zephyr shell.</p>
<section id="requirements">
<h2><a class="toc-backref" href="#id6">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h2>
<p>The sample supports the following development kits for testing the network status:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 6%" />
<col style="width: 44%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Hardware platforms</p></th>
<th class="head"><p>PCA</p></th>
<th class="head"><p>Board name</p></th>
<th class="head"><p>Build target</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../../working_with_nrf/nrf53/nrf5340.html#ug-nrf5340"><span class="std std-ref">nRF5340 DK</span></a></p></td>
<td><p>PCA10095</p></td>
<td><p><span class="xref std std-ref">nrf5340dk_nrf5340</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf5340dk_nrf5340_cpuapp_ns</span></code>
<code class="docutils literal notranslate"><span class="pre">nrf5340dk_nrf5340_cpuapp</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../working_with_nrf/nrf52/developing.html#ug-nrf52"><span class="std std-ref">nRF52840 Dongle</span></a></p></td>
<td><p>PCA10059</p></td>
<td><p><span class="xref std std-ref">nrf52840dongle_nrf52840</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf52840dongle_nrf52840</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../working_with_nrf/nrf52/developing.html#ug-nrf52"><span class="std std-ref">nRF52840 DK</span></a></p></td>
<td><p>PCA10056</p></td>
<td><p><span class="xref std std-ref">nrf52840dk_nrf52840</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf52840dk_nrf52840</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../working_with_nrf/nrf52/developing.html#ug-nrf52"><span class="std std-ref">nRF52833 DK</span></a></p></td>
<td><p>PCA10100</p></td>
<td><p><span class="xref std std-ref">nrf52833dk_nrf52833</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf52833dk_nrf52833</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../app_dev/working_with_fem/index.html#ug-radio-fem"><span class="std std-ref">nRF21540 DK</span></a></p></td>
<td><p>PCA10112</p></td>
<td><p><span class="xref std std-ref">nrf21540dk_nrf52840</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf21540dk_nrf52840</span></code></p></td>
</tr>
</tbody>
</table>
<p>Optionally, you can use one or more compatible development kits programmed with this sample or another <a class="reference internal" href="../../thread.html#openthread-samples"><span class="std std-ref">Thread sample</span></a> for <a class="reference internal" href="#ot-cli-sample-testing-multiple"><span class="std std-ref">testing communication or diagnostics</span></a> and <a class="reference internal" href="../../../protocols/thread/overview/commissioning.html#thread-ot-commissioning-configuring-on-mesh"><span class="std std-ref">Configuring on-mesh Thread commissioning</span></a>.</p>
<p>You need <a class="reference external" href="https://infocenter.nordicsemi.com/topic/ug_sniffer_802154/UG/sniffer_802154/intro_802154.html">nRF Sniffer for 802.15.4</a> to observe messages sent from the router to the leader kit when <a class="reference internal" href="#ot-cli-sample-testing-multiple-v12"><span class="std std-ref">Testing Thread 1.2 and Thread 1.3 features</span></a>.</p>
<p>When built for an <code class="docutils literal notranslate"><span class="pre">_ns</span></code> build target, the sample is configured to compile and run as a non-secure application with <a class="reference internal" href="../../../app_dev/board_support/index.html#app-boards-spe-nspe-cpuapp-ns"><span class="std std-ref">Cortex-M Security Extensions enabled</span></a>.
Therefore, it automatically includes <a class="reference internal" href="../../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M</span></a> that prepares the required peripherals and secure services to be available for the application.</p>
</section>
<section id="overview">
<h2><a class="toc-backref" href="#id7">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The sample demonstrates the usage of commands listed in <a class="reference external" href="https://github.com/openthread/openthread/blob/main/src/cli/README.md">OpenThread CLI Reference</a>.
OpenThread CLI is integrated into the system shell accessible over serial connection.
To indicate a Thread command, the <code class="docutils literal notranslate"><span class="pre">ot</span></code> keyword needs to precede the command.</p>
<p>The number of commands you can test depends on the application configuration.
The CLI sample comes with the <a class="reference internal" href="../../../protocols/thread/prebuilt_libs.html#thread-ug-feature-sets"><span class="std std-ref">full set of OpenThread functionalities</span></a> enabled (<code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_OPENTHREAD_NORDIC_LIBRARY_MASTER</span></code>).
Thread 1.2 version is selected as default.</p>
<p>If used alone, the sample allows you to test the network status.
It is recommended to use at least two development kits running the same sample for testing the communication.</p>
<section id="certification-tests-with-cli-sample">
<span id="ot-cli-sample-thread-certification"></span><h3><a class="toc-backref" href="#id8">Certification tests with CLI sample</a><a class="headerlink" href="#certification-tests-with-cli-sample" title="Permalink to this heading"></a></h3>
<p>You can use the Thread CLI sample to run certification tests.
See <a class="reference internal" href="../../../protocols/thread/certification.html#ug-thread-cert"><span class="std std-ref">Thread certification</span></a> for information on how to use this sample on Thread Certification Test Harness.</p>
</section>
</section>
<section id="user-interface">
<h2><a class="toc-backref" href="#id9">User interface</a><a class="headerlink" href="#user-interface" title="Permalink to this heading"></a></h2>
<p>All interactions with the application are handled using serial communication.
See <a class="reference external" href="https://github.com/openthread/openthread/blob/main/src/cli/README.md">OpenThread CLI Reference</a> for the list of available serial commands.</p>
<section id="diagnostic-module">
<span id="ot-cli-sample-diag-module"></span><h3><a class="toc-backref" href="#id10">Diagnostic module</a><a class="headerlink" href="#diagnostic-module" title="Permalink to this heading"></a></h3>
<p>By default, the CLI sample comes with the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_OPENTHREAD_NORDIC_LIBRARY_MASTER</span></code> <a class="reference internal" href="../../../protocols/thread/prebuilt_libs.html#thread-ug-feature-sets"><span class="std std-ref">feature set</span></a> enabled, which allows you to use Zephyr’s diagnostic module with its <code class="docutils literal notranslate"><span class="pre">diag</span></code> commands.
Use these commands to manually check hardware-related functionalities without running a Thread network.
For example, to ensure radio communication is working when adding a new functionality or during the manufacturing process.
See <a class="reference internal" href="#testing-diagnostic-module">Testing diagnostic module</a> section for an example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you disable the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_OPENTHREAD_NORDIC_LIBRARY_MASTER</span></code> feature set, you can enable the diagnostic module with the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_OPENTHREAD_DIAG</span></code> Kconfig option.</p>
</div>
</section>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id11">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>See <a class="reference internal" href="../../../getting_started/modifying.html#configure-application"><span class="std std-ref">Configuring your application</span></a> for information about how to permanently or temporarily change the configuration.</p>
<section id="configuration-files">
<span id="ot-cli-sample-activating-variants"></span><h3><a class="toc-backref" href="#id12">Configuration files</a><a class="headerlink" href="#configuration-files" title="Permalink to this heading"></a></h3>
<p>The sample provides predefined configuration files for typical use cases, and to activate sample extensions.
You can find the configuration files in the root directory of the sample.</p>
<p>Specify the corresponding file names in the <strong class="makevar">OVERLAY_CONFIG</strong> option when building.
See <a class="reference internal" href="../../../getting_started/modifying.html#cmake-options"><span class="std std-ref">Providing CMake options</span></a> for instructions on how to add this option.
For more information about using configuration overlay files, see <span class="xref std std-ref">zephyr:important-build-vars</span> in the Zephyr documentation.</p>
<p>The following configuration files are available:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">overlay-usb.conf</span></code> - Enables USB transport support.
Additionally, you need to set <strong class="makevar">DTC_OVERLAY_FILE</strong> to <code class="file docutils literal notranslate"><span class="pre">usb.overlay</span></code>.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">overlay-logging.conf</span></code> - Enables logging using RTT.
For additional options, refer to <a class="reference internal" href="../../../app_dev/logging/index.html#ug-logging-backends-rtt"><span class="std std-ref">RTT logging</span></a>.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">overlay-debug.conf</span></code> - Enables debugging the Thread sample with GDB thread awareness.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">overlay-ci.conf</span></code> - Disables boot banner and shell prompt.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">overlay-multiprotocol.conf</span></code> - Enables Bluetooth LE support in this sample.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">overlay-tcp.conf</span></code> - Enables experimental TCP support in this sample.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">overlay-low_power.conf</span></code> - Enables low power consumption mode in this sample.
Additionally, you need to set <strong class="makevar">DTC_OVERLAY_FILE</strong> to <code class="file docutils literal notranslate"><span class="pre">low_power.overlay</span></code>.</p></li>
</ul>
</section>
<section id="fem-support">
<h3><a class="toc-backref" href="#id13">FEM support</a><a class="headerlink" href="#fem-support" title="Permalink to this heading"></a></h3>
<p>You can add support for the nRF21540 front-end module to this sample by using one of the following options, depending on your hardware:</p>
<ul>
<li><p>Build the sample for one board that contains the nRF21540 FEM, such as <span class="xref std std-ref">nrf21540dk_nrf52840</span>.</p></li>
<li><p>Manually create a devicetree overlay file that describes how FEM is connected to the nRF5 SoC in your device.
See <span class="xref std std-ref">zephyr:set-devicetree-overlays</span> for different ways of adding the overlay file.</p></li>
<li><p>Provide nRF21540 FEM capabilities by using a <span class="xref std std-ref">shield</span>, for example the <a class="reference internal" href="../../../app_dev/working_with_fem/index.html#ug-radio-fem-nrf21540-ek"><span class="std std-ref">nRF21540 EK</span></a> shield that is available in the nRF Connect SDK.
In this case, build the project for a board connected to the shield you are using with an appropriate variable included in the build command, for example <code class="docutils literal notranslate"><span class="pre">SHIELD=nrf21540_ek</span></code>.
This variable instructs the build system to append the appropriate devicetree overlay file.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-blJGIENvbm5lY3QgZm9yIFZTIENvZGU=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-blJGIENvbm5lY3QgZm9yIFZTIENvZGU=" name="blJGIENvbm5lY3QgZm9yIFZTIENvZGU=" role="tab" tabindex="0">nRF Connect for VS Code</button><button aria-controls="panel-0-Q29tbWFuZCBsaW5l" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="-1">Command line</button></div><div aria-labelledby="tab-0-blJGIENvbm5lY3QgZm9yIFZTIENvZGU=" class="sphinx-tabs-panel group-tab" id="panel-0-blJGIENvbm5lY3QgZm9yIFZTIENvZGU=" name="blJGIENvbm5lY3QgZm9yIFZTIENvZGU=" role="tabpanel" tabindex="0"><p>To build the sample in the nRF Connect for VS Code IDE for an nRF52840 DK with the nRF21540 EK attached, add the shield variable in the build configuration’s <span class="guilabel">Extra CMake arguments</span> and rebuild the build configuration.
For example: <code class="docutils literal notranslate"><span class="pre">-DSHIELD=nrf21540_ek</span></code>.</p>
<p>See <a class="reference external" href="https://nrfconnect.github.io/vscode-nrf-connect/guides/build_config.html">nRF Connect for VS Code extension pack</a> documentation for more information.</p>
</div><div aria-labelledby="tab-0-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>To build the sample from the command line for an nRF52840 DK with the nRF21540 EK attached, use the following command within the sample directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west build -b nrf52840dk_nrf52840 -- -DSHIELD=nrf21540_ek</span>
</pre></div>
</div>
</div></div>
<p>See <a class="reference internal" href="../../../app_dev/working_with_fem/index.html#ug-radio-fem-nrf21540-ek-programming"><span class="std std-ref">Programming nRF21540 EK</span></a> for information about how to program when you are using a board with a network core, for example nRF5340 DK.</p>
</li>
</ul>
<p>Each of these options adds the description of the nRF21540 FEM to the devicetree.
See <a class="reference internal" href="../../../app_dev/working_with_fem/index.html#ug-radio-fem"><span class="std std-ref">Working with RF front-end modules</span></a> for more information about FEM in the nRF Connect SDK.</p>
<p>To add support for other front-end modules, add the respective devicetree file entries to the board devicetree file or the devicetree overlay file.</p>
</section>
<section id="memory-optimization">
<span id="ot-cli-sample-minimal"></span><h3><a class="toc-backref" href="#id14">Memory optimization</a><a class="headerlink" href="#memory-optimization" title="Permalink to this heading"></a></h3>
<p>See <a class="reference internal" href="../../../app_dev/optimizing/memory.html#app-memory"><span class="std std-ref">Memory footprint optimization</span></a> for actions and configuration options you can use to optimize the memory footprint of the sample.</p>
</section>
<section id="serial-transport">
<h3><a class="toc-backref" href="#id15">Serial transport</a><a class="headerlink" href="#serial-transport" title="Permalink to this heading"></a></h3>
<p>The Thread CLI sample supports UART and USB CDC ACM as serial transports.
By default, it uses UART transport.
To switch to USB transport, <a class="reference internal" href="#ot-cli-sample-activating-variants"><span class="std std-ref">activate the USB overlay extension</span></a>.</p>
</section>
</section>
<section id="building-and-running">
<h2><a class="toc-backref" href="#id16">Building and running</a><a class="headerlink" href="#building-and-running" title="Permalink to this heading"></a></h2>
<p>Make sure to enable the OpenThread stack before building and testing this sample.
See <a class="reference internal" href="../../../protocols/thread/index.html#ug-thread"><span class="std std-ref">Thread</span></a> for more information.</p>
<p>This sample can be found under <code class="file docutils literal notranslate"><span class="pre">samples/openthread/cli</span></code> in the nRF Connect SDK folder structure.</p>
<p>When built as firmware image for the <code class="docutils literal notranslate"><span class="pre">_ns</span></code> build target, the sample has Cortex-M Security Extensions (CMSE) enabled and separates the firmware between Non-Secure Processing Environment (NSPE) and Secure Processing Environment (SPE).
Because of this, it automatically includes the <a class="reference internal" href="../../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M (TF-M)</span></a>.
To read more about CMSE, see <a class="reference internal" href="../../../app_dev/board_support/index.html#app-boards-spe-nspe"><span class="std std-ref">Processing environments</span></a>.</p>
<p>To build the sample with Visual Studio Code, follow the steps listed on the <a class="reference external" href="https://nrfconnect.github.io/vscode-nrf-connect/get_started/build_app_ncs.html">How to build an application</a> page in the nRF Connect for VS Code extension documentation.
See <a class="reference internal" href="../../../getting_started/programming.html#gs-programming"><span class="std std-ref">Building and programming an application</span></a> for other building and programming scenarios and <a class="reference internal" href="../../../getting_started/testing.html#gs-testing"><span class="std std-ref">Testing and debugging an application</span></a> for general information about testing and debugging in the nRF Connect SDK.</p>
<p>To update the OpenThread libraries provided by <code class="docutils literal notranslate"><span class="pre">nrfxlib</span></code>, invoke <code class="docutils literal notranslate"><span class="pre">west</span> <span class="pre">build</span> <span class="pre">-b</span> <span class="pre">nrf52840dk_nrf52840</span> <span class="pre">-t</span> <span class="pre">install_openthread_libraries</span></code>.</p>
<section id="testing">
<span id="ot-cli-sample-testing"></span><h3><a class="toc-backref" href="#id17">Testing</a><a class="headerlink" href="#testing" title="Permalink to this heading"></a></h3>
<p>After building the sample and programming it to your development kit, complete the following steps to test it:</p>
<ol class="arabic">
<li><p>Turn on the development kit.</p></li>
<li><p>Connect to the kit with a terminal emulator that supports VT100/ANSI escape characters (for example, PuTTY).
See <a class="reference internal" href="../../../getting_started/testing.html#putty"><span class="std std-ref">How to connect with PuTTY</span></a> for the required settings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This sample has Hardware Flow Control mechanism enabled by default in serial communication.
When enabled, it allows devices to manage transmission by informing each other about their current state, and ensures more reliable connection in high-speed communication scenarios.</p>
</div>
</li>
<li><p>Configure the required Thread network parameters with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">channel</span></code>, <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">panid</span></code>, and <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">networkkey</span></code> commands.
Make sure to use the same parameters for all nodes that you add to the network.
The following example uses the default OpenThread parameters:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>channel<span class="w"> </span><span class="m">11</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>panid<span class="w"> </span>0xabcd
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>networkkey<span class="w"> </span>00112233445566778899aabbccddeeff
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Enable the Thread network with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">ifconfig</span> <span class="pre">up</span></code> and <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">thread</span> <span class="pre">start</span></code> commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ifconfig<span class="w"> </span>up
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>thread<span class="w"> </span>start
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Invoke some of the OpenThread commands:</p>
<ol class="loweralpha">
<li><p>Test the state of the Thread network with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">state</span></code> command.
For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>state
<span class="go">leader</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Get the Thread network name with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">networkname</span></code> command.
For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>networkname
<span class="go">OpenThread</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Get the IP addresses of the current Thread network with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">ipaddr</span></code> command.
For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ipaddr
<span class="go">fdde:ad00:beef:0:0:ff:fe00:800</span>
<span class="go">fdde:ad00:beef:0:3102:d00b:5cbe:a61</span>
<span class="go">fe80:0:0:0:8467:5746:a29f:1196</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ol>
<section id="testing-with-multiple-kits">
<span id="ot-cli-sample-testing-multiple"></span><h4>Testing with multiple kits<a class="headerlink" href="#testing-with-multiple-kits" title="Permalink to this heading"></a></h4>
<p>If you are using more than one development kit for testing the CLI sample, you can also complete additional testing procedures.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following testing procedures assume you are using two development kits.</p>
</div>
<section id="testing-communication-between-kits">
<h5>Testing communication between kits<a class="headerlink" href="#testing-communication-between-kits" title="Permalink to this heading"></a></h5>
<p>To test communication between kits, complete the following steps:</p>
<ol class="arabic">
<li><p>Make sure both development kits are programmed with the CLI sample.</p></li>
<li><p>Turn on the developments kits.</p></li>
<li><p>Connect to both kits with a terminal emulator that supports VT100/ANSI escape characters (for example, PuTTY).
See <a class="reference internal" href="../../../getting_started/testing.html#putty"><span class="std std-ref">How to connect with PuTTY</span></a> for the required settings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This sample has Hardware Flow Control mechanism enabled by default in serial communication.
When enabled, it allows devices to manage transmission by informing each other about their current state, and ensures more reliable connection in high-speed communication scenarios.</p>
</div>
</li>
<li><p>Configure the required Thread network parameters with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">channel</span></code>, <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">panid</span></code>, and <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">networkkey</span></code> commands.
Make sure to use the same parameters for all nodes that you add to the network.
The following example uses the default OpenThread parameters:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>channel<span class="w"> </span><span class="m">11</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>panid<span class="w"> </span>0xabcd
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>networkkey<span class="w"> </span>00112233445566778899aabbccddeeff
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Enable the Thread network with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">ifconfig</span> <span class="pre">up</span></code> and <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">thread</span> <span class="pre">start</span></code> commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ifconfig<span class="w"> </span>up
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>thread<span class="w"> </span>start
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Test communication between the kits with the following command:</p>
<pre class="highlight literal-block">ot ping <em>ip_address_of_the_first_kit</em></pre>
<p>For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ping<span class="w"> </span>fdde:ad00:beef:0:3102:d00b:5cbe:a61
<span class="go">16 bytes from fdde:ad00:beef:0:3102:d00b:5cbe:a61: icmp_seq=3 hlim=64 time=23ms</span>
<span class="go">1 packets transmitted, 1 packets received. Packet loss = 0.0%. Round-trip min/av</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="testing-diagnostic-module">
<h5>Testing diagnostic module<a class="headerlink" href="#testing-diagnostic-module" title="Permalink to this heading"></a></h5>
<p>To test diagnostic commands, complete the following steps:</p>
<ol class="arabic">
<li><p>Make sure both development kits are programmed with the CLI sample.</p></li>
<li><p>Turn on the developments kits.</p></li>
<li><p>Connect to both kits with a terminal emulator that supports VT100/ANSI escape characters (for example, PuTTY).
See <a class="reference internal" href="../../../getting_started/testing.html#putty"><span class="std std-ref">How to connect with PuTTY</span></a> for the required settings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This sample has Hardware Flow Control mechanism enabled by default in serial communication.
When enabled, it allows devices to manage transmission by informing each other about their current state, and ensures more reliable connection in high-speed communication scenarios..</p>
</div>
</li>
<li><p>Make sure that the diagnostic module is enabled and configured with proper radio channel and transmission power.
Run the following commands on both devices:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>diag<span class="w"> </span>start
<span class="go">start diagnostics mode</span>
<span class="go">status 0x00</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>diag<span class="w"> </span>channel<span class="w"> </span><span class="m">11</span>
<span class="go">set channel to 11</span>
<span class="go">status 0x00</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>diag<span class="w"> </span>power<span class="w"> </span><span class="m">0</span>
<span class="go">set tx power to 0 dBm</span>
<span class="go">status 0x00</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Transmit a fixed number of packets with the given length from one of the devices.
For example, to transmit 20 packets that contain 100 B of random data, run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>diag<span class="w"> </span>send<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">100</span>
<span class="go">sending 0x14 packet(s), length 0x64</span>
<span class="go">status 0x00</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>To read the radio statistics on the other device, run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>diag<span class="w"> </span>stats
<span class="go">received packets: 20</span>
<span class="go">sent packets: 0</span>
<span class="go">first received packet: rssi=-29, lqi=255</span>
<span class="go">last received packet: rssi=-30, lqi=255</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="testing-thread-1-2-and-thread-1-3-features">
<span id="ot-cli-sample-testing-multiple-v12"></span><h5>Testing Thread 1.2 and Thread 1.3 features<a class="headerlink" href="#testing-thread-1-2-and-thread-1-3-features" title="Permalink to this heading"></a></h5>
<p>To test the Thread 1.2 and Thread 1.3 features, complete the following steps:</p>
<ol class="arabic">
<li><p>Enable the extra options <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_OPENTHREAD_BORDER_ROUTER</span></code>, <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_OPENTHREAD_BACKBONE_ROUTER</span></code> and <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_OPENTHREAD_SRP_SERVER</span></code> when building the CLI sample.</p></li>
<li><p>Make sure both development kits are programmed with the CLI sample.</p></li>
<li><p>Turn on the developments kits.</p></li>
<li><p>Connect to both kits with a terminal emulator that supports VT100/ANSI escape characters (for example, PuTTY).
See <a class="reference internal" href="../../../getting_started/testing.html#putty"><span class="std std-ref">How to connect with PuTTY</span></a> for the required settings.</p></li>
<li><p>Configure the required Thread network parameters with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">channel</span></code>, <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">panid</span></code>, and <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">networkkey</span></code> commands.
Make sure to use the same parameters for all nodes that you add to the network.
The following example uses the default OpenThread parameters:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>channel<span class="w"> </span><span class="m">11</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>panid<span class="w"> </span>0xabcd
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>networkkey<span class="w"> </span>00112233445566778899aabbccddeeff
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Enable the Thread network with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">ifconfig</span> <span class="pre">up</span></code> and <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">thread</span> <span class="pre">start</span></code> commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ifconfig<span class="w"> </span>up
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>thread<span class="w"> </span>start
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Test the state of the Thread network with the <code class="docutils literal notranslate"><span class="pre">ot</span> <span class="pre">state</span></code> command to see which kit is the leader:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>state
<span class="go">leader</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>On the leader kit, enable the Backbone Router function:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>bbr<span class="w"> </span><span class="nb">enable</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>On the leader kit, configure the Domain prefix:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>prefix<span class="w"> </span>add<span class="w"> </span>fd00:7d03:7d03:7d03::/64<span class="w"> </span>prosD<span class="w"> </span>med
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>netdata<span class="w"> </span>register
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>On the router kit, display the autoconfigured Domain Unicast Address and set another one manually:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ipaddr
<span class="go">fd00:7d03:7d03:7d03:ee2d:eed:4b59:2736</span>
<span class="go">fdde:ad00:beef:0:0:ff:fe00:c400</span>
<span class="go">fdde:ad00:beef:0:e0fc:dc28:1d12:8c2</span>
<span class="go">fe80:0:0:0:acbd:53bf:1461:a861</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>dua<span class="w"> </span>iid<span class="w"> </span><span class="m">0004000300020001</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>ipaddr
<span class="go">fd00:7d03:7d03:7d03:4:3:2:1</span>
<span class="go">fdde:ad00:beef:0:0:ff:fe00:c400</span>
<span class="go">fdde:ad00:beef:0:e0fc:dc28:1d12:8c2</span>
<span class="go">fe80:0:0:0:acbd:53bf:1461:a861</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>On the router kit, configure a multicast address with a scope greater than realm-local:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ipmaddr<span class="w"> </span>add<span class="w"> </span>ff04::1
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>ipmaddr
<span class="go">ff04:0:0:0:0:0:0:1</span>
<span class="go">ff33:40:fdde:ad00:beef:0:0:1</span>
<span class="go">ff32:40:fdde:ad00:beef:0:0:1</span>
<span class="go">ff02:0:0:0:0:0:0:2</span>
<span class="go">ff03:0:0:0:0:0:0:2</span>
<span class="go">ff02:0:0:0:0:0:0:1</span>
<span class="go">ff03:0:0:0:0:0:0:1</span>
<span class="go">ff03:0:0:0:0:0:0:fc</span>
<span class="go">Done</span>
</pre></div>
</div>
<p>The router kit sends an <code class="docutils literal notranslate"><span class="pre">MLR.req</span></code> message and a <code class="docutils literal notranslate"><span class="pre">DUA.req</span></code> message to the leader kit (Backbone Router).
Use the <a class="reference external" href="https://infocenter.nordicsemi.com/topic/ug_sniffer_802154/UG/sniffer_802154/intro_802154.html">nRF Sniffer for 802.15.4</a> to observe this.</p>
</li>
<li><p>On the leader kit, list the IPv6 addresses:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ipaddr
<span class="go">fd00:7d03:7d03:7d03:84c9:572d:be24:cbe</span>
<span class="go">fdde:ad00:beef:0:0:ff:fe00:fc10</span>
<span class="go">fdde:ad00:beef:0:0:ff:fe00:fc38</span>
<span class="go">fdde:ad00:beef:0:0:ff:fe00:fc00</span>
<span class="go">fdde:ad00:beef:0:0:ff:fe00:7000</span>
<span class="go">fdde:ad00:beef:0:a318:bf4f:b9c6:5f7d</span>
<span class="go">fe80:0:0:0:10b1:93ea:c0ee:eeb7</span>
</pre></div>
</div>
<p>Note down the link-local address.
You must use this address when sending Link Metrics commands from the router kit to the leader kit.</p>
<p>The following steps use the address <code class="docutils literal notranslate"><span class="pre">fe80:0:0:0:10b1:93ea:c0ee:eeb7</span></code>.
Replace it with the link-local address of your leader kit in all commands.</p>
</li>
<li><p>Run the following commands on the router kit:</p>
<ol class="loweralpha">
<li><p>Reattach the router kit as Sleepy End Device (SED) with a polling period of three seconds:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>pollperiod<span class="w"> </span><span class="m">3000</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>mode<span class="w"> </span>-
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Perform a Link Metrics query (Single Probe):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>linkmetrics<span class="w"> </span>query<span class="w"> </span>fe80:0:0:0:10b1:93ea:c0ee:eeb7<span class="w"> </span>single<span class="w"> </span>qmr
<span class="go">Done</span>
<span class="go">Received Link Metrics Report from: fe80:0:0:0:10b1:93ea:c0ee:eeb7</span>
<span class="go">- LQI: 220 (Exponential Moving Average)</span>
<span class="go">- Margin: 60 (dB) (Exponential Moving Average)</span>
<span class="go">- RSSI: -40 (dBm) (Exponential Moving Average)</span>
</pre></div>
</div>
</li>
<li><p>Send a Link Metrics Management Request to configure a Forward Tracking Series:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>linkmetrics<span class="w"> </span>mgmt<span class="w"> </span>fe80:0:0:0:10b1:93ea:c0ee:eeb7<span class="w"> </span>forward<span class="w"> </span><span class="m">1</span><span class="w"> </span>dra<span class="w"> </span>pqmr
<span class="go">Done</span>
<span class="go">Received Link Metrics Management Response from: fe80:0:0:0:10b1:93ea:c0ee:eeb7</span>
<span class="go">Status: Success</span>
</pre></div>
</div>
</li>
<li><p>Send an MLE Link Probe message to the peer:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>linkmetrics<span class="w"> </span>probe<span class="w"> </span>fe80:0:0:0:10b1:93ea:c0ee:eeb7<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">10</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Perform a Link Metrics query (Forward Tracking Series):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>linkmetrics<span class="w"> </span>query<span class="w"> </span>fe80:0:0:0:10b1:93ea:c0ee:eeb7<span class="w"> </span>forward<span class="w"> </span><span class="m">1</span>
<span class="go">Done</span>
<span class="go">Received Link Metrics Report from: fe80:0:0:0:10b1:93ea:c0ee:eeb7</span>
<span class="go">- PDU Counter: 13 (Count/Summation)</span>
<span class="go">- LQI: 212 (Exponential Moving Average)</span>
<span class="go">- Margin: 60 (dB) (Exponential Moving Average)</span>
<span class="go">- RSSI: -40 (dBm) (Exponential Moving Average)</span>
</pre></div>
</div>
</li>
<li><p>Send a Link Metrics Management Request to register an Enhanced ACK-based Probing:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>linkmetrics<span class="w"> </span>mgmt<span class="w"> </span>fe80:0:0:0:10b1:93ea:c0ee:eeb7<span class="w"> </span>enhanced-ack<span class="w"> </span>register<span class="w"> </span>qm
<span class="go">Done</span>
<span class="go">Received Link Metrics data in Enh Ack from neighbor, short address:0xa400 , extended address:12b193eac0eeeeb7</span>
<span class="go">- LQI: 255 (Exponential Moving Average)</span>
<span class="go">- Margin: 68 (dB) (Exponential Moving Average)</span>
</pre></div>
</div>
</li>
<li><p>Send a Link Metrics Management Request to clear an Enhanced ACK-based Probing:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>linkmetrics<span class="w"> </span>mgmt<span class="w"> </span>fe80:0:0:0:10b1:93ea:c0ee:eeb7<span class="w"> </span>enhanced-ack<span class="w"> </span>clear
<span class="go">Done</span>
<span class="go">Received Link Metrics Management Response from: fe80:0:0:0:10b1:93ea:c0ee:eeb7</span>
<span class="go">Status: Success</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>Verify the Coordinated Sampled Listening (CSL) functionality.</p>
<p>The following steps use the address <code class="docutils literal notranslate"><span class="pre">fe80:0:0:0:acbd:53bf:1461:a861</span></code>.
Replace it with the link-local address of your router kit in all commands.</p>
<ol class="loweralpha">
<li><p>Send an ICMPv6 Echo Request from the leader kit to link-local address of the router kit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ping<span class="w"> </span>fe80:0:0:0:acbd:53bf:1461:a861
<span class="go">16 bytes from fe80:0:0:0:acbd:53bf:1461:a861: icmp_seq=2 hlim=64 time=2494ms</span>
<span class="go">1 packets transmitted, 1 packets received. Packet loss = 0.0%. Round-trip min/a</span>
<span class="go">Done</span>
</pre></div>
</div>
<p>Observe that there is a long latency, up to 3000 ms, on the reply.
This is due to the indirect transmission mechanism based on data polling.</p>
</li>
<li><p>Stop frequent polling on the router kit (now SED) by configuring a polling period of 240 seconds:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>pollperiod<span class="w"> </span><span class="m">240000</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Enable a CSL Receiver on the router kit (now SED) by configuring a CSL period of 0.5 seconds:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>csl<span class="w"> </span>period<span class="w"> </span><span class="m">3125</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Send an ICMPv6 Echo Request from the leader kit to the link-local address of the router kit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>ping<span class="w"> </span>fe80:0:0:0:acbd:53bf:1461:a861
<span class="go">16 bytes from fe80:0:0:0:acbd:53bf:1461:a861: icmp_seq=3 hlim=64 time=421ms</span>
<span class="go">1 packets transmitted, 1 packets received. Packet loss = 0.0%. Round-trip min/a</span>
<span class="go">Done</span>
</pre></div>
</div>
<p>Observe that the reply latency is reduced to a value below 500 ms.
The reduction occurs because the transmission from the leader is performed using CSL, based on the CSL Information Elements sent by the CSL Receiver.</p>
</li>
</ol>
</li>
<li><p>Verify the Service Registration Protocol (SRP) functionality.</p>
<ol class="loweralpha">
<li><p>On the leader kit, enable the SRP Server function:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>server<span class="w"> </span><span class="nb">enable</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Register a <cite>_ipps._tcp`</cite> service on the router kit (now SED):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>client<span class="w"> </span>host<span class="w"> </span>name<span class="w"> </span>my-host
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>client<span class="w"> </span>host<span class="w"> </span>address<span class="w"> </span>fdde:ad00:beef:0:e0fc:dc28:1d12:8c2
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>client<span class="w"> </span>service<span class="w"> </span>add<span class="w"> </span>my-service<span class="w"> </span>_ipps._tcp<span class="w"> </span><span class="m">12345</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>client<span class="w"> </span>autostart<span class="w"> </span><span class="nb">enable</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>On the router kit (now SED), check that the host and service have been successfully registered:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>client<span class="w"> </span>host
<span class="go">name:&quot;my-host&quot;, state:Registered, addrs:[fdde:ad00:beef:0:e0fc:dc28:1d12:8c2]</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
<li><p>Check the host and service on the leader kit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>server<span class="w"> </span>host
<span class="go">my-host.default.service.arpa.</span>
<span class="go">   deleted: false</span>
<span class="go">   addresses: [fdde:ad00:beef:0:e0fc:dc28:1d12:8c2]</span>
<span class="go">Done</span>
<span class="gp">uart:~$ </span>ot<span class="w"> </span>srp<span class="w"> </span>server<span class="w"> </span>service
<span class="go">my-service._ipps._tcp.default.service.arpa.</span>
<span class="go">   deleted: false</span>
<span class="go">   subtypes: (null)</span>
<span class="go">   port: 12345</span>
<span class="go">   priority: 0</span>
<span class="go">   weight: 0</span>
<span class="go">   ttl: 7200</span>
<span class="go">   TXT: []</span>
<span class="go">   host: my-host.default.service.arpa.</span>
<span class="go">   addresses: [fdde:ad00:beef:0:e0fc:dc28:1d12:8c2]</span>
<span class="go">Done</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ol>
</section>
</section>
</section>
<section id="power-consumption-measurements">
<span id="ot-cli-sample-low-power"></span><h3><a class="toc-backref" href="#id18">Power consumption measurements</a><a class="headerlink" href="#power-consumption-measurements" title="Permalink to this heading"></a></h3>
<p>You can use the Thread CLI sample to perform power consumption measurements for Sleepy End Devices.</p>
<p>After building and flashing with <code class="file docutils literal notranslate"><span class="pre">overlay-low_power.conf</span></code> and <code class="file docutils literal notranslate"><span class="pre">low_power.overlay</span></code>, the device will start regular operation with the UART console enabled.
This allows for easy configuration of the device, specifically the Sleepy End Device polling period or the Synchronized Sleepy End Device (SSED) CSL period and other relevant parameters.</p>
<p>When the device becomes attached to a Thread Router it will automatically suspend UART operation and power down unused RAM.
In this mode, you cannot use the CLI to control the device.
Instead, the device will periodically wake up from deep sleep mode and turn on the radio to receive any messages from its parent.</p>
<p>If the device is connected to a <a class="reference external" href="https://infocenter.nordicsemi.com/topic/ug_ppk2/UG/ppk/PPK_user_guide_Intro.html">Power Profiler Kit II (PPK2)</a>, you can perform detailed power consumption measurements.</p>
<p>See <a class="reference internal" href="../../../protocols/thread/overview/power_consumption.html#thread-power-consumption"><span class="std std-ref">OpenThread power consumption</span></a> for more information.</p>
</section>
</section>
<section id="dependencies">
<h2><a class="toc-backref" href="#id19">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this heading"></a></h2>
<p>This sample uses the following Zephyr libraries:</p>
<ul class="simple">
<li><p><span class="xref std std-ref">zephyr:kernel_api</span>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">include/kernel.h</span></code></p></li>
</ul>
</li>
<li><p><span class="xref std std-ref">zephyr:thread_protocol_interface</span></p></li>
</ul>
<p>The following dependencies are added by the optional multiprotocol Bluetooth® LE extension:</p>
<ul class="simple">
<li><p><span class="xref std std-ref">nrfxlib:softdevice_controller</span></p></li>
<li><p><a class="reference internal" href="../../../libraries/bluetooth_services/services/nus.html#nus-service-readme"><span class="std std-ref">Nordic UART Service (NUS)</span></a></p></li>
<li><p>Zephyr’s <span class="xref std std-ref">zephyr:bluetooth_api</span>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/bluetooth.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/gatt.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/hci.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/uuid.h</span></code></p></li>
</ul>
</li>
</ul>
<p>In addition, it uses the following secure firmware component:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../coap_client/README.html" class="btn btn-neutral float-right" title="Thread: CoAP Client" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../thread.html" class="btn btn-neutral" title="Thread samples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>