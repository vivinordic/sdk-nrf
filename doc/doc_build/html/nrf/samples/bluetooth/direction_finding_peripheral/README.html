<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bluetooth: Direction finding peripheral &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../../_static/js/ncs.js"
></script>
<script src="../../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Bluetooth: EnOcean" href="../enocean/README.html" />
    <link rel="prev" title="Bluetooth: Direction finding connectionless beacon" href="../direction_finding_connectionless_tx/README.html" />
<link
  href="../../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../protocols.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications.html">Applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../samples.html">Samples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../bl.html">Bluetooth samples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../central_and_peripheral_hr/README.html">Bluetooth: Central and Peripheral HRS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../central_bas/README.html">Bluetooth: Central BAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../central_hids/README.html">Bluetooth: Central HIDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../central_hr_coded/README.html">Bluetooth: Central Heart Rate Monitor with Coded PHY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../central_nfc_pairing/README.html">Bluetooth: Central NFC pairing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../central_smp_client/README.html">Bluetooth: Central SMP Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../central_uart/README.html">Bluetooth: Central UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="../direct_test_mode/README.html">Bluetooth: Direct Test Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../direction_finding_central/README.html">Bluetooth: Direction finding central</a></li>
<li class="toctree-l3"><a class="reference internal" href="../direction_finding_connectionless_rx/README.html">Bluetooth: Direction finding connectionless locator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../direction_finding_connectionless_tx/README.html">Bluetooth: Direction finding connectionless beacon</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Bluetooth: Direction finding peripheral</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-and-running">Building and Running</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../enocean/README.html">Bluetooth: EnOcean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hci_lpuart/README.html">Bluetooth: HCI low power UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="../llpm/README.html">Bluetooth: LLPM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multiple_adv_sets/README.html">Bluetooth: Multiple advertising sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nrf_dm/README.html">Bluetooth: nRF Distance Measurement with Bluetooth LE discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_ams_client/README.html">Bluetooth: Peripheral AMS client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_ancs_client/README.html">Bluetooth: Peripheral ANCS client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_bms/README.html">Bluetooth: Peripheral Bond Management Service (BMS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_cgms/README.html">Bluetooth: Continuous Glucose Monitoring Service (CGMS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_cts_client/README.html">Bluetooth: Peripheral CTS client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_fast_pair/README.html">Bluetooth: Fast Pair</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_gatt_dm/README.html">Bluetooth: Peripheral GATT Discovery Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_hids_keyboard/README.html">Bluetooth: Peripheral HIDS keyboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_hids_mouse/README.html">Bluetooth: Peripheral HIDS mouse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_hr_coded/README.html">Bluetooth: Peripheral Heart Rate Monitor with Coded PHY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_lbs/README.html">Bluetooth: Peripheral LBS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_mds/README.html">Bluetooth: Peripheral Memfault Diagnostic Service (MDS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_nfc_pairing/README.html">Bluetooth: NFC pairing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_power_profiling/README.html">Bluetooth: Peripheral power profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_rscs/README.html">Bluetooth: Peripheral Running Speed and Cadence Service (RSCS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_status/README.html">Bluetooth: Peripheral Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripheral_uart/README.html">Bluetooth: Peripheral UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="../radio_coex_1wire/README.html">Bluetooth: External radio coexistence using 1-wire interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rpc_host/README.html">Bluetooth: Host for nRF RPC Bluetooth Low Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell_bt_nus/README.html">Bluetooth: NUS shell transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throughput/README.html">Bluetooth: Throughput</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/ble_peripheral_lbs_coex/README.html">Bluetooth: Mesh and peripheral coexistence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/chat/README.html">Bluetooth: Mesh chat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/light/README.html">Bluetooth: Mesh light</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/light_ctrl/README.html">Bluetooth: Mesh light fixture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/light_switch/README.html">Bluetooth: Mesh light switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/sensor_client/README.html">Bluetooth: Mesh sensor observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/sensor_server/README.html">Bluetooth: Mesh sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/silvair_enocean/README.html">Bluetooth: Mesh Silvair EnOcean</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../crypto.html">Cryptography samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../edge.html">Edge Impulse samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gazell.html">Gazell samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matter.html">Matter samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nfc.html">NFC samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nrf5340.html">nRF5340 samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nrf9160.html">nRF9160 samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tfm.html">Trusted Firmware-M (TF-M) samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../thread.html">Thread samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../zigbee.html">Zigbee samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wifi.html">Wi-Fi samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other.html">Other samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../samples.html">Samples</a></li>
          <li class="breadcrumb-item"><a href="../../bl.html">Bluetooth samples</a></li>
      <li class="breadcrumb-item active">Bluetooth: Direction finding peripheral</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/samples/bluetooth/direction_finding_peripheral/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bluetooth-direction-finding-peripheral">
<span id="direction-finding-peripheral"></span><h1>Bluetooth: Direction finding peripheral<a class="headerlink" href="#bluetooth-direction-finding-peripheral" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#requirements" id="id6">Requirements</a></p></li>
<li><p><a class="reference internal" href="#overview" id="id7">Overview</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id8">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#nrf5340-configuration-files" id="id9">nRF5340 configuration files</a></p></li>
<li><p><a class="reference internal" href="#angle-of-arrival-mode" id="id10">Angle of arrival mode</a></p></li>
<li><p><a class="reference internal" href="#antenna-matrix-configuration-for-angle-of-departure-mode" id="id11">Antenna matrix configuration for angle of departure mode</a></p></li>
<li><p><a class="reference internal" href="#antenna-patterns" id="id12">Antenna patterns</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-and-running" id="id13">Building and Running</a></p>
<ul>
<li><p><a class="reference internal" href="#testing" id="id14">Testing</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dependencies" id="id15">Dependencies</a></p></li>
</ul>
</div>
<p>The direction finding peripheral sample demonstrates Bluetooth® LE direction finding transmission as a response to a request received from a connected central device.</p>
<section id="requirements">
<h2><a class="toc-backref" href="#id6">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h2>
<p>The sample supports the following development kits:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 6%" />
<col style="width: 36%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Hardware platforms</p></th>
<th class="head"><p>PCA</p></th>
<th class="head"><p>Board name</p></th>
<th class="head"><p>Build target</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../../working_with_nrf/nrf53/nrf5340.html#ug-nrf5340"><span class="std std-ref">nRF5340 DK</span></a></p></td>
<td><p>PCA10095</p></td>
<td><p><span class="xref std std-ref">nrf5340dk_nrf5340</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf5340dk_nrf5340_cpuapp</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../working_with_nrf/nrf52/developing.html#ug-nrf52"><span class="std std-ref">nRF52833 DK</span></a></p></td>
<td><p>PCA10100</p></td>
<td><p><span class="xref std std-ref">nrf52833dk_nrf52833</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf52833dk_nrf52833</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../working_with_nrf/nrf52/developing.html#ug-nrf52"><span class="std std-ref">nRF52833 DK (emulating nRF52820)</span></a></p></td>
<td><p>PCA10100</p></td>
<td><p><span class="xref std std-ref">nrf52833dk_nrf52820</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf52833dk_nrf52820</span></code></p></td>
</tr>
</tbody>
</table>
<p>The sample also requires an antenna matrix when operating in angle of departure mode.
It can be a Nordic Semiconductor design 12 patch antenna matrix, or any other antenna matrix.</p>
</section>
<section id="overview">
<h2><a class="toc-backref" href="#id7">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The direction finding peripheral sample uses Constant Tone Extension (CTE), that is transmitted with periodic advertising PDUs.</p>
<p>The sample supports two direction finding modes:</p>
<ul class="simple">
<li><p>Angle of Arrival (AoA)</p></li>
<li><p>Angle of Departure (AoD)</p></li>
</ul>
<p>By default, both modes are available in the sample.</p>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id8">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>See <a class="reference internal" href="../../../getting_started/modifying.html#configure-application"><span class="std std-ref">Configuring your application</span></a> for information about how to permanently or temporarily change the configuration.</p>
<p>This sample configuration is split into the following two files:</p>
<ul class="simple">
<li><p>generic configuration is available in the <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file</p></li>
<li><p>board specific configuration is available in the <code class="file docutils literal notranslate"><span class="pre">boards/&lt;BOARD&gt;.conf</span></code> file</p></li>
</ul>
<section id="nrf5340-configuration-files">
<h3><a class="toc-backref" href="#id9">nRF5340 configuration files</a><a class="headerlink" href="#nrf5340-configuration-files" title="Permalink to this heading"></a></h3>
<p>The following additional configuration files are available for the <a class="reference internal" href="../../../working_with_nrf/nrf53/nrf5340.html#ug-nrf5340"><span class="std std-ref">nRF5340 DK</span></a>:</p>
<ul class="simple">
<li><p>The Bluetooth LE controller is part of a child image meant to run on the network core.
The configuration for the child image is stored in the <code class="file docutils literal notranslate"><span class="pre">child_image/</span></code> subdirectory.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">boards/nrf5340dk_nrf5340_cpuapp.overlay</span></code> DTS overlay file is available for the application core.
This file forwards the control over GPIOs to network core, which gives control over GPIOs to the radio peripheral in order to execute antenna switching.</p></li>
</ul>
</section>
<section id="angle-of-arrival-mode">
<h3><a class="toc-backref" href="#id10">Angle of arrival mode</a><a class="headerlink" href="#angle-of-arrival-mode" title="Permalink to this heading"></a></h3>
<p>To build this sample with angle of arrival mode only, set <code class="docutils literal notranslate"><span class="pre">OVERLAY_CONFIG</span></code> to <code class="file docutils literal notranslate"><span class="pre">overlay-aoa.conf</span></code>.</p>
<p>See <a class="reference internal" href="../../../getting_started/modifying.html#cmake-options"><span class="std std-ref">Providing CMake options</span></a> for instructions on how to add this option.
For more information about using configuration overlay files, see <span class="xref std std-ref">zephyr:important-build-vars</span> in the Zephyr documentation.</p>
<p>To build this sample for <a class="reference internal" href="../../../working_with_nrf/nrf53/nrf5340.html#ug-nrf5340"><span class="std std-ref">nRF5340 DK</span></a>, with angle of arrival mode only, add content of <code class="file docutils literal notranslate"><span class="pre">overlay-aoa.conf</span></code> file to <code class="file docutils literal notranslate"><span class="pre">child_image/hci_rpmsg.conf</span></code> file.</p>
</section>
<section id="antenna-matrix-configuration-for-angle-of-departure-mode">
<h3><a class="toc-backref" href="#id11">Antenna matrix configuration for angle of departure mode</a><a class="headerlink" href="#antenna-matrix-configuration-for-angle-of-departure-mode" title="Permalink to this heading"></a></h3>
<p>To use this sample when angle of departure mode is enabled, additional configuration of GPIOs is required to control the antenna array.
Example of such configuration is provided in a devicetree overlay file <code class="file docutils literal notranslate"><span class="pre">nrf52833dk_nrf52833.overlay</span></code>.</p>
<p>The overlay file provides the information about which GPIOs should be used by the Radio peripheral to switch between antenna patches during the CTE transmission in the AoD mode.
At least two GPIOs must be provided to enable antenna switching.</p>
<p>The GPIOs are used by the Radio peripheral in order given by the <code class="docutils literal notranslate"><span class="pre">dfegpio#-gpios</span></code> properties.
The order is important because it affects mapping of the antenna switching patterns to GPIOs (see <a class="reference internal" href="#antenna-patterns">Antenna patterns</a>).</p>
<p>To successfully use the direction finding beacon when the AoD mode is enabled, provide the following data related to antenna matrix design:</p>
<ul class="simple">
<li><p>Provide the GPIO pins to <code class="docutils literal notranslate"><span class="pre">dfegpio#-gpios</span></code> properties in <code class="file docutils literal notranslate"><span class="pre">nrf52833dk_nrf52833.overlay</span></code> file</p></li>
<li><p>Provide the default antenna that will be used to transmit a PDU <code class="docutils literal notranslate"><span class="pre">dfe-pdu-antenna</span></code> property in the <code class="file docutils literal notranslate"><span class="pre">nrf52833dk_nrf52833.overlay</span></code> file</p></li>
<li><p>Update the antenna switching patterns in <code class="xref c c-member docutils literal notranslate"><span class="pre">ant_patterns</span></code> array in <code class="file docutils literal notranslate"><span class="pre">main.c</span></code>.</p></li>
</ul>
</section>
<section id="antenna-patterns">
<h3><a class="toc-backref" href="#id12">Antenna patterns</a><a class="headerlink" href="#antenna-patterns" title="Permalink to this heading"></a></h3>
<p>The antenna switching pattern is a binary number where each bit is applied to a particular antenna GPIO pin.
For example, the pattern 0x3 means that antenna GPIOs at index 0,1 will be set, while the following are left unset.</p>
<p>This also means that, for example, when using four GPIOs, the pattern count cannot be greater than 16 and maximum allowed value is 15.</p>
<p>If the number of switch-sample periods is greater than the number of stored switching patterns, then the radio loops back to the first pattern.</p>
<p>The length of the antenna switching pattern is limited by the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_BT_CTLR_DF_MAX_ANT_SW_PATTERN_LEN</span></code> option.
If the required length of the antenna switching pattern is greater than the default value of <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_BT_CTLR_DF_MAX_ANT_SW_PATTERN_LEN</span></code>, set the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_BT_CTLR_DF_MAX_ANT_SW_PATTERN_LEN</span></code> option to the required value in the board configuration file.
For example, for the <a class="reference internal" href="../../../working_with_nrf/nrf52/developing.html#ug-nrf52"><span class="std std-ref">nRF52833 DK</span></a> add <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_BT_CTLR_DF_MAX_ANT_SW_PATTERN_LEN</span></code> =N, where N is the required antenna switching pattern length, to the <code class="file docutils literal notranslate"><span class="pre">nrf52833dk_nrf52833.conf</span></code> file.</p>
<p>The following table presents the patterns that you can use to switch antennas on the Nordic-designed antenna matrix:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Antenna</p></th>
<th class="head"><p>PATTERN[3:0]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ANT_12</p></td>
<td><p>0 (0b0000)</p></td>
</tr>
<tr class="row-odd"><td><p>ANT_10</p></td>
<td><p>1 (0b0001)</p></td>
</tr>
<tr class="row-even"><td><p>ANT_11</p></td>
<td><p>2 (0b0010)</p></td>
</tr>
<tr class="row-odd"><td><p>RFU</p></td>
<td><p>3 (0b0011)</p></td>
</tr>
<tr class="row-even"><td><p>ANT_3</p></td>
<td><p>4 (0b0100)</p></td>
</tr>
<tr class="row-odd"><td><p>ANT_1</p></td>
<td><p>5 (0b0101)</p></td>
</tr>
<tr class="row-even"><td><p>ANT_2</p></td>
<td><p>6 (0b0110)</p></td>
</tr>
<tr class="row-odd"><td><p>RFU</p></td>
<td><p>7 (0b0111)</p></td>
</tr>
<tr class="row-even"><td><p>ANT_6</p></td>
<td><p>8 (0b1000)</p></td>
</tr>
<tr class="row-odd"><td><p>ANT_4</p></td>
<td><p>9 (0b1001)</p></td>
</tr>
<tr class="row-even"><td><p>ANT_5</p></td>
<td><p>10 (0b1010)</p></td>
</tr>
<tr class="row-odd"><td><p>RFU</p></td>
<td><p>11 (0b1011)</p></td>
</tr>
<tr class="row-even"><td><p>ANT_9</p></td>
<td><p>12 (0b1100)</p></td>
</tr>
<tr class="row-odd"><td><p>ANT_7</p></td>
<td><p>13 (0b1101)</p></td>
</tr>
<tr class="row-even"><td><p>ANT_8</p></td>
<td><p>14 (0b1110)</p></td>
</tr>
<tr class="row-odd"><td><p>RFU</p></td>
<td><p>15 (0b1111)</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="building-and-running">
<h2><a class="toc-backref" href="#id13">Building and Running</a><a class="headerlink" href="#building-and-running" title="Permalink to this heading"></a></h2>
<p>This sample can be found under <code class="file docutils literal notranslate"><span class="pre">samples/bluetooth/direction_finding_peripheral</span></code> in the nRF Connect SDK folder structure.</p>
<p>To build the sample with Visual Studio Code, follow the steps listed on the <a class="reference external" href="https://nrfconnect.github.io/vscode-nrf-connect/get_started/build_app_ncs.html">How to build an application</a> page in the nRF Connect for VS Code extension documentation.
See <a class="reference internal" href="../../../getting_started/programming.html#gs-programming"><span class="std std-ref">Building and programming an application</span></a> for other building and programming scenarios and <a class="reference internal" href="../../../getting_started/testing.html#gs-testing"><span class="std std-ref">Testing and debugging an application</span></a> for general information about testing and debugging in the nRF Connect SDK.</p>
<section id="testing">
<h3><a class="toc-backref" href="#id14">Testing</a><a class="headerlink" href="#testing" title="Permalink to this heading"></a></h3>
<p>After programming the sample to your development kit, complete the following steps to test it:</p>
<ol class="arabic">
<li><p>Connect to the kit that runs this sample with a terminal emulator (for example, PuTTY).
See <a class="reference internal" href="../../../getting_started/testing.html#putty"><span class="std std-ref">How to connect with PuTTY</span></a> for the required settings.</p></li>
<li><p>In the terminal window, check for information similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bluetooth</span> <span class="n">initialized</span>
<span class="o">&lt;</span><span class="n">inf</span><span class="o">&gt;</span> <span class="n">bt_hci_core</span><span class="p">:</span> <span class="n">HW</span> <span class="n">Platform</span><span class="p">:</span> <span class="n">Nordic</span> <span class="n">Semiconductor</span> <span class="p">(</span><span class="n">XxXXXX</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">inf</span><span class="o">&gt;</span> <span class="n">bt_hci_core</span><span class="p">:</span> <span class="n">HW</span> <span class="n">Variant</span><span class="p">:</span> <span class="n">nRF52x</span> <span class="p">(</span><span class="n">XxXXXX</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">inf</span><span class="o">&gt;</span> <span class="n">bt_hci_core</span><span class="p">:</span> <span class="n">Firmware</span><span class="p">:</span> <span class="n">Standard</span> <span class="n">Bluetooth</span> <span class="n">controller</span> <span class="p">(</span><span class="n">XxXX</span><span class="p">)</span> <span class="n">Version</span> <span class="mf">3.0</span> <span class="n">Build</span> <span class="n">X</span>
<span class="o">&lt;</span><span class="n">inf</span><span class="o">&gt;</span> <span class="n">bt_hci_core</span><span class="p">:</span> <span class="n">Identity</span><span class="p">:</span> <span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span> <span class="p">(</span><span class="n">random</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">inf</span><span class="o">&gt;</span> <span class="n">bt_hci_core</span><span class="p">:</span> <span class="n">HCI</span><span class="p">:</span> <span class="n">version</span> <span class="mf">5.3</span> <span class="p">(</span><span class="n">XxXX</span><span class="p">)</span> <span class="n">revision</span> <span class="n">XxXXXX</span><span class="p">,</span> <span class="n">manufacturer</span> <span class="n">XxXXXX</span>
<span class="o">&lt;</span><span class="n">inf</span><span class="o">&gt;</span> <span class="n">bt_hci_core</span><span class="p">:</span> <span class="n">LMP</span><span class="p">:</span> <span class="n">version</span> <span class="mf">5.3</span> <span class="p">(</span><span class="n">XxXX</span><span class="p">)</span> <span class="n">subver</span> <span class="n">XxXXXX</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="dependencies">
<h2><a class="toc-backref" href="#id15">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this heading"></a></h2>
<p>This sample uses the following Zephyr libraries:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">include/zephyr/types.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lib/libc/minimal/include/errno.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/sys/printk.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/sys/byteorder.h</span></code></p></li>
<li><p><span class="xref std std-ref">zephyr:bluetooth_api</span>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/bluetooth.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/hci.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/direction.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/conn.h</span></code></p></li>
</ul>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../enocean/README.html" class="btn btn-neutral float-right" title="Bluetooth: EnOcean" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../direction_finding_connectionless_tx/README.html" class="btn btn-neutral" title="Bluetooth: Direction finding connectionless beacon" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>