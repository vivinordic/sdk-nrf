<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nRF9160: HTTP application update &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../../../_static/js/ncs.js"
></script>
<script src="../../../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="nRF9160: HTTP full modem update" href="../full_modem_update/README.html" />
    <link rel="prev" title="Provisioning" href="../../../net/mqtt/doc/provisioning.html" />
<link
  href="../../../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../protocols.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../applications.html">Applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../samples.html">Samples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../bl.html">Bluetooth samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../crypto.html">Cryptography samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../edge.html">Edge Impulse samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../gazell.html">Gazell samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../matter.html">Matter samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nfc.html">NFC samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nrf5340.html">nRF5340 samples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../nrf9160.html">nRF9160 samples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../at_client/README.html">nRF9160: AT Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../at_monitor/README.html">nRF9160: AT monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws_iot/README.html">nRF9160: AWS IoT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../azure_fota/README.html">nRF9160: Azure FOTA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../azure_iot_hub/README.html">nRF9160: Azure IoT Hub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ciphersuites/README.html">nRF9160: TLS cipher suites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../coap_client/README.html">nRF9160: nRF CoAP Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../download/README.html">nRF9160: Download client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fmfu_smp_svr/README.html">nRF9160: Full modem firmware update using SMP Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gnss/README.html">nRF9160: GNSS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../https_client/README.html">nRF9160: HTTPS Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../location/README.html">nRF9160: Location</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lte_ble_gateway/README.html">nRF9160: LTE Sensor Gateway</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lwm2m_carrier/README.html">nRF9160: LwM2M carrier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lwm2m_client/README.html">nRF9160: LwM2M Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memfault/README.html">nRF9160: Memfault</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modem_callbacks/README.html">nRF9160: Modem callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modem_shell/README.html">nRF9160: Modem Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modem_trace_backend/README.html">nRF9160: Modem trace backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modem_trace_flash/README.html">nRF9160: Modem trace external flash backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nidd/README.html">nRF9160: NIDD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf_cloud_mqtt_multi_service/README.html">nRF9160: nRF Cloud MQTT multi-service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf_cloud_rest_cell_location/README.html">nRF9160: nRF Cloud REST cellular location</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf_cloud_rest_device_message/README.html">nRF9160: nRF Cloud REST Device Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf_cloud_rest_fota/README.html">nRF9160: nRF Cloud REST FOTA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pdn/README.html">nRF9160: PDN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../slm_shell/README.html">nRF9160: SLM Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sms/README.html">nRF9160: SMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../udp/README.html">nRF9160: UDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../net/mqtt/README.html">MQTT</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">nRF9160: HTTP application update</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-and-running">Building and running</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../full_modem_update/README.html">nRF9160: HTTP full modem update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modem_delta_update/README.html">nRF9160: HTTP modem delta update</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tfm.html">Trusted Firmware-M (TF-M) samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../thread.html">Thread samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../zigbee.html">Zigbee samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../wifi.html">Wi-Fi samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../other.html">Other samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../samples.html">Samples</a></li>
          <li class="breadcrumb-item"><a href="../../../nrf9160.html">nRF9160 samples</a></li>
      <li class="breadcrumb-item active">nRF9160: HTTP application update</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/samples/nrf9160/http_update/application_update/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nrf9160-http-application-update">
<span id="http-application-update-sample"></span><h1>nRF9160: HTTP application update<a class="headerlink" href="#nrf9160-http-application-update" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#requirements" id="id6">Requirements</a></p></li>
<li><p><a class="reference internal" href="#overview" id="id7">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#using-the-lwm2m-carrier-library" id="id8">Using the LwM2M carrier library</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuration" id="id9">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#configuration-options" id="id10">Configuration options</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-and-running" id="id11">Building and running</a></p>
<ul>
<li><p><a class="reference internal" href="#specifying-the-image-files" id="id12">Specifying the image files</a></p></li>
<li><p><a class="reference internal" href="#setting-up-an-aws-s3-bucket" id="id13">Setting up an AWS S3 bucket</a></p></li>
<li><p><a class="reference internal" href="#testing" id="id14">Testing</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dependencies" id="id15">Dependencies</a></p></li>
</ul>
</div>
<p>The HTTP application update sample demonstrates how to do a basic firmware over-the-air (FOTA) update.
It uses the <a class="reference internal" href="../../../../libraries/networking/fota_download.html#lib-fota-download"><span class="std std-ref">FOTA download</span></a> library to download two image files from a remote server and program them to flash memory.</p>
<section id="requirements">
<h2><a class="toc-backref" href="#id6">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h2>
<p>The sample supports the following development kit:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 8%" />
<col style="width: 42%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Hardware platforms</p></th>
<th class="head"><p>PCA</p></th>
<th class="head"><p>Board name</p></th>
<th class="head"><p>Build target</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../../../working_with_nrf/nrf91/nrf9160.html#ug-nrf9160"><span class="std std-ref">nRF9160 DK</span></a></p></td>
<td><p>PCA10090</p></td>
<td><p><span class="xref std std-ref">nrf9160dk_nrf9160</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf9160dk_nrf9160_ns</span></code></p></td>
</tr>
</tbody>
</table>
<p>When built for an <code class="docutils literal notranslate"><span class="pre">_ns</span></code> build target, the sample is configured to compile and run as a non-secure application with <a class="reference internal" href="../../../../app_dev/board_support/index.html#app-boards-spe-nspe-cpuapp-ns"><span class="std std-ref">Cortex-M Security Extensions enabled</span></a>.
Therefore, it automatically includes <a class="reference internal" href="../../../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M</span></a> that prepares the required peripherals and secure services to be available for the application.</p>
<p>The sample also requires two signed firmware images that have to be available for download from an HTTP server.
The images are generated automatically when building the sample, but you must upload them to a server and configure the location from where they can be downloaded.</p>
</section>
<section id="overview">
<h2><a class="toc-backref" href="#id7">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The sample connects to an HTTP server to download one of two signed firmware images:</p>
<ul class="simple">
<li><p>One image has the <code class="docutils literal notranslate"><span class="pre">application</span> <span class="pre">version</span></code> set to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p>The other has the <code class="docutils literal notranslate"><span class="pre">application</span> <span class="pre">version</span></code> set to <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p></li>
</ul>
<p>The sample updates between the two images, either from <em>version 1</em> to <em>version 2</em> or from <em>version 2</em> to <em>version 1</em>.</p>
<p>By default, the images are saved to the <a class="reference external" href="https://www.mcuboot.com">MCUboot</a> second-stage bootloader secondary slot.
To be used by MCUboot, the downloaded images must be signed using imgtool.</p>
<section id="using-the-lwm2m-carrier-library">
<h3><a class="toc-backref" href="#id8">Using the LwM2M carrier library</a><a class="headerlink" href="#using-the-lwm2m-carrier-library" title="Permalink to this heading"></a></h3>
<p>The application supports the nRF Connect SDK <a class="reference internal" href="../../../../libraries/bin/lwm2m_carrier/index.html#liblwm2m-carrier-readme"><span class="std std-ref">LwM2M carrier</span></a> library that you can use to connect to the operator’s device management platform.
See the library’s documentation for more information and configuration options.</p>
<p>To enable the LwM2M carrier library, add the parameter <code class="docutils literal notranslate"><span class="pre">-DOVERLAY_CONFIG=overlay-carrier.conf</span></code> to your build command.</p>
<p>The CA root certificates that are needed for modem FOTA are not provisioned in the HTTP application update sample.
You can flash the <a class="reference internal" href="../../lwm2m_carrier/README.html#lwm2m-carrier"><span class="std std-ref">nRF9160: LwM2M carrier</span></a> sample to write the certificates to modem before flashing the HTTP application update sample, or use the <a class="reference internal" href="../../at_client/README.html#at-client-sample"><span class="std std-ref">nRF9160: AT Client</span></a> sample as explained in <a class="reference internal" href="../../lwm2m_client/provisioning.html#lwm2m-client-provisioning"><span class="std std-ref">Preparing the nRF9160: LwM2M Client sample for production</span></a>.
It is also possible to modify the HTTP application update sample project itself to include the certificate provisioning, as demonstrated in the <a class="reference internal" href="../../lwm2m_carrier/README.html#lwm2m-carrier"><span class="std std-ref">nRF9160: LwM2M carrier</span></a> sample.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">lwm2m_carrier_event_handler</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">lwm2m_carrier_event_t</span><span class="w"> </span><span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">LWM2M_CARRIER_EVENT_INIT</span><span class="p">:</span>
<span class="w">                </span><span class="n">carrier_cert_provision</span><span class="p">();</span>
<span class="w">        </span><span class="p">...</span>
</pre></div>
</div>
</section>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id9">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>See <a class="reference internal" href="../../../../getting_started/modifying.html#configure-application"><span class="std std-ref">Configuring your application</span></a> for information about how to permanently or temporarily change the configuration.</p>
<section id="configuration-options">
<h3><a class="toc-backref" href="#id10">Configuration options</a><a class="headerlink" href="#configuration-options" title="Permalink to this heading"></a></h3>
<p>Check and configure the following Kconfig options:</p>
<dl class="simple" id="config-download-file-v1">
<dt>CONFIG_DOWNLOAD_FILE_V1</dt><dd><p>This configuration option configures the file name of the <em>version 1</em> of the update image.</p>
</dd>
</dl>
<dl class="simple" id="config-download-file-v2">
<dt>CONFIG_DOWNLOAD_FILE_V2</dt><dd><p>This configuration option configures the file name of the <em>version 2</em> of the update image.</p>
</dd>
</dl>
</section>
</section>
<section id="building-and-running">
<h2><a class="toc-backref" href="#id11">Building and running</a><a class="headerlink" href="#building-and-running" title="Permalink to this heading"></a></h2>
<p>This sample can be found under <code class="file docutils literal notranslate"><span class="pre">samples/nrf9160/http_update/application_update</span></code> in the nRF Connect SDK folder structure.</p>
<p>When built as firmware image for the <code class="docutils literal notranslate"><span class="pre">_ns</span></code> build target, the sample has Cortex-M Security Extensions (CMSE) enabled and separates the firmware between Non-Secure Processing Environment (NSPE) and Secure Processing Environment (SPE).
Because of this, it automatically includes the <a class="reference internal" href="../../../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M (TF-M)</span></a>.
To read more about CMSE, see <a class="reference internal" href="../../../../app_dev/board_support/index.html#app-boards-spe-nspe"><span class="std std-ref">Processing environments</span></a>.</p>
<p>To build the sample with Visual Studio Code, follow the steps listed on the <a class="reference external" href="https://nrfconnect.github.io/vscode-nrf-connect/get_started/build_app_ncs.html">How to build an application</a> page in the nRF Connect for VS Code extension documentation.
See <a class="reference internal" href="../../../../getting_started/programming.html#gs-programming"><span class="std std-ref">Building and programming an application</span></a> for other building and programming scenarios and <a class="reference internal" href="../../../../getting_started/testing.html#gs-testing"><span class="std std-ref">Testing and debugging an application</span></a> for general information about testing and debugging in the nRF Connect SDK.</p>
<section id="specifying-the-image-files">
<h3><a class="toc-backref" href="#id12">Specifying the image files</a><a class="headerlink" href="#specifying-the-image-files" title="Permalink to this heading"></a></h3>
<p>Before building the sample, you must specify where the image files are located.
If you do not want to host the files yourself, you can upload them to a public S3 bucket on Amazon Web Services (AWS).</p>
<p>If you do not want to host the image file, you can also upload it to a public S3 bucket on Amazon Web Services (AWS).</p>
</section>
<section id="setting-up-an-aws-s3-bucket">
<h3><a class="toc-backref" href="#id13">Setting up an AWS S3 bucket</a><a class="headerlink" href="#setting-up-an-aws-s3-bucket" title="Permalink to this heading"></a></h3>
<p>The firmware files for download must be stored in a bucket on an AWS S3 server.
To do this, set up your own bucket.</p>
<p>When setting up your own bucket, make sure to configure the permissions as shown in the following screenshot:</p>
<figure class="align-default">
<img alt="Bucket permissions in AWS S3" src="../../../../_images/aws_s3_bucket_permissions.png" />
</figure>
<p>To update the permissions for an existing bucket, select your bucket and navigate to <strong>Permissions</strong> &gt; <strong>Block public access</strong>.</p>
<p>In addition to the permissions, you must configure a bucket policy.
To determine a suitable security scheme for your application, see <a class="reference external" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-iam-policies.html">AWS S3 Developer Guide: Using Bucket Policies and User Policies</a> and <a class="reference external" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html">AWS S3 Developer Guide: Bucket Policy Examples</a>.
To configure the policy, select your bucket and navigate to <strong>Permissions</strong> &gt; <strong>Bucket Policy</strong>.</p>
<p>For testing purposes, you can use the following, very permissive, bucket policy (replace <em>bucket_name</em> with the name of your bucket):</p>
<pre class="highlight literal-block">{    &quot;Version&quot;: &quot;2012-10-17&quot;,
     &quot;Statement&quot;: [
         {
             &quot;Effect&quot;: &quot;Allow&quot;,
             &quot;Principal&quot;: &quot;*&quot;,
             &quot;Action&quot;: &quot;s3:GetObject&quot;,
             &quot;Resource&quot;: &quot;arn:aws:s3:::<em>bucket_name</em>/*&quot;
         }
      ]
 }</pre>
<section id="hosting-your-image-on-an-aws-s3-server">
<h4>Hosting your image on an AWS S3 Server<a class="headerlink" href="#hosting-your-image-on-an-aws-s3-server" title="Permalink to this heading"></a></h4>
<p>To upload the file to a public S3 bucket, perform the following steps:</p>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="https://console.aws.amazon.com/s3/home">AWS S3 console</a> and sign in.</p></li>
<li><p>Go to the bucket you have created.</p></li>
<li><p>Click <span class="guilabel">Upload</span> and select the file <code class="file docutils literal notranslate"><span class="pre">app_update.bin</span></code>.
It is located in the <code class="file docutils literal notranslate"><span class="pre">zephyr</span></code> subfolder of your build directory.</p></li>
<li><p>Click the file you uploaded in the bucket and check the <strong>Object URL</strong> field to find the download URL for the file.</p></li>
</ol>
<p>Remember to do the following when specifying the filenames:</p>
<ul class="simple">
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">&lt;bucket-name&gt;.s3.&lt;region&gt;.amazonaws.com</span></code> part of the URL as the hostname of the server hosting the images, without including <code class="docutils literal notranslate"><span class="pre">https://</span></code>.</p></li>
<li><p>Specify the file names as the remaining part of the URL.</p></li>
</ul>
<p>Follow the steps mentioned in the <a class="reference internal" href="#specifying-the-image-files">Specifying the image files</a> section to upload both images.</p>
</section>
</section>
<section id="testing">
<h3><a class="toc-backref" href="#id14">Testing</a><a class="headerlink" href="#testing" title="Permalink to this heading"></a></h3>
<p>After programming the sample to your development kit, test it by performing the following steps:</p>
<ol class="arabic">
<li><p>Upload the file <code class="file docutils literal notranslate"><span class="pre">app_update.bin</span></code> with the application image version 1 to the server you have chosen.
To upload the file on nRF Cloud, click <span class="guilabel">Upload</span> for the firmware URL that you generated earlier, then select the file <code class="file docutils literal notranslate"><span class="pre">app_update.bin</span></code> and upload it.
Remember to rename the file to match the <code class="docutils literal notranslate"><span class="pre">CONFIG_DOWNLOAD_FILE_V1</span></code> configuration option.</p></li>
<li><p>Configure the application image version to be 2 and rebuild the application.</p></li>
<li><p>Upload the file <code class="file docutils literal notranslate"><span class="pre">app_update.bin</span></code> with the application image version 2 to the server you have chosen.</p></li>
<li><p>Reset your nRF9160 DK to start the application.</p></li>
<li><p>Open a terminal emulator and observe that an output similar to the following is printed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*****</span> <span class="n">Booting</span> <span class="n">Zephyr</span> <span class="n">OS</span> <span class="n">v1</span><span class="mf">.13.99</span> <span class="o">*****</span>
</pre></div>
</div>
</li>
<li><p>Observe that <strong>LED 1</strong> is lit.
This indicates that version 1 of the application is running.</p></li>
<li><p>Press <strong>Button 1</strong> on the nRF9160 DK or type “download” in the terminal emulator to start the download process, and wait until <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">complete</span></code> is printed in the terminal.</p></li>
<li><p>Press the <strong>RESET</strong> button on the kit or type “reset” in the terminal emulator.
MCUboot will now detect the downloaded image and program it to flash memory.
This can take up to a minute.
Nothing is printed in the terminal while the writing is in progress.</p></li>
<li><p>Observe that <strong>LED 1</strong> and <strong>LED 2</strong> are lit.
This indicates that version 2 or higher of the application is running.</p></li>
<li><p>You can now downgrade the application by repeating the button presses or typing “download” in the terminal emulator.
Observe that after the second update only <strong>LED 1</strong> is lit.
This indicates that the application image has been downgraded to version 1.
Any further updates will toggle between the versions.</p></li>
</ol>
</section>
</section>
<section id="dependencies">
<h2><a class="toc-backref" href="#id15">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this heading"></a></h2>
<p>This sample uses the following nRF Connect SDK libraries:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../libraries/networking/fota_download.html#lib-fota-download"><span class="std std-ref">FOTA download</span></a></p></li>
</ul>
<p>It uses the following <a class="reference external" href="https://github.com/nrfconnect/sdk-nrfxlib">sdk-nrfxlib</a> library:</p>
<ul class="simple">
<li><p><span class="xref std std-ref">nrfxlib:nrf_modem</span></p></li>
</ul>
<p>It uses the following Zephyr libraries:</p>
<ul class="simple">
<li><p><span class="xref std std-ref">zephyr:flash_api</span></p></li>
<li><p><span class="xref std std-ref">zephyr:logging_api</span></p></li>
<li><p><span class="xref std std-ref">zephyr:gpio_api</span></p></li>
<li><p><span class="xref std std-ref">zephyr:shell_api</span></p></li>
</ul>
<p>It also uses the <a class="reference external" href="https://www.mcuboot.com">MCUboot</a> bootloader.</p>
<p>In addition, it uses the following secure firmware component:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../full_modem_update/README.html" class="btn btn-neutral float-right" title="nRF9160: HTTP full modem update" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../../net/mqtt/doc/provisioning.html" class="btn btn-neutral" title="Provisioning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>