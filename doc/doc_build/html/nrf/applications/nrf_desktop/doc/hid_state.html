<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HID state module &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../../_static/js/ncs.js"
></script>
<script src="../../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="HID state power manager module" href="hid_state_pm.html" />
    <link rel="prev" title="HID forward module" href="hid_forward.html" />
<link
  href="../../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../protocols.html">Protocols</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../applications.html">Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../connectivity_bridge/README.html">Connectivity bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../asset_tracker_v2/README.html">nRF9160: Asset Tracker v2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../serial_lte_modem/README.html">nRF9160: Serial LTE modem</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../README.html">nRF Desktop</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../README.html#overview-firmware-architecture">Overview: Firmware architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#user-interface">User interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#building-and-running">Building and running</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#integrating-your-own-hardware">Integrating your own hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#dependencies">Dependencies</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../README.html#application-internal-modules">Application internal modules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="main.html">Basic module (main)</a></li>
<li class="toctree-l4"><a class="reference internal" href="battery_charger.html">Battery charger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="battery_meas.html">Battery measurement module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_adv.html">Bluetooth LE advertising module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_bond.html">Bluetooth LE bond module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_conn_params.html">Bluetooth LE connection parameters module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_discovery.html">Bluetooth LE discovery module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_latency.html">Bluetooth LE latency module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_passkey.html">Bluetooth LE passkey module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_qos.html">Bluetooth LE Quality of Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_scan.html">Bluetooth LE scanning module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_state_pm.html">Bluetooth state power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_state.html">Bluetooth LE state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="board.html">Board module</a></li>
<li class="toctree-l4"><a class="reference internal" href="buttons.html">Buttons module</a></li>
<li class="toctree-l4"><a class="reference internal" href="buttons_sim.html">Button simulator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="click_detector.html">Click detector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="config_channel.html">Configuration channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="cpu_meas.html">CPU measurement module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dev_descr.html">Device description module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dfu.html">Device Firmware Upgrade module</a></li>
<li class="toctree-l4"><a class="reference internal" href="failsafe.html">Failsafe module</a></li>
<li class="toctree-l4"><a class="reference internal" href="fast_pair_app.html">Fast Pair module</a></li>
<li class="toctree-l4"><a class="reference internal" href="fn_keys.html">Function key module</a></li>
<li class="toctree-l4"><a class="reference internal" href="bas.html">GATT Battery Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hid_forward.html">HID forward module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">HID state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hid_state_pm.html">HID state power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hids.html">HID Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="info.html">Info module</a></li>
<li class="toctree-l4"><a class="reference internal" href="led_state.html">LED state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="led_stream.html">LED stream module</a></li>
<li class="toctree-l4"><a class="reference internal" href="leds.html">LEDs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="motion.html">Motion module</a></li>
<li class="toctree-l4"><a class="reference internal" href="passkey.html">Passkey module</a></li>
<li class="toctree-l4"><a class="reference internal" href="power_manager.html">Power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nrf_profiler_sync.html">nRF Profiler synchronization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="qos.html">Quality of Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="selector.html">Selector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="smp.html">Simple Management Protocol module</a></li>
<li class="toctree-l4"><a class="reference internal" href="settings_loader.html">Settings loader module</a></li>
<li class="toctree-l4"><a class="reference internal" href="usb_state_pm.html">USB state power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="usb_state.html">USB state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="watchdog.html">Watchdog module</a></li>
<li class="toctree-l4"><a class="reference internal" href="wheel.html">Wheel module</a></li>
<li class="toctree-l4"><a class="reference internal" href="constlat.html">Constant latency hotfix module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hfclk_lock.html">High frequency clock lock hotfix module</a></li>
<li class="toctree-l4"><a class="reference internal" href="event_rel_modules.html">Source and sink module lists</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#application-configuration-options">Application configuration options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#api-documentation">API documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../nrf5340_audio/README.html">nRF5340 Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../machine_learning/README.html">nRF Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matter_weather_station/README.html">Thingy:53: Matter weather station</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../zigbee_weather_station/README.html">Thingy:53: Zigbee weather station</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples.html">Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../applications.html">Applications</a></li>
          <li class="breadcrumb-item"><a href="../README.html">nRF Desktop</a></li>
      <li class="breadcrumb-item active">HID state module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/applications/nrf_desktop/doc/hid_state.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hid-state-module">
<span id="nrf-desktop-hid-state"></span><h1>HID state module<a class="headerlink" href="#hid-state-module" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-events" id="id6">Module events</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id7">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#hid-keymap" id="id8">HID keymap</a></p></li>
<li><p><a class="reference internal" href="#hid-keyboard-leds" id="id9">HID keyboard LEDs</a></p></li>
<li><p><a class="reference internal" href="#report-expiration" id="id10">Report expiration</a></p></li>
<li><p><a class="reference internal" href="#queue-event-size" id="id11">Queue event size</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#implementation-details" id="id12">Implementation details</a></p>
<ul>
<li><p><a class="reference internal" href="#linking-input-data-with-the-right-hid-report" id="id13">Linking input data with the right HID report</a></p></li>
<li><p><a class="reference internal" href="#storing-input-data-before-the-connection" id="id14">Storing input data before the connection</a></p></li>
<li><p><a class="reference internal" href="#tracking-state-of-transports" id="id15">Tracking state of transports</a></p></li>
<li><p><a class="reference internal" href="#tracking-state-of-hid-report-notifications" id="id16">Tracking state of HID report notifications</a></p></li>
<li><p><a class="reference internal" href="#forming-hid-reports" id="id17">Forming HID reports</a></p></li>
<li><p><a class="reference internal" href="#handling-hid-keyboard-led-state" id="id18">Handling HID keyboard LED state</a></p></li>
</ul>
</li>
</ul>
</div>
<p>The HID state module is required for generating reports from input data.
It is responsible for the following operations:</p>
<ul class="simple">
<li><p>Aggregating data from user input sources.</p></li>
<li><p>Tracking state of the HID report subscriptions.</p></li>
<li><p>Forming the HID reports in either report or boot protocol.</p></li>
<li><p>Transmitting the HID reports to the right subscriber.</p></li>
<li><p>Sending <a class="reference internal" href="../../../libraries/caf/caf_overview.html#c.led_event" title="led_event"><code class="xref c c-struct docutils literal notranslate"><span class="pre">led_event</span></code></a> based on the HID keyboard LED output reports.</p></li>
</ul>
<section id="module-events">
<h2><a class="toc-backref" href="#id6">Module events</a><a class="headerlink" href="#module-events" title="Permalink to this heading"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 22%" />
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Source Module</p></th>
<th class="head"><p>Input Event</p></th>
<th class="head"><p>This Module</p></th>
<th class="head"><p>Output Event</p></th>
<th class="head"><p>Sink Module</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="ble_adv.html#nrf-desktop-ble-adv"><span class="std std-ref">Bluetooth LE advertising module</span></a></p></td>
<td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">ble_peer_event</span></code></p></td>
<td rowspan="20"><p><code class="docutils literal notranslate"><span class="pre">hid_state</span></code></p></td>
<td rowspan="17"></td>
<td rowspan="17"></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="ble_state.html#nrf-desktop-ble-state"><span class="std std-ref">Bluetooth LE state module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="hid_forward.html#nrf-desktop-hid-forward"><span class="std std-ref">HID forward module</span></a></p></td>
<td rowspan="4"><p><code class="docutils literal notranslate"><span class="pre">hid_report_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#nrf-desktop-hid-state"><span class="std std-ref">HID state module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="hids.html#nrf-desktop-hids"><span class="std std-ref">HID Service module</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="hids.html#nrf-desktop-hids"><span class="std std-ref">HID Service module</span></a></p></td>
<td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">hid_report_sent_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="hids.html#nrf-desktop-hids"><span class="std std-ref">HID Service module</span></a></p></td>
<td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">hid_report_subscription_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="event_rel_modules.html#nrf-desktop-module-state-event-sources"><span class="std std-ref">Source modules for module_state_event</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">module_state_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="motion.html#nrf-desktop-motion"><span class="std std-ref">Motion module</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">motion_event</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">usb_hid_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="wheel.html#nrf-desktop-wheel"><span class="std std-ref">Wheel module</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wheel_event</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="buttons.html#nrf-desktop-buttons"><span class="std std-ref">Buttons module</span></a></p></td>
<td rowspan="3"><p><code class="docutils literal notranslate"><span class="pre">button_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="buttons_sim.html#nrf-desktop-buttons-sim"><span class="std std-ref">Button simulator module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="fn_keys.html#nrf-desktop-fn-keys"><span class="std std-ref">Function key module</span></a></p></td>
</tr>
<tr class="row-odd"><td rowspan="3"></td>
<td rowspan="3"></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hid_report_event</span></code></p></td>
<td><p><a class="reference internal" href="event_rel_modules.html#nrf-desktop-hid-report-event-sinks"><span class="std std-ref">Sink modules for hid_report_event</span></a></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">led_event</span></code></p></td>
<td><p><a class="reference internal" href="led_stream.html#nrf-desktop-led-stream"><span class="std std-ref">LED stream module</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="leds.html#nrf-desktop-leds"><span class="std std-ref">LEDs module</span></a></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a class="reference internal" href="../README.html#nrf-desktop-architecture"><span class="std std-ref">Overview: Firmware architecture</span></a> for more information about the event-based communication in the nRF Desktop application and about how to read this table.</p>
</div>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id7">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>The HID state module is enabled by the <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_STATE_ENABLE</span></a> option which is implied by the <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_ROLE_HID_PERIPHERAL</span></a> option.
An nRF Desktop peripheral uses the HID state module to generate HID reports based on the user input.
For details related to HID configuration in the nRF Desktop, see the <a class="reference internal" href="../README.html#nrf-desktop-hid-configuration"><span class="std std-ref">HID configuration</span></a> documentation.</p>
<p>To send boot reports, enable the respective Kconfig option:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_BOOT_INTERFACE_KEYBOARD</span></a> - This option enables sending keyboard boot reports.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_BOOT_INTERFACE_MOUSE</span></a> - This option enables sending mouse boot reports.</p></li>
</ul>
<section id="hid-keymap">
<h3><a class="toc-backref" href="#id8">HID keymap</a><a class="headerlink" href="#hid-keymap" title="Permalink to this heading"></a></h3>
<p>You must define mapping between button IDs and usage IDs in generated HID reports.
For that purpose you must create a configuration file with <code class="docutils literal notranslate"><span class="pre">hid_keymap</span></code> array.
Every element of the array contains mapping from a single hardware key ID to HID report ID and usage ID.</p>
<p>For example, the file contents should look like the following:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;caf/key_id.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hid_keymap.h&quot;</span>
<span class="cp">#inclue &quot;fn_key_id.h&quot;</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">hid_keymap</span><span class="w"> </span><span class="n">hid_keymap</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">KEY_ID</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x01</span><span class="p">),</span><span class="w"> </span><span class="mh">0x0014</span><span class="p">,</span><span class="w"> </span><span class="n">REPORT_ID_KEYBOARD_KEYS</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* Q */</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">KEY_ID</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x02</span><span class="p">),</span><span class="w"> </span><span class="mh">0x001A</span><span class="p">,</span><span class="w"> </span><span class="n">REPORT_ID_KEYBOARD_KEYS</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* W */</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">KEY_ID</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">),</span><span class="w"> </span><span class="mh">0x0008</span><span class="p">,</span><span class="w"> </span><span class="n">REPORT_ID_KEYBOARD_KEYS</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* E */</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">KEY_ID</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">),</span><span class="w"> </span><span class="mh">0x0015</span><span class="p">,</span><span class="w"> </span><span class="n">REPORT_ID_KEYBOARD_KEYS</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* R */</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">KEY_ID</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">),</span><span class="w"> </span><span class="mh">0x0018</span><span class="p">,</span><span class="w"> </span><span class="n">REPORT_ID_KEYBOARD_KEYS</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* U */</span>

<span class="w">        </span><span class="p">...</span>

<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">FN_KEY_ID</span><span class="p">(</span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="mh">0x02</span><span class="p">),</span><span class="w"> </span><span class="mh">0x0082</span><span class="p">,</span><span class="w"> </span><span class="n">REPORT_ID_SYSTEM_CTRL</span><span class="w"> </span><span class="p">},</span><span class="w">   </span><span class="cm">/* sleep */</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">FN_KEY_ID</span><span class="p">(</span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">),</span><span class="w"> </span><span class="mh">0x0196</span><span class="p">,</span><span class="w"> </span><span class="n">REPORT_ID_CONSUMER_CTRL</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* internet */</span>
<span class="p">};</span>
</pre></div>
</div>
<p>You must define the mentioned array in this configuration file, and specify its location with the <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_STATE_HID_KEYMAP_DEF_PATH</span></a> Kconfig option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The configuration file should be included only by the configured module.
Do not include the configuration file in other source files.</p>
</div>
</section>
<section id="hid-keyboard-leds">
<h3><a class="toc-backref" href="#id9">HID keyboard LEDs</a><a class="headerlink" href="#hid-keyboard-leds" title="Permalink to this heading"></a></h3>
<p>You must define which hardware LEDs are used to display state of the HID keyboard LEDs report and LED effects that should be used to display the state.
See documentation of <a class="reference internal" href="../../../libraries/caf/leds.html#caf-leds"><span class="std std-ref">CAF: LEDs module</span></a> for details about LED effects.</p>
<p>You must create a configuration file with the following data:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keyboard_led_on</span></code> - LED effect defined to represent LED turned on by the host.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keyboard_led_off</span></code> - LED effect defined to represent LED turned off by the host.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keyboard_led_map</span></code> - IDs of the hardware LEDs used to represent state of the HID keyboard LED.</p></li>
</ul>
<p>For example, the file contents should look like follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hid_keyboard_leds.h&quot;</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">led_effect</span><span class="w"> </span><span class="n">keyboard_led_on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LED_EFFECT_LED_ON</span><span class="p">(</span><span class="n">LED_COLOR</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">));</span>
<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">led_effect</span><span class="w"> </span><span class="n">keyboard_led_off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LED_EFFECT_LED_OFF</span><span class="p">();</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyboard_led_map</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">[</span><span class="n">HID_KEYBOARD_LEDS_NUM_LOCK</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="n">HID_KEYBOARD_LEDS_CAPS_LOCK</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="n">HID_KEYBOARD_LEDS_SCROLL_LOCK</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LED_UNAVAILABLE</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="n">HID_KEYBOARD_LEDS_COMPOSE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LED_UNAVAILABLE</span><span class="p">,</span>
<span class="w">        </span><span class="p">[</span><span class="n">HID_KEYBOARD_LEDS_KANA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LED_UNAVAILABLE</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>You must define all of the mentioned data in this configuration file, and specify its location with the <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_STATE_HID_KEYBOARD_LEDS_DEF_PATH</span></a> Kconfig option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The configuration file should be included only by the configured module.
Do not include the configuration file in other source files.</p>
</div>
</section>
<section id="report-expiration">
<h3><a class="toc-backref" href="#id10">Report expiration</a><a class="headerlink" href="#report-expiration" title="Permalink to this heading"></a></h3>
<p>With the <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_REPORT_EXPIRATION</span></a> configuration option, you can set the amount of time after which a key will be considered expired.
The higher the value, the longer the period after which the nRF Desktop application will recall pressed keys when the connection is established.</p>
</section>
<section id="queue-event-size">
<h3><a class="toc-backref" href="#id11">Queue event size</a><a class="headerlink" href="#queue-event-size" title="Permalink to this heading"></a></h3>
<p>With the <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_EVENT_QUEUE_SIZE</span></a> configuration option, you can set the number of elements on the queue where the keys are stored before the connection is established.
When a key state changes (it is pressed or released) before the connection is established, an element containing this key’s usage is pushed onto the queue.
If there is no space in the queue, the oldest element is released.</p>
</section>
</section>
<section id="implementation-details">
<h2><a class="toc-backref" href="#id12">Implementation details</a><a class="headerlink" href="#implementation-details" title="Permalink to this heading"></a></h2>
<p>The HID state module provides a routing mechanism between sources of input data and transport modules.
This can be associated with:</p>
<ul class="simple">
<li><p>Receiving input events from <a class="reference internal" href="../../../libraries/caf/buttons.html#caf-buttons"><span class="std std-ref">CAF: Buttons module</span></a>, <a class="reference internal" href="wheel.html#nrf-desktop-wheel"><span class="std std-ref">Wheel module</span></a>, and <a class="reference internal" href="motion.html#nrf-desktop-motion"><span class="std std-ref">Motion module</span></a>.</p></li>
<li><p>Sending out HID reports to <a class="reference internal" href="hids.html#nrf-desktop-hids"><span class="std std-ref">HID Service module</span></a> and <a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a>.</p></li>
</ul>
<p>For the routing mechanism to work, the module performs the following operations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#linking-input-data-with-the-right-hid-report">Linking input data with the right HID report</a></p></li>
<li><p><a class="reference internal" href="#storing-input-data-before-the-connection">Storing input data before the connection</a></p></li>
<li><p><a class="reference internal" href="#tracking-state-of-transports">Tracking state of transports</a></p></li>
<li><p><a class="reference internal" href="#tracking-state-of-hid-report-notifications">Tracking state of HID report notifications</a></p></li>
<li><p><a class="reference internal" href="#forming-hid-reports">Forming HID reports</a></p></li>
</ul>
<p>Apart from the routing mechanism, the module is also responsible for <a class="reference internal" href="#handling-hid-keyboard-led-state">Handling HID keyboard LED state</a>.</p>
<section id="linking-input-data-with-the-right-hid-report">
<h3><a class="toc-backref" href="#id13">Linking input data with the right HID report</a><a class="headerlink" href="#linking-input-data-with-the-right-hid-report" title="Permalink to this heading"></a></h3>
<p>Out of all available input data types, the following types are collected by the HID state module:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#relative-value-data">Relative value data</a> (axes)</p></li>
<li><p><a class="reference internal" href="#absolute-value-data">Absolute value data</a> (buttons)</p></li>
</ul>
<p>Both types are stored in the <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_data</span></code> structure.</p>
<section id="relative-value-data">
<h4>Relative value data<a class="headerlink" href="#relative-value-data" title="Permalink to this heading"></a></h4>
<p>This type of input data is related to the pointer coordinates and the wheel rotation.
Both <code class="docutils literal notranslate"><span class="pre">motion_event</span></code> and <code class="docutils literal notranslate"><span class="pre">wheel_event</span></code> are sources of this type of data.</p>
<p>To indicate a change to this input data, overwrite the value that is already stored.</p>
<p>When either <code class="docutils literal notranslate"><span class="pre">motion_event</span></code> or <code class="docutils literal notranslate"><span class="pre">wheel_event</span></code> is received, the HID state module selects the <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_data</span></code> structure associated with the mouse HID report and stores the values at the right position within this structure’s <code class="docutils literal notranslate"><span class="pre">axes</span></code> member.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values of axes are stored every time the input data is received, but these values are cleared when a report is connected to the subscriber.
Consequently, values outside of the connection period are never retained.</p>
</div>
</section>
<section id="absolute-value-data">
<h4>Absolute value data<a class="headerlink" href="#absolute-value-data" title="Permalink to this heading"></a></h4>
<p>This type of input data is related to buttons.
The <code class="docutils literal notranslate"><span class="pre">button_event</span></code> is the source of this type of data.</p>
<p>To indicate a change to this input data, overwrite the value that is already stored.</p>
<p>Since keys on the board can be associated to a usage ID, and thus be part of different HID reports, the first step is to identify which report the key belongs to and what usage it represents.
This is done by obtaining the key mapping from the <code class="xref c c-struct docutils literal notranslate"><span class="pre">hid_keymap</span></code> structure.
This structure is part of the application configuration files for the specific board and is defined in <code class="file docutils literal notranslate"><span class="pre">hid_keymap_def.h</span></code>.</p>
<p>Once the mapping is obtained, the application checks if the report to which the usage belongs is connected:</p>
<ul class="simple">
<li><p>If the report is connected, the value is stored at the right position in the <code class="docutils literal notranslate"><span class="pre">items</span></code> member of <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_data</span></code> associated with the report.</p></li>
<li><p>If the report is not connected, the value is stored in the <code class="docutils literal notranslate"><span class="pre">eventq</span></code> event queue member of the same structure.</p></li>
</ul>
<p>The difference between these operations is that storing value onto the queue (second case) preserves the order of input events.
See the following section for more information about storing data before the connection.</p>
</section>
</section>
<section id="storing-input-data-before-the-connection">
<h3><a class="toc-backref" href="#id14">Storing input data before the connection</a><a class="headerlink" href="#storing-input-data-before-the-connection" title="Permalink to this heading"></a></h3>
<p>The storing approach before the connection depends on the data type:</p>
<ul class="simple">
<li><p>The relative value data is not stored outside of the connection period.</p></li>
<li><p>The absolute value data is stored before the connection.</p></li>
</ul>
<p>The reason for this operation is to allow to track key presses that happen right after the device is woken up, but before it is able to connect to the host.</p>
<p>When the device is disconnected and the input event with the absolute value data is received, the data is stored onto the event queue (<code class="docutils literal notranslate"><span class="pre">eventq</span></code>), a member of <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_data</span></code> structure.
This queue preserves an order at which input data events are received.</p>
<section id="storing-limitations">
<h4>Storing limitations<a class="headerlink" href="#storing-limitations" title="Permalink to this heading"></a></h4>
<p>The number of events that can be inserted into the queue is limited by <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_EVENT_QUEUE_SIZE</span></a> option.</p>
<dl>
<dt>Discarding events</dt><dd><p>When there is no space for a new input event, the HID state module tries to free space by discarding the oldest event in the queue.
Events stored in the queue are automatically discarded after the period defined by <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_REPORT_EXPIRATION</span></a> option.</p>
<p>When discarding an event from the queue, the module checks if the key associated with the event is pressed.
This is to avoid missing key releases for earlier key presses when the keys from the queue are replayed to the host.
If a key release is missed, the host could stay with a key that is permanently pressed.
The discarding mechanism ensures that the host will always receive the correct key sequence.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The HID state module can only discard an event if the event does not overlap any button that was pressed but not released, or if the button itself is pressed.
The event is released only when the following conditions are met:</p>
<ul class="simple">
<li><p>The associated key is not pressed anymore.</p></li>
<li><p>Every key that was pressed after the associated key had been pressed is also released.</p></li>
</ul>
</div>
</dd>
</dl>
<p>If there is no space to store the input event in the queue and no old event can be discarded, the entire content of the queue is dropped to ensure the sanity.</p>
<p>Once connection is established, the elements of the queue are replayed one after the other to the host, in a sequence of consecutive HID reports.</p>
</section>
</section>
<section id="tracking-state-of-transports">
<h3><a class="toc-backref" href="#id15">Tracking state of transports</a><a class="headerlink" href="#tracking-state-of-transports" title="Permalink to this heading"></a></h3>
<p>The HID state module refers collectively to all transports as _subscribers_.</p>
<p>The module tracks the state of the connected Bluetooth® LE peers and the state of USB by listening to <code class="docutils literal notranslate"><span class="pre">ble_peer_event</span></code> and <code class="docutils literal notranslate"><span class="pre">usb_state_event</span></code>, respectively.
When the connection to the host is indicated by any of these events, the HID state module will create a subscriber associated with the transport.</p>
<p>The subscriber that is associated with USB has priority over any Bluetooth LE peer subscriber.
As a result, when the device connects to the host through USB, all HID reports will be routed to USB.</p>
</section>
<section id="tracking-state-of-hid-report-notifications">
<h3><a class="toc-backref" href="#id16">Tracking state of HID report notifications</a><a class="headerlink" href="#tracking-state-of-hid-report-notifications" title="Permalink to this heading"></a></h3>
<p>For each subscriber, the HID state module tracks the state of notifications for each of the available HID reports.
These are tracked in the subscriber’s structure <code class="xref c c-struct docutils literal notranslate"><span class="pre">subscriber</span></code>.
This structure’s member <code class="docutils literal notranslate"><span class="pre">state</span></code> is an array of <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_state</span></code> structures.
Each element corresponds to one available HID report.</p>
<p>The subscriber connects to the HID reports by submitting <code class="docutils literal notranslate"><span class="pre">hid_report_subscription_event</span></code>.
Depending on the connection method, this event can be submitted:</p>
<ul class="simple">
<li><p>For Bluetooth, when the notification is enabled for a given HID report.</p></li>
<li><p>For USB, when the device is connected to USB.</p></li>
</ul>
<p>The <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_state</span></code> structure serves the following purposes:</p>
<ul class="simple">
<li><p>Tracks the state of the connection.</p></li>
<li><p>Contains the link connecting the object to the right <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_data</span></code> structure, from which the data is taken when the HID report is formed.</p></li>
<li><p>Tracks the number of reports of the associated type that were sent to the subscriber.</p></li>
</ul>
</section>
<section id="forming-hid-reports">
<h3><a class="toc-backref" href="#id17">Forming HID reports</a><a class="headerlink" href="#forming-hid-reports" title="Permalink to this heading"></a></h3>
<p>When a HID report is to be sent to the subscriber, the HID state module calls the function responsible for the report generation.
The <code class="xref c c-struct docutils literal notranslate"><span class="pre">report_data</span></code> structure is passed as an argument to this function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The HID report formatting function must work according to the HID report descriptor (<code class="docutils literal notranslate"><span class="pre">hid_report_desc</span></code>).
The source file containing the descriptor is given by <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_HID_REPORT_DESC</span></a> option.</p>
</div>
</section>
<section id="handling-hid-keyboard-led-state">
<h3><a class="toc-backref" href="#id18">Handling HID keyboard LED state</a><a class="headerlink" href="#handling-hid-keyboard-led-state" title="Permalink to this heading"></a></h3>
<p>When the HID state module receives a <code class="xref c c-struct docutils literal notranslate"><span class="pre">hid_report_event</span></code> that contains an HID output report, it updates the remembered information about the state of the HID output report of the appropriate subscriber.</p>
<p>By default, nRF Desktop supports only HID keyboard LED output report.
The nRF Desktop peripheral displays the state of the keyboard LEDs that was specified by the HID subscriber that subscribed for keyboard key HID input report.
When the subscriber is changed or it updates the state of the keyboard LEDs, the HID state module sends <code class="xref c c-struct docutils literal notranslate"><span class="pre">leds_event</span></code> to update the state of the hardware LEDs.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hid_state_pm.html" class="btn btn-neutral float-right" title="HID state power manager module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hid_forward.html" class="btn btn-neutral" title="HID forward module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>