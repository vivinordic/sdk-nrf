<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Motion module &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../../_static/js/ncs.js"
></script>
<script src="../../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Passkey module" href="passkey.html" />
    <link rel="prev" title="LEDs module" href="leds.html" />
<link
  href="../../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../protocols.html">Protocols</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../applications.html">Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../connectivity_bridge/README.html">Connectivity bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../asset_tracker_v2/README.html">nRF9160: Asset Tracker v2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../serial_lte_modem/README.html">nRF9160: Serial LTE modem</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../README.html">nRF Desktop</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../README.html#overview-firmware-architecture">Overview: Firmware architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#user-interface">User interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#building-and-running">Building and running</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#integrating-your-own-hardware">Integrating your own hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#dependencies">Dependencies</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../README.html#application-internal-modules">Application internal modules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="main.html">Basic module (main)</a></li>
<li class="toctree-l4"><a class="reference internal" href="battery_charger.html">Battery charger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="battery_meas.html">Battery measurement module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_adv.html">Bluetooth LE advertising module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_bond.html">Bluetooth LE bond module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_conn_params.html">Bluetooth LE connection parameters module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_discovery.html">Bluetooth LE discovery module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_latency.html">Bluetooth LE latency module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_passkey.html">Bluetooth LE passkey module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_qos.html">Bluetooth LE Quality of Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_scan.html">Bluetooth LE scanning module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_state_pm.html">Bluetooth state power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_state.html">Bluetooth LE state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="board.html">Board module</a></li>
<li class="toctree-l4"><a class="reference internal" href="buttons.html">Buttons module</a></li>
<li class="toctree-l4"><a class="reference internal" href="buttons_sim.html">Button simulator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="click_detector.html">Click detector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="config_channel.html">Configuration channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="cpu_meas.html">CPU measurement module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dev_descr.html">Device description module</a></li>
<li class="toctree-l4"><a class="reference internal" href="dfu.html">Device Firmware Upgrade module</a></li>
<li class="toctree-l4"><a class="reference internal" href="failsafe.html">Failsafe module</a></li>
<li class="toctree-l4"><a class="reference internal" href="fast_pair_app.html">Fast Pair module</a></li>
<li class="toctree-l4"><a class="reference internal" href="fn_keys.html">Function key module</a></li>
<li class="toctree-l4"><a class="reference internal" href="bas.html">GATT Battery Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hid_forward.html">HID forward module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hid_state.html">HID state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hid_state_pm.html">HID state power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hids.html">HID Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="info.html">Info module</a></li>
<li class="toctree-l4"><a class="reference internal" href="led_state.html">LED state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="led_stream.html">LED stream module</a></li>
<li class="toctree-l4"><a class="reference internal" href="leds.html">LEDs module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Motion module</a></li>
<li class="toctree-l4"><a class="reference internal" href="passkey.html">Passkey module</a></li>
<li class="toctree-l4"><a class="reference internal" href="power_manager.html">Power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nrf_profiler_sync.html">nRF Profiler synchronization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="qos.html">Quality of Service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="selector.html">Selector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="smp.html">Simple Management Protocol module</a></li>
<li class="toctree-l4"><a class="reference internal" href="settings_loader.html">Settings loader module</a></li>
<li class="toctree-l4"><a class="reference internal" href="usb_state_pm.html">USB state power manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="usb_state.html">USB state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="watchdog.html">Watchdog module</a></li>
<li class="toctree-l4"><a class="reference internal" href="wheel.html">Wheel module</a></li>
<li class="toctree-l4"><a class="reference internal" href="constlat.html">Constant latency hotfix module</a></li>
<li class="toctree-l4"><a class="reference internal" href="hfclk_lock.html">High frequency clock lock hotfix module</a></li>
<li class="toctree-l4"><a class="reference internal" href="event_rel_modules.html">Source and sink module lists</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#application-configuration-options">Application configuration options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#api-documentation">API documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../nrf5340_audio/README.html">nRF5340 Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../machine_learning/README.html">nRF Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matter_weather_station/README.html">Thingy:53: Matter weather station</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../zigbee_weather_station/README.html">Thingy:53: Zigbee weather station</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples.html">Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../applications.html">Applications</a></li>
          <li class="breadcrumb-item"><a href="../README.html">nRF Desktop</a></li>
      <li class="breadcrumb-item active">Motion module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/applications/nrf_desktop/doc/motion.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="motion-module">
<span id="nrf-desktop-motion"></span><h1>Motion module<a class="headerlink" href="#motion-module" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-events" id="id6">Module events</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id7">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#movement-data-from-motion-sensors" id="id8">Movement data from motion sensors</a></p></li>
<li><p><a class="reference internal" href="#movement-data-from-buttons" id="id9">Movement data from buttons</a></p></li>
<li><p><a class="reference internal" href="#simulated-movement-data" id="id10">Simulated movement data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuration-channel" id="id11">Configuration channel</a></p></li>
<li><p><a class="reference internal" href="#implementation-details" id="id12">Implementation details</a></p>
<ul>
<li><p><a class="reference internal" href="#motion-sensor" id="id13">Motion sensor</a></p></li>
<li><p><a class="reference internal" href="#sampling-thread" id="id14">Sampling thread</a></p></li>
<li><p><a class="reference internal" href="#sampling-pipeline" id="id15">Sampling pipeline</a></p></li>
</ul>
</li>
</ul>
</div>
<p>The motion module is responsible for generating events related to movement.
The movement can be detected using the motion sensor, but it can also be sourced from GPIO pins or simulated.</p>
<section id="module-events">
<h2><a class="toc-backref" href="#id6">Module events</a><a class="headerlink" href="#module-events" title="Permalink to this heading"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 21%" />
<col style="width: 8%" />
<col style="width: 15%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Source Module</p></th>
<th class="head"><p>Input Event</p></th>
<th class="head"><p>This Module</p></th>
<th class="head"><p>Output Event</p></th>
<th class="head"><p>Sink Module</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="buttons.html#nrf-desktop-buttons"><span class="std std-ref">Buttons module</span></a></p></td>
<td rowspan="3"><p><code class="docutils literal notranslate"><span class="pre">button_event</span></code></p></td>
<td rowspan="21"><p><code class="docutils literal notranslate"><span class="pre">motion</span></code></p></td>
<td rowspan="17"></td>
<td rowspan="17"></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="buttons_sim.html#nrf-desktop-buttons-sim"><span class="std std-ref">Button simulator module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="fn_keys.html#nrf-desktop-fn-keys"><span class="std std-ref">Function key module</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="event_rel_modules.html#nrf-desktop-config-event-sources"><span class="std std-ref">Source modules for config_event</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">config_event</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="power_manager.html#nrf-desktop-power-manager"><span class="std std-ref">Power manager module</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">power_down_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="hids.html#nrf-desktop-hids"><span class="std std-ref">HID Service module</span></a></p></td>
<td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">hid_report_sent_event</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="hids.html#nrf-desktop-hids"><span class="std std-ref">HID Service module</span></a></p></td>
<td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">hid_report_subscription_event</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="event_rel_modules.html#nrf-desktop-module-state-event-sources"><span class="std std-ref">Source modules for module_state_event</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">module_state_event</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="usb_state.html#nrf-desktop-usb-state"><span class="std std-ref">USB state module</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">usb_state_event</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="ble_adv.html#nrf-desktop-ble-adv"><span class="std std-ref">Bluetooth LE advertising module</span></a></p></td>
<td rowspan="6"><p><code class="docutils literal notranslate"><span class="pre">wake_up_event</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="buttons.html#nrf-desktop-buttons"><span class="std std-ref">Buttons module</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="hid_forward.html#nrf-desktop-hid-forward"><span class="std std-ref">HID forward module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#nrf-desktop-motion"><span class="std std-ref">Motion module</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="power_manager.html#nrf-desktop-power-manager"><span class="std std-ref">Power manager module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="wheel.html#nrf-desktop-wheel"><span class="std std-ref">Wheel module</span></a></p></td>
</tr>
<tr class="row-odd"><td rowspan="4"></td>
<td rowspan="4"></td>
<td><p><code class="docutils literal notranslate"><span class="pre">config_event</span></code></p></td>
<td><p><a class="reference internal" href="event_rel_modules.html#nrf-desktop-config-event-sinks"><span class="std std-ref">Sink modules for config_event</span></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">module_state_event</span></code></p></td>
<td><p><a class="reference internal" href="event_rel_modules.html#nrf-desktop-module-state-event-sinks"><span class="std std-ref">Sink modules for module_state_event</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">motion_event</span></code></p></td>
<td><p><a class="reference internal" href="hid_state.html#nrf-desktop-hid-state"><span class="std std-ref">HID state module</span></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">wake_up_event</span></code></p></td>
<td><p><a class="reference internal" href="event_rel_modules.html#nrf-desktop-wake-up-event-sinks"><span class="std std-ref">Sink modules for wake_up_event</span></a></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a class="reference internal" href="../README.html#nrf-desktop-architecture"><span class="std std-ref">Overview: Firmware architecture</span></a> for more information about the event-based communication in the nRF Desktop application and about how to read this table.</p>
</div>
</section>
<section id="configuration">
<span id="nrf-desktop-motion-configuration"></span><h2><a class="toc-backref" href="#id7">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>The motion module selects the source of movement based on the following configuration options:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_NONE</span></a> - Module is disabled.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_PMW3360_ENABLE</span></a> - Movement data is obtained from the gaming-grade <code class="docutils literal notranslate"><span class="pre">PMW3360</span></code> motion sensor.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_PAW3212_ENABLE</span></a> - Movement data is obtained from <code class="docutils literal notranslate"><span class="pre">PAW3212</span></code> motion sensor.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_BUTTONS_ENABLE</span></a> - Movement data is generated using buttons.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SIMULATED_ENABLE</span></a> - Movement data is simulated (controlled from Zephyr’s <span class="xref std std-ref">zephyr:shell_api</span>).</p></li>
</ul>
<p>See the following sections for more information.</p>
<p>Depending on the selected configuration option, a different implementation file is used during the build process.</p>
<section id="movement-data-from-motion-sensors">
<h3><a class="toc-backref" href="#id8">Movement data from motion sensors</a><a class="headerlink" href="#movement-data-from-motion-sensors" title="Permalink to this heading"></a></h3>
<p>Selecting either of the motion sensors (<a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_PMW3360_ENABLE</span></a> or <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_PAW3212_ENABLE</span></a>) adds the <code class="file docutils literal notranslate"><span class="pre">src/hw_interface/motion_sensor.c</span></code> file to the compilation.</p>
<p>The motion sensor is sampled from the context of a dedicated thread.
The option <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_THREAD_STACK_SIZE</span></a> is used to set the thread’s stack size.</p>
<p>The motion sensor default sensitivity and power saving switching times can be set with the following options:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_CPI</span></a> - Default CPI.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_SLEEP1_TIMEOUT_MS</span></a> - <code class="docutils literal notranslate"><span class="pre">Sleep</span> <span class="pre">1</span></code> mode default switch time.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_SLEEP2_TIMEOUT_MS</span></a> - <code class="docutils literal notranslate"><span class="pre">Sleep</span> <span class="pre">2</span></code> mode default switch time.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_SLEEP3_TIMEOUT_MS</span></a> - <code class="docutils literal notranslate"><span class="pre">Sleep</span> <span class="pre">3</span></code> mode default switch time.</p></li>
</ul>
<p>For more information, see the sensor documentation and the Kconfig help.</p>
</section>
<section id="movement-data-from-buttons">
<h3><a class="toc-backref" href="#id9">Movement data from buttons</a><a class="headerlink" href="#movement-data-from-buttons" title="Permalink to this heading"></a></h3>
<p>Selecting the <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_BUTTONS_ENABLE</span></a> option adds the <code class="file docutils literal notranslate"><span class="pre">src/hw_interface/motion_buttons.c</span></code> file to the compilation.</p>
</section>
<section id="simulated-movement-data">
<h3><a class="toc-backref" href="#id10">Simulated movement data</a><a class="headerlink" href="#simulated-movement-data" title="Permalink to this heading"></a></h3>
<p>Selecting the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_DESKTOP_MOTION_SIMULATED_ENABLE</span></code> option adds the <code class="file docutils literal notranslate"><span class="pre">src/hw_interface/motion_simulated.c</span></code> file to the compilation.</p>
<p>If the shell is available (the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_SHELL</span></code> option is set), the motion module registers a shell module <code class="docutils literal notranslate"><span class="pre">motion_sim</span></code> and links to it two commands: <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code>.
If the shell is not available, motion generation starts automatically when the device is connected to USB or Bluetooth®.</p>
<p>When started, the module will generate simulated motion events.
The movement data in each event will be tracing the predefined path, an eight-sided polygon.</p>
<p>You can configure the path with the following options:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SIMULATED_EDGE_TIME</span></a> - Sets how long each edge is traced.</p></li>
<li><p><a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SIMULATED_SCALE_FACTOR</span></a> - Scales the size of the polygon.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">stop</span></code> command will cause the module to stop generating new events.</p>
</section>
</section>
<section id="configuration-channel">
<h2><a class="toc-backref" href="#id11">Configuration channel</a><a class="headerlink" href="#configuration-channel" title="Permalink to this heading"></a></h2>
<p>In a <a class="reference internal" href="#nrf-desktop-motion-configuration"><span class="std std-ref">configuration</span></a> where either <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_PMW3360_ENABLE</span></a> or <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_PAW3212_ENABLE</span></a> is used, you can configure the module through the <a class="reference internal" href="config_channel.html#nrf-desktop-config-channel"><span class="std std-ref">Configuration channel</span></a>.
In these configurations, the module is a configuration channel listener and it provides the following configuration options:</p>
<ul>
<li><dl>
<dt><code class="xref c c-macro docutils literal notranslate"><span class="pre">OPT_DESCR_MODULE_VARIANT</span></code></dt><dd><p>This is a special, read-only option used to provide information about the module variant.
For the motion sensor, the module variant is a sensor model written in lowercase, for example <code class="docutils literal notranslate"><span class="pre">pmw3360</span></code> or <code class="docutils literal notranslate"><span class="pre">paw3212</span></code>.</p>
<p>The <a class="reference internal" href="../../../scripts/hid_configurator/README.html#nrf-desktop-config-channel-script"><span class="std std-ref">HID configurator for nRF Desktop</span></a> uses the sensor model to identify the descriptions of the configuration options.
These descriptions are defined in the <code class="file docutils literal notranslate"><span class="pre">nrf/scripts/hid_configurator/modules/module_config.py</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">cpi</span></code></dt><dd><p>The motion sensor CPI.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">downshift</span></code>, <code class="docutils literal notranslate"><span class="pre">rest1</span></code>, <code class="docutils literal notranslate"><span class="pre">rest2</span></code></dt><dd><p>These firmware option names correspond to switch times of motion sensor modes, namely the sleep modes of <code class="docutils literal notranslate"><span class="pre">PAW3212</span></code> and the rest modes of <code class="docutils literal notranslate"><span class="pre">PMW3360</span></code>.
These modes are used by a motion sensor to reduce the power consumption, but they also increase the sensor’s response time when a motion is detected after a period of inactivity.</p>
<p>The <a class="reference internal" href="../../../scripts/hid_configurator/README.html#nrf-desktop-config-channel-script"><span class="std std-ref">HID configurator for nRF Desktop</span></a> refers to these mode options using names that depend on the sensor variant:</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">PAW3212</span></code>, the mode options are called respectively: <code class="docutils literal notranslate"><span class="pre">sleep1_timeout</span></code>, <code class="docutils literal notranslate"><span class="pre">sleep2_timeout</span></code>, and <code class="docutils literal notranslate"><span class="pre">sleep3_timeout</span></code>.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">PMW3360</span></code>, the mode options are called respectively: <code class="docutils literal notranslate"><span class="pre">downshift_run</span></code>, <code class="docutils literal notranslate"><span class="pre">downshift_rest1</span></code>, and <code class="docutils literal notranslate"><span class="pre">downshift_rest2</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="implementation-details">
<h2><a class="toc-backref" href="#id12">Implementation details</a><a class="headerlink" href="#implementation-details" title="Permalink to this heading"></a></h2>
<p>This section describes the motion module implementation for motion sensors.</p>
<section id="motion-sensor">
<h3><a class="toc-backref" href="#id13">Motion sensor</a><a class="headerlink" href="#motion-sensor" title="Permalink to this heading"></a></h3>
<p>The motion module samples movement data from the motion sensor using the motion sensor driver.</p>
<p>The name of the device linked with the driver changes depending on the selected sensor.
The same is true for the names of sensor configuration options.
The nRF Desktop application aggregates the sensor-specific information and translates them to the application abstracts in the <code class="file docutils literal notranslate"><span class="pre">configuration/common/motion_sensor.h</span></code> header file.</p>
</section>
<section id="sampling-thread">
<h3><a class="toc-backref" href="#id14">Sampling thread</a><a class="headerlink" href="#sampling-thread" title="Permalink to this heading"></a></h3>
<p>The motion module uses a dedicated sampling thread to sample data from the motion sensor.
The reason for using the sampling thread is the long time required for data to be ready.
Using a dedicated thread also simplifies the module because the interaction with the sensor becomes sequential.
The sampling thread priority is set to 0 (the highest preemptive thread priority) because it is assumed that the data sampling happens in the background.</p>
<p>The sampling thread stays in the unready state blocked on a semaphore.
The semaphore is triggered when the motion sensor trigger sends a notification that the data is available or when other application event requires the module interaction with the sensor (for example, when configuration is submitted from the host).</p>
</section>
<section id="sampling-pipeline">
<h3><a class="toc-backref" href="#id15">Sampling pipeline</a><a class="headerlink" href="#sampling-pipeline" title="Permalink to this heading"></a></h3>
<p>The motion module starts in <code class="docutils literal notranslate"><span class="pre">STATE_DISABLED</span></code> and after initialization enters <code class="docutils literal notranslate"><span class="pre">STATE_DISCONNECTED</span></code>.
When disconnected, the module is not generating motion events, but the motion sensor is sampled to make sure its registers are cleared.</p>
<p>Upon connection, the following happens:</p>
<ol class="arabic">
<li><p>The motion module switches to the <code class="docutils literal notranslate"><span class="pre">STATE_IDLE</span></code> state, in which the module waits for the motion sensor trigger.</p></li>
<li><p>When a first motion is detected and the device is connected to a host (meaning it can transmit the HID data out), the module completes the following actions:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Switches to <code class="docutils literal notranslate"><span class="pre">STATE_FETCHING</span></code>.</p></li>
<li><p>Samples the motion data.</p></li>
<li><p>Submits the <code class="docutils literal notranslate"><span class="pre">motion_event</span></code>.</p></li>
<li><p>Waits for the indication that the <code class="docutils literal notranslate"><span class="pre">motion_event</span></code> data was transmitted to the host.
This is done when the module receives the <code class="docutils literal notranslate"><span class="pre">hid_report_sent_event</span></code> event.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>At that point, a next motion sampling is performed and the next <code class="docutils literal notranslate"><span class="pre">motion_event</span></code> sent.</p></li>
</ol>
<p>The module continues to sample data until disconnection or when there is no motion detected.
The <code class="docutils literal notranslate"><span class="pre">motion</span></code> module assumes no motion when a number of consecutive samples equal to <a class="reference internal" href="../README.html#config-desktop-app-options"><span class="std std-ref">CONFIG_DESKTOP_MOTION_SENSOR_EMPTY_SAMPLES_COUNT</span></a> returns zero on both axis.
In such case, the module will switch back to <code class="docutils literal notranslate"><span class="pre">STATE_IDLE</span></code> and wait for the motion sensor trigger.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="passkey.html" class="btn btn-neutral float-right" title="Passkey module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="leds.html" class="btn btn-neutral" title="LEDs module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>