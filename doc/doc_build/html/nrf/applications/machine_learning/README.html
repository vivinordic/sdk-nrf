<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nRF Machine Learning &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../_static/js/ncs.js"
></script>
<script src="../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Thingy:53: Matter weather station" href="../matter_weather_station/README.html" />
    <link rel="prev" title="nRF5340 Audio" href="../nrf5340_audio/README.html" />
<link
  href="../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../protocols.html">Protocols</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../applications.html">Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../connectivity_bridge/README.html">Connectivity bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../asset_tracker_v2/README.html">nRF9160: Asset Tracker v2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serial_lte_modem/README.html">nRF9160: Serial LTE modem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nrf_desktop/README.html">nRF Desktop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nrf5340_audio/README.html">nRF5340 Audio</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">nRF Machine Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sampling-sensors">Sampling sensors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forwarding-data">Forwarding data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#machine-learning-model">Machine learning model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#power-management">Power management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#firmware-architecture">Firmware architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-thingy-53">Programming Thingy:53</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-nrf53-dk">Programming nRF53 DK</a></li>
<li class="toctree-l4"><a class="reference internal" href="#custom-model-requirements">Custom model requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-forwarding-requirements">Data forwarding requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nrf-machine-learning-build-types">nRF Machine Learning build types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#user-interface">User interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#buttons">Buttons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#leds">LEDs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-files">Configuration files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-running">Building and running</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#selecting-a-build-type">Selecting a build type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#providing-api-key">Providing API key</a></li>
<li class="toctree-l4"><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#porting-guide">Porting guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-internal-modules">Application internal modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-documentation">API documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#edge-impulse-data-forwarder-event">Edge Impulse Data Forwarder Event</a></li>
<li class="toctree-l4"><a class="reference internal" href="#machine-learning-application-mode-event">Machine Learning Application Mode Event</a></li>
<li class="toctree-l4"><a class="reference internal" href="#machine-learning-result-event">Machine Learning Result Event</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sensor-simulator-event">Sensor Simulator Event</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../matter_weather_station/README.html">Thingy:53: Matter weather station</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zigbee_weather_station/README.html">Thingy:53: Zigbee weather station</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../samples.html">Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../applications.html">Applications</a></li>
      <li class="breadcrumb-item active">nRF Machine Learning</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/applications/machine_learning/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nrf-machine-learning">
<span id="nrf-machine-learning-app"></span><h1>nRF Machine Learning<a class="headerlink" href="#nrf-machine-learning" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#requirements" id="id10">Requirements</a></p></li>
<li><p><a class="reference internal" href="#overview" id="id11">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#sampling-sensors" id="id12">Sampling sensors</a></p></li>
<li><p><a class="reference internal" href="#forwarding-data" id="id13">Forwarding data</a></p></li>
<li><p><a class="reference internal" href="#machine-learning-model" id="id14">Machine learning model</a></p></li>
<li><p><a class="reference internal" href="#power-management" id="id15">Power management</a></p></li>
<li><p><a class="reference internal" href="#firmware-architecture" id="id16">Firmware architecture</a></p></li>
<li><p><a class="reference internal" href="#programming-thingy-53" id="id17">Programming Thingy:53</a></p></li>
<li><p><a class="reference internal" href="#programming-nrf53-dk" id="id18">Programming nRF53 DK</a></p></li>
<li><p><a class="reference internal" href="#custom-model-requirements" id="id19">Custom model requirements</a></p></li>
<li><p><a class="reference internal" href="#data-forwarding-requirements" id="id20">Data forwarding requirements</a></p></li>
<li><p><a class="reference internal" href="#nrf-machine-learning-build-types" id="id21">nRF Machine Learning build types</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#user-interface" id="id22">User interface</a></p>
<ul>
<li><p><a class="reference internal" href="#buttons" id="id23">Buttons</a></p></li>
<li><p><a class="reference internal" href="#leds" id="id24">LEDs</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuration" id="id25">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#configuration-files" id="id26">Configuration files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-and-running" id="id27">Building and running</a></p>
<ul>
<li><p><a class="reference internal" href="#selecting-a-build-type" id="id28">Selecting a build type</a></p></li>
<li><p><a class="reference internal" href="#providing-api-key" id="id29">Providing API key</a></p></li>
<li><p><a class="reference internal" href="#testing" id="id30">Testing</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#porting-guide" id="id31">Porting guide</a></p></li>
<li><p><a class="reference internal" href="#application-internal-modules" id="id32">Application internal modules</a></p></li>
<li><p><a class="reference internal" href="#dependencies" id="id33">Dependencies</a></p></li>
<li><p><a class="reference internal" href="#api-documentation" id="id34">API documentation</a></p>
<ul>
<li><p><a class="reference internal" href="#edge-impulse-data-forwarder-event" id="id35">Edge Impulse Data Forwarder Event</a></p></li>
<li><p><a class="reference internal" href="#machine-learning-application-mode-event" id="id36">Machine Learning Application Mode Event</a></p></li>
<li><p><a class="reference internal" href="#machine-learning-result-event" id="id37">Machine Learning Result Event</a></p></li>
<li><p><a class="reference internal" href="#sensor-simulator-event" id="id38">Sensor Simulator Event</a></p></li>
</ul>
</li>
</ul>
</div>
<p>The nRF Machine Learning application is an out of the box reference design of an <a class="reference external" href="https://docs.edgeimpulse.com/docs/what-is-embedded-machine-learning-anyway">embedded machine learning</a> using <a class="reference external" href="https://www.edgeimpulse.com/">Edge Impulse</a>.
The application gathers data from sensors, forwards data to the Edge Impulse platform, and runs the machine learning model.
It also displays results of the machine learning model on LEDs.
The Edge Impulse platform collects data from sensors, trains machine learning model, and deploys the model to your Nordic Semiconductor’s device.
To learn more about Edge Impulse support in the nRF Connect SDK see <a class="reference internal" href="../../external_comp/edge_impulse.html#ug-edge-impulse"><span class="std std-ref">Edge Impulse integration</span></a>.</p>
<section id="requirements">
<h2><a class="toc-backref" href="#id10">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h2>
<p>The application supports the following development kits:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 7%" />
<col style="width: 41%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Hardware platforms</p></th>
<th class="head"><p>PCA</p></th>
<th class="head"><p>Board name</p></th>
<th class="head"><p>Build target</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../working_with_nrf/nrf53/thingy53.html#ug-thingy53"><span class="std std-ref">Thingy:53</span></a></p></td>
<td><p>PCA20053</p></td>
<td><p><span class="xref std std-ref">thingy53_nrf5340</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">thingy53_nrf5340_cpuapp_ns</span></code>
<code class="docutils literal notranslate"><span class="pre">thingy53_nrf5340_cpuapp</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../working_with_nrf/nrf53/nrf5340.html#ug-nrf5340"><span class="std std-ref">nRF5340 DK</span></a></p></td>
<td><p>PCA10095</p></td>
<td><p><span class="xref std std-ref">nrf5340dk_nrf5340</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf5340dk_nrf5340_cpuapp</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../working_with_nrf/nrf52/developing.html#ug-nrf52"><span class="std std-ref">nRF52840 DK</span></a></p></td>
<td><p>PCA10056</p></td>
<td><p><span class="xref std std-ref">nrf52840dk_nrf52840</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf52840dk_nrf52840</span></code></p></td>
</tr>
</tbody>
</table>
<p>The available configurations use only built-in sensors or the simulated sensor signal.
You do not need to connect any additional components to the board.</p>
<p>When built for an <code class="docutils literal notranslate"><span class="pre">_ns</span></code> build target, the sample is configured to compile and run as a non-secure application with <a class="reference internal" href="../../app_dev/board_support/index.html#app-boards-spe-nspe-cpuapp-ns"><span class="std std-ref">Cortex-M Security Extensions enabled</span></a>.
Therefore, it automatically includes <a class="reference internal" href="../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M</span></a> that prepares the required peripherals and secure services to be available for the application.</p>
</section>
<section id="overview">
<h2><a class="toc-backref" href="#id11">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>To perform its tasks, the nRF Machine Learning application uses components available in Zephyr and the nRF Connect SDK, namely the <a class="reference internal" href="../../libraries/caf/index.html#lib-caf"><span class="std std-ref">Common Application Framework</span></a> modules and <span class="xref std std-ref">zephyr:sensor_api</span> for sampling sensors, and <span class="xref std std-ref">zephyr:uart_api</span> or <a class="reference internal" href="../../libraries/bluetooth_services/services/nus.html#nus-service-readme"><span class="std std-ref">Nordic UART Service (NUS)</span></a> for forwarding data.
It also uses the <a class="reference external" href="https://docs.edgeimpulse.com/docs/cli-data-forwarder">Edge Impulse’s data forwarder</a> protocol.</p>
<section id="sampling-sensors">
<h3><a class="toc-backref" href="#id12">Sampling sensors</a><a class="headerlink" href="#sampling-sensors" title="Permalink to this heading"></a></h3>
<p>The application handles the sensor sampling using the <a class="reference internal" href="../../libraries/caf/sensor_manager.html#caf-sensor-manager"><span class="std std-ref">CAF: Sensor manager module</span></a>.
This module uses Zephyr’s <span class="xref std std-ref">zephyr:sensor_api</span> to handle the sampling.
This approach allows to use any sensor available in Zephyr.</p>
<p>By default, the following sensors are used by the application:</p>
<ul class="simple">
<li><p>Thingy:53 - Built-in accelerometer (<code class="docutils literal notranslate"><span class="pre">ADXL362</span></code>).</p></li>
<li><p>nRF52840 Development Kit - Simulated sensor (<a class="reference internal" href="../../drivers/sensor_sim.html#sensor-sim"><span class="std std-ref">Simulated sensor driver</span></a>).
The simulated sensor generates predefined waves as acceleration.
This development kit does not have a built-in accelerometer.</p></li>
<li><p>nRF5340 Development Kit - Simulated sensor (<a class="reference internal" href="../../drivers/sensor_sim.html#sensor-sim"><span class="std std-ref">Simulated sensor driver</span></a>).
The simulated sensor generates predefined waves as acceleration.
This development kit does not have a built-in accelerometer.</p></li>
</ul>
</section>
<section id="forwarding-data">
<h3><a class="toc-backref" href="#id13">Forwarding data</a><a class="headerlink" href="#forwarding-data" title="Permalink to this heading"></a></h3>
<p>The application uses <a class="reference external" href="https://docs.edgeimpulse.com/docs/cli-data-forwarder">Edge Impulse’s data forwarder</a> protocol to forward data to <a class="reference external" href="https://studio.edgeimpulse.com/login">Edge Impulse studio</a>.
By default, the following transports are used:</p>
<ul class="simple">
<li><p>Thingy:53 uses <a class="reference internal" href="../../libraries/bluetooth_services/services/nus.html#nus-service-readme"><span class="std std-ref">Nordic UART Service (NUS)</span></a>.</p></li>
<li><p>nRF52840 Development Kit uses <span class="xref std std-ref">zephyr:uart_api</span>.</p></li>
<li><p>nRF5340 Development Kit uses <span class="xref std std-ref">zephyr:uart_api</span>.</p></li>
</ul>
</section>
<section id="machine-learning-model">
<h3><a class="toc-backref" href="#id14">Machine learning model</a><a class="headerlink" href="#machine-learning-model" title="Permalink to this heading"></a></h3>
<p>The application handles the machine learning model using the <a class="reference internal" href="../../libraries/others/ei_wrapper.html#ei-wrapper"><span class="std std-ref">Edge Impulse wrapper</span></a> library available in the nRF Connect SDK.
The model performs the classification task by assigning a label to input data.
The labels that are assigned by the machine learning model are specific to the given model.</p>
<p>By default, the application uses pretrained machine leaning models deployed in <a class="reference external" href="https://studio.edgeimpulse.com/login">Edge Impulse studio</a>:</p>
<ul>
<li><p>Thingy:53 uses the <a class="reference external" href="https://studio.edgeimpulse.com/public/33129/latest">nRF Connect SDK hardware accelerometer machine learning model</a>.
The model uses the data from the built-in accelerometer to recognize the following gestures:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">idle</span></code> - The device is placed on a flat surface.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">updown</span></code> - The device is moved in updown direction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rotate</span></code> - The device is rotated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tap</span></code> - The device is tapped while placed on a flat surface.</p></li>
</ul>
<p>Unknown gestures, such as shaking the device, are recognized as anomaly.</p>
</li>
<li><p>Both the nRF52840 Development Kit and nRF5340 Development Kit use the <a class="reference external" href="https://studio.edgeimpulse.com/public/18121/latest">nRF Connect SDK simulated sensor machine learning model</a>.
The model uses simulated sensor data to recognize the following simulated wave types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sine</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">triangle</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idle</span></code></p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">square</span></code> wave signal can also be generated by the simulated sensor.
This signal is unknown to the machine learning model and therefore it is marked as anomaly.</p>
</li>
</ul>
<p>The application displays LED effects that correspond to the machine learning results.
For more detailed information, see the <a class="reference internal" href="#user-interface">User interface</a> section.</p>
</section>
<section id="power-management">
<h3><a class="toc-backref" href="#id15">Power management</a><a class="headerlink" href="#power-management" title="Permalink to this heading"></a></h3>
<p>Reducing power consumption is important for every battery-powered device.</p>
<p>In the nRF Machine Learning application, application modules are automatically suspended or turned off if the device is not in use for a predefined period.
The application uses <a class="reference internal" href="../../libraries/caf/power_manager.html#caf-power-manager"><span class="std std-ref">CAF: Power manager module</span></a> for this purpose.
This means that Zephyr power management is forced to the <code class="xref c c-enumerator docutils literal notranslate"><span class="pre">PM_STATE_ACTIVE</span></code> state when the device is in either the Power management active or the Power management suspended state, but the power off state is forced directly by <a class="reference internal" href="../../libraries/caf/power_manager.html#caf-power-manager"><span class="std std-ref">CAF: Power manager module</span></a> as Zephyr’s <code class="xref c c-enumerator docutils literal notranslate"><span class="pre">PM_STATE_SOFT_OFF</span></code> state.</p>
<ul class="simple">
<li><p>In the <a class="reference internal" href="../../libraries/caf/caf_overview.html#c.power_manager_level.POWER_MANAGER_LEVEL_ALIVE" title="POWER_MANAGER_LEVEL_ALIVE"><code class="xref c c-enumerator docutils literal notranslate"><span class="pre">POWER_MANAGER_LEVEL_ALIVE</span></code></a> state, the device is in working condition, Bluetooth is advertising whenever required and all the connections are maintained.</p></li>
<li><p>In the <a class="reference internal" href="../../libraries/caf/caf_overview.html#c.power_manager_level.POWER_MANAGER_LEVEL_SUSPENDED" title="POWER_MANAGER_LEVEL_SUSPENDED"><code class="xref c c-enumerator docutils literal notranslate"><span class="pre">POWER_MANAGER_LEVEL_SUSPENDED</span></code></a> state, the device maintains the active Bluetooth connection.</p></li>
<li><p>In the <a class="reference internal" href="../../libraries/caf/caf_overview.html#c.power_manager_level.POWER_MANAGER_LEVEL_OFF" title="POWER_MANAGER_LEVEL_OFF"><code class="xref c c-enumerator docutils literal notranslate"><span class="pre">POWER_MANAGER_LEVEL_OFF</span></code></a> state, the CPU is switched to the off mode.</p></li>
</ul>
<p>In the suspended and OFF states, most of the functionalities are disabled.
For example, LEDs and sensors are turned off and Bluetooth advertising is stopped.</p>
<p>Any button press can wake up the device.</p>
<p>For the Thingy:53, the sensor supports a trigger that can be used for active power management.
As long as the device detects acceleration, the board is kept in the active state.
When the board is in the <a class="reference internal" href="../../libraries/caf/caf_overview.html#c.power_manager_level.POWER_MANAGER_LEVEL_SUSPENDED" title="POWER_MANAGER_LEVEL_SUSPENDED"><code class="xref c c-enumerator docutils literal notranslate"><span class="pre">POWER_MANAGER_LEVEL_SUSPENDED</span></code></a> state, it can be woken up by acceleration threshold by moving the device.</p>
<p>You can define the time interval after which the peripherals are suspended or powered off in the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_POWER_MANAGER_TIMEOUT</span></code> option.
By default, this period is set to 120 seconds.</p>
</section>
<section id="firmware-architecture">
<span id="nrf-machine-learning-app-architecture"></span><h3><a class="toc-backref" href="#id16">Firmware architecture</a><a class="headerlink" href="#firmware-architecture" title="Permalink to this heading"></a></h3>
<p>The nRF Machine Learning application has a modular structure, where each module has a defined scope of responsibility.
The application uses the <a class="reference internal" href="../../libraries/others/app_event_manager.html#app-event-manager"><span class="std std-ref">Application Event Manager</span></a> to distribute events between modules in the system.</p>
<p>The following figure shows the application architecture.
The figure visualizes relations between Application Event Manager, modules, drivers, and libraries.</p>
<figure class="align-default" id="id7">
<img alt="nRF Machine Learning application architecture" src="../../_images/ml_app_architecture.svg" /><figcaption>
<p><span class="caption-text">nRF Machine Learning application architecture</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Since the application architecture is uniform and the code is shared, the set of modules in use depends on configuration.
In other words, not all of the modules need to be enabled for a given reference design.
For example, the <a class="reference internal" href="../../libraries/caf/ble_state.html#caf-ble-state"><span class="std std-ref">CAF: Bluetooth LE state module</span></a> and <a class="reference internal" href="../../libraries/caf/ble_adv.html#caf-ble-adv"><span class="std std-ref">CAF: Bluetooth LE advertising module</span></a> modules are not enabled if the configuration does not use Bluetooth®.</p>
<p>See <a class="reference internal" href="#nrf-machine-learning-app-internal-modules"><span class="std std-ref">Application internal modules</span></a> for detailed information about every module used by the nRF Machine Learning application.</p>
</section>
<section id="programming-thingy-53">
<h3><a class="toc-backref" href="#id17">Programming Thingy:53</a><a class="headerlink" href="#programming-thingy-53" title="Permalink to this heading"></a></h3>
<p>If you build this application for Thingy:53, it enables additional features. See <a class="reference internal" href="../../working_with_nrf/nrf53/thingy53.html#thingy53-app-guide"><span class="std std-ref">Thingy:53 application guide</span></a> for details.</p>
</section>
<section id="programming-nrf53-dk">
<h3><a class="toc-backref" href="#id18">Programming nRF53 DK</a><a class="headerlink" href="#programming-nrf53-dk" title="Permalink to this heading"></a></h3>
<p>If you build this application for the nRF53 DK, it enables additional features similar to the ones that are enabled for Thingy:53:</p>
<ul class="simple">
<li><p>MCUboot bootloader with serial recovery and multi-image update.</p></li>
<li><p>Static configuration of <a class="reference internal" href="../../scripts/partition_manager/partition_manager.html#partition-manager"><span class="std std-ref">Partition Manager</span></a>.</p></li>
<li><p>DFU over-the-air using Simple Management Protocol over Bluetooth.</p></li>
</ul>
<p>See <a class="reference internal" href="../../working_with_nrf/nrf53/thingy53.html#ug-thingy53"><span class="std std-ref">Developing with Thingy:53</span></a> for detailed information about the mentioned features.</p>
<p>The nRF53 DK has a J-Link debug IC that can be used to program the firmware.
Alternatively, firmware can be updated over MCUBoot serial recovery or DFU over-the-air using Simple Management Protocol over Bluetooth.
Keep in mind that if you use bootloader to update firmware, the new firmware must be compatible with used bootloader and partition map.</p>
<p>The nRF53 Development Kit uses RTT as logger’s backend.
The RTT logs can be easily accessed, because the Development Kit has a built-in SEGGER chip.</p>
</section>
<section id="custom-model-requirements">
<h3><a class="toc-backref" href="#id19">Custom model requirements</a><a class="headerlink" href="#custom-model-requirements" title="Permalink to this heading"></a></h3>
<p>The default application configurations rely on pretrained machine learning models that can be automatically downloaded during the application build.
If you want to train and deploy a custom machine learning model using <a class="reference external" href="https://studio.edgeimpulse.com/login">Edge Impulse Studio</a>, you need a user account for the Edge Impulse Studio web-based tool.
The user account is not needed to perform predictions using the pretrained models.</p>
</section>
<section id="data-forwarding-requirements">
<h3><a class="toc-backref" href="#id20">Data forwarding requirements</a><a class="headerlink" href="#data-forwarding-requirements" title="Permalink to this heading"></a></h3>
<p>To forward the collected data using <a class="reference external" href="https://docs.edgeimpulse.com/docs/cli-data-forwarder">Edge Impulse’s data forwarder</a>, you must install the Edge Impulse CLI.
See <a class="reference external" href="https://docs.edgeimpulse.com/docs/cli-installation">Edge Impulse CLI installation guide</a> for instructions.</p>
<section id="nordic-uart-service-requirements">
<h4>Nordic UART Service requirements<a class="headerlink" href="#nordic-uart-service-requirements" title="Permalink to this heading"></a></h4>
<p>If you want to forward data over Nordic UART Service (NUS), you need an additional development kit that is able to run the <a class="reference internal" href="../../samples/bluetooth/central_uart/README.html#central-uart"><span class="std std-ref">Bluetooth: Central UART</span></a> sample.
Check the sample Requirements section for the list of supported development kits.
The sample is used to receive data over NUS and forward it to the host computer over UART.
See <a class="reference internal" href="#testing-with-thingy-53">Testing with Thingy:53</a> for how to test this solution.</p>
</section>
</section>
<section id="nrf-machine-learning-build-types">
<span id="nrf-machine-learning-app-requirements-build-types"></span><h3><a class="toc-backref" href="#id21">nRF Machine Learning build types</a><a class="headerlink" href="#nrf-machine-learning-build-types" title="Permalink to this heading"></a></h3>
<p>The nRF Machine Learning application does not use a single <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file.
Configuration files are provided for different build types for each supported board.</p>
<p>Each board has its own <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file, which represents a <code class="docutils literal notranslate"><span class="pre">debug</span></code> build type.
Other build types are covered by dedicated files with the build type added as a suffix to the <code class="docutils literal notranslate"><span class="pre">prj</span></code> part, as per the following list.
For example, the <code class="docutils literal notranslate"><span class="pre">release</span></code> build type file name is <code class="file docutils literal notranslate"><span class="pre">prj_release.conf</span></code>.
If a board has other configuration files, for example associated with partition layout or child image configuration, these follow the same pattern.</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">CONF_FILE</span></code> variable contains a single file and this file follows the naming pattern <code class="file docutils literal notranslate"><span class="pre">prj_&lt;buildtype&gt;.conf</span></code>, then the build type will be inferred to be <em>&lt;buildtype&gt;</em>.
The build type cannot be set explicitly.
The <em>&lt;buildtype&gt;</em> can be any string, but it is common to use <code class="docutils literal notranslate"><span class="pre">release</span></code> and <code class="docutils literal notranslate"><span class="pre">debug</span></code>.</p>
<p>For information about how to set variables, see <span class="xref std std-ref">zephyr:important-build-vars</span> in the Zephyr documentation.</p>
<p>The Partition Manager’s <a class="reference internal" href="../../scripts/partition_manager/partition_manager.html#ug-pm-static"><span class="std std-ref">static configuration</span></a> can also be made dependent on the build type.
When the build type has been inferred, the file <code class="file docutils literal notranslate"><span class="pre">pm_static_&lt;buildtype&gt;.yml</span></code> will have precedence over <code class="file docutils literal notranslate"><span class="pre">pm_static.yml</span></code>.</p>
<p>The child image Kconfig configuration can also be made dependent on the build type.
The child image Kconfig overlay file is named <code class="file docutils literal notranslate"><span class="pre">child_image/&lt;child_image_name&gt;.conf</span></code> instead of <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code>, but otherwise follows the same pattern as the parent Kconfig.</p>
<p>Alternatively, the child image Kconfig configuration file can be introduced as <code class="file docutils literal notranslate"><span class="pre">child_image/&lt;child_image_name&gt;/prj.conf</span></code> and follow the same pattern as the parent Kconfig.
For example, <code class="file docutils literal notranslate"><span class="pre">child_image/mcuboot/prj_release.conf</span></code> can be used to define <code class="docutils literal notranslate"><span class="pre">release</span></code> build type for <code class="docutils literal notranslate"><span class="pre">mcuboot</span></code> child image.</p>
<p>Before you start testing the application, you can select one of the build types supported by nRF Machine Learning application, depending on your development kit and the building method.
The application supports the following build types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">debug</span></code> – Debug version of the application - can be used to verify if the application works correctly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">release</span></code> – Release version of the application - can be used to achieve better performance and reduce memory consumption.</p></li>
</ul>
<p>Not every board supports both mentioned build types.
The given board can also support some additional configurations of the nRF Machine Learning application.
For example, the nRF52840 Development Kit supports <code class="docutils literal notranslate"><span class="pre">nus</span></code> configuration that uses <a class="reference internal" href="../../libraries/bluetooth_services/services/nus.html#nus-service-readme"><span class="std std-ref">Nordic UART Service (NUS)</span></a> instead of <span class="xref std std-ref">zephyr:uart_api</span> for data forwarding.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#selecting-a-build-type">Selecting a build type</a> is optional.
The <code class="docutils literal notranslate"><span class="pre">debug</span></code> build type is used by default if no build type is explicitly selected.</p>
</div>
</section>
</section>
<section id="user-interface">
<h2><a class="toc-backref" href="#id22">User interface</a><a class="headerlink" href="#user-interface" title="Permalink to this heading"></a></h2>
<p>The application supports a simple user interface.
You can control the application using predefined buttons, while LEDs are used to display information.</p>
<section id="buttons">
<h3><a class="toc-backref" href="#id23">Buttons</a><a class="headerlink" href="#buttons" title="Permalink to this heading"></a></h3>
<p>The application supports a button that is used to switch between data forwarding and running the machine learning model.
You can trigger the change by pressing and holding the button for longer than 5 seconds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a given configuration supports Bluetooth, then two sequences of the button press and release in a short time interval, shortly after application boot, removes the Bluetooth bonds.</p>
</div>
<p>If the application uses the simulated sensor signal, you can use another button to change signal generated by the simulated sensor.
The change is triggered by any press of the button.</p>
<p>By default, the following buttons are used by the application:</p>
<ul class="simple">
<li><p>Thingy:53:</p>
<ul>
<li><p>The <strong>SW3</strong> button switches between data forwarding and running the machine learning model.</p></li>
</ul>
</li>
<li><p>nRF52840 and nRF5340 Development Kit:</p>
<ul>
<li><p><strong>Button 1</strong> switches between data forwarding and running a machine learning model.</p></li>
<li><p><strong>Button 3</strong> changes the signal generated by the simulated sensor.</p></li>
</ul>
</li>
</ul>
</section>
<section id="leds">
<h3><a class="toc-backref" href="#id24">LEDs</a><a class="headerlink" href="#leds" title="Permalink to this heading"></a></h3>
<p>The application uses one LED to display the application state.
The LED displays either the state of data forwarding or the machine learning prediction results.
You can configure the LED effect in the application configuration files.</p>
<p>If the application uses the simulated sensor signal, it uses another LED to display the effect that represents the signal generated by the simulated sensor.
The application defines common LED effects for both the machine learning results and the simulated sensor signal.</p>
<p>By default, the application uses the following LED effects:</p>
<ul>
<li><p>Thingy:53 displays the application state in the RGB scale using <strong>LED1</strong>.</p>
<ul>
<li><p>If the device is returning the machine learning prediction results, the LED uses following predefined colors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rotate</span></code> - Red</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">updown</span></code> - Green</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tap</span></code> - Blue</p></li>
<li><p>Anomaly - Purple</p></li>
</ul>
<p>If the machine learning model is running, but it has not detected anything yet or the <code class="docutils literal notranslate"><span class="pre">idle</span></code> state is detected, the LED is blinking.
After a successful detection, the LED is set to the predefined color.
The LED effect is overridden on the next successful detection.</p>
</li>
<li><p>If the device forwards data, the LED color turns red and uses the following blinking patterns:</p>
<ul class="simple">
<li><p>LED blinks slowly if it is not connected.</p></li>
<li><p>LED blinks with an average frequency if it is connected, but is not actively forwarding data.</p></li>
<li><p>LED blinks rapidly if it is connected and is actively forwarding data.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Both nRF5340 Development Kit and nRF52840 Development Kit use monochromatic LEDs to display the application state.
The <strong>LED1</strong> displays the application state and the <strong>LED2</strong> displays the signal generated by the simulated sensor.</p>
<ul>
<li><p>If the device is returning the machine learning prediction results, the <strong>LED1</strong> blinks for a predefined number of times and then turns off for a period of time.
Then the sequence is repeated.
The machine learning result is represented by the number of blinks:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sine</span></code> - 1 blink</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">triangle</span></code> - 2 blinks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">square</span></code> - 3 blinks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idle</span></code> - 4 blinks</p></li>
</ul>
<p>If the machine learning model is running, but it has not detected anything yet or it has detected an anomaly, the <strong>LED1</strong> is breathing.</p>
</li>
<li><p>If the device forwards data, the <strong>LED1</strong> uses the following blinking patterns:</p>
<ul class="simple">
<li><p>LED blinks slowly if it is not connected.</p></li>
<li><p>LED blinks with an average frequency if it is connected, but is not actively forwarding data.</p></li>
<li><p>LED blinks rapidly if it is connected and is actively forwarding data.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="configuration">
<span id="nrf-machine-learning-app-configuration"></span><h2><a class="toc-backref" href="#id25">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>The nRF Machine Learning application is modular and event driven.
You can enable and configure the modules separately for selected board and build type.
See the documentation page of selected module for information about functionalities provided by the module and its configuration.
See <a class="reference internal" href="#nrf-machine-learning-app-internal-modules"><span class="std std-ref">Application internal modules</span></a> for list of modules available in the application.</p>
<section id="configuration-files">
<h3><a class="toc-backref" href="#id26">Configuration files</a><a class="headerlink" href="#configuration-files" title="Permalink to this heading"></a></h3>
<p>The nRF Machine Learning application uses the following files as configuration sources:</p>
<ul class="simple">
<li><p>Devicetree Specification (DTS) files - These reflect the hardware configuration.
See <span class="xref std std-ref">zephyr:dt-guide</span> for more information about the DTS data structure.</p></li>
<li><p>Kconfig files - These reflect the software configuration.
See <span class="xref std std-ref">kconfig_tips_and_tricks</span> for information about how to configure them.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">_def</span></code> files - These contain configuration arrays for the application modules.
The <code class="file docutils literal notranslate"><span class="pre">_def</span></code> files are used by the nRF Machine Learning application modules and <a class="reference internal" href="../../libraries/caf/index.html#lib-caf"><span class="std std-ref">Common Application Framework</span></a> modules.</p></li>
</ul>
<p>The application configuration files for a given board must be defined in a board-specific directory in the <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/configuration/</span></code> directory.
For example, the configuration files for the Thingy:53 are defined in the <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/configuration/thingy53_nrf5340_cpuapp</span></code> directory.</p>
<p>The following configuration files can be defined for any supported board:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">prj_build_type.conf</span></code> - Kconfig configuration file for a build type.
To support a given build type for the selected board, you must define the configuration file with a proper name.
For example, the <code class="file docutils literal notranslate"><span class="pre">prj_release.conf</span></code> defines configuration for <code class="docutils literal notranslate"><span class="pre">release</span></code> build type.
The <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> without any suffix defines the <code class="docutils literal notranslate"><span class="pre">debug</span></code> build type.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">app.overlay</span></code> - DTS overlay file specific for the board.
Defining the DTS overlay file for a given board is optional.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">_def</span></code> files - These files are defined separately for modules used by the application.
You must define a <code class="file docutils literal notranslate"><span class="pre">_def</span></code> file for every module that requires it and enable it in the configuration for the given board.
The <code class="file docutils literal notranslate"><span class="pre">_def</span></code> files that are common for all the boards and build types are located in the <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/configuration/common</span></code> directory.</p></li>
</ul>
<section id="advertising-configuration">
<h4>Advertising configuration<a class="headerlink" href="#advertising-configuration" title="Permalink to this heading"></a></h4>
<p>If a given build type enables Bluetooth, the <a class="reference internal" href="../../libraries/caf/ble_adv.html#caf-ble-adv"><span class="std std-ref">CAF: Bluetooth LE advertising module</span></a> is used to control the Bluetooth advertising.
This CAF module relies on <a class="reference internal" href="../../libraries/bluetooth_services/adv_prov.html#bt-le-adv-prov-readme"><span class="std std-ref">Bluetooth LE advertising providers</span></a> to manage advertising data and scan response data.
The nRF Machine Learning application configures the data providers in <code class="file docutils literal notranslate"><span class="pre">src/util/Kconfig</span></code>.
By default, the application enables a set of data providers available in the nRF Connect SDK and adds a custom provider that appends UUID128 of Nordic UART Service (NUS) to the scan response data if the NUS is enabled in the configuration and the Bluetooth local identity in use has no bond.</p>
</section>
<section id="multi-image-builds">
<h4>Multi-image builds<a class="headerlink" href="#multi-image-builds" title="Permalink to this heading"></a></h4>
<p>The Thingy:53 and nRF53 Development Kit use multi-image build with the following child images:</p>
<ul class="simple">
<li><p>MCUboot bootloader</p></li>
<li><p>Bluetooth HCI RPMsg</p></li>
</ul>
<p>You can define the application-specific configuration for the mentioned child images in the board-specific directory in the <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/configuration/</span></code> directory.
The Kconfig configuration file should be located in subdirectory <code class="file docutils literal notranslate"><span class="pre">child_image/child_image_name</span></code> and its name should match the application Kconfig file name, that is contain the build type if necessary
For example, the <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/configuration/thingy53_nrf5340_cpuapp/child_image/hci_rpmsg/prj.conf</span></code> file defines configuration of Bluetooth HCI RPMsg for <code class="docutils literal notranslate"><span class="pre">debug</span></code> build type on <code class="docutils literal notranslate"><span class="pre">thingy53_nrf5340_cpuapp</span></code> board, while the <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/configuration/thingy53_nrf5340_cpuapp/child_image/hci_rpmsg/prj_release.conf</span></code> file defines configuration of Bluetooth HCI RPMsg for <code class="docutils literal notranslate"><span class="pre">release</span></code> build type.
See <a class="reference internal" href="../../app_dev/multi_image/index.html#ug-multi-image"><span class="std std-ref">Multi-image builds</span></a> for detailed information about multi-image builds and child image configuration.</p>
</section>
</section>
</section>
<section id="building-and-running">
<span id="nrf-machine-learning-app-configuration-build-types"></span><h2><a class="toc-backref" href="#id27">Building and running</a><a class="headerlink" href="#building-and-running" title="Permalink to this heading"></a></h2>
<p>The nRF machine learning application is built the same way to any other nRF Connect SDK application or sample.
Building the default configurations requires an Internet connection, because the machine learning model source files are downloaded from web during the application build.</p>
<p>This sample can be found under <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning</span></code> in the nRF Connect SDK folder structure.</p>
<p>When built as firmware image for the <code class="docutils literal notranslate"><span class="pre">_ns</span></code> build target, the sample has Cortex-M Security Extensions (CMSE) enabled and separates the firmware between Non-Secure Processing Environment (NSPE) and Secure Processing Environment (SPE).
Because of this, it automatically includes the <a class="reference internal" href="../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M (TF-M)</span></a>.
To read more about CMSE, see <a class="reference internal" href="../../app_dev/board_support/index.html#app-boards-spe-nspe"><span class="std std-ref">Processing environments</span></a>.</p>
<p>To build the sample with Visual Studio Code, follow the steps listed on the <a class="reference external" href="https://nrfconnect.github.io/vscode-nrf-connect/get_started/build_app_ncs.html">How to build an application</a> page in the nRF Connect for VS Code extension documentation.
See <a class="reference internal" href="../../getting_started/programming.html#gs-programming"><span class="std std-ref">Building and programming an application</span></a> for other building and programming scenarios and <a class="reference internal" href="../../getting_started/testing.html#gs-testing"><span class="std std-ref">Testing and debugging an application</span></a> for general information about testing and debugging in the nRF Connect SDK.</p>
<section id="selecting-a-build-type">
<h3><a class="toc-backref" href="#id28">Selecting a build type</a><a class="headerlink" href="#selecting-a-build-type" title="Permalink to this heading"></a></h3>
<p>Before you start testing the application, you can select one of the <a class="reference internal" href="#nrf-machine-learning-app-requirements-build-types"><span class="std std-ref">nRF Machine Learning build types</span></a>, depending on your development kit and building method.</p>
<section id="selecting-a-build-type-in-vsc">
<h4>Selecting a build type in Visual Studio Code<a class="headerlink" href="#selecting-a-build-type-in-vsc" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>To select the build type in the nRF Connect for VS Code extension:</p>
<ol class="arabic simple">
<li><p>When <a class="reference external" href="https://nrfconnect.github.io/vscode-nrf-connect/get_started/build_app_ncs.html">building an application</a> as described in the nRF Connect for VS Code extension documentation, follow the steps for setting up the build configuration.</p></li>
<li><p>In the <strong>Add Build Configuration</strong> screen, select the desired <code class="file docutils literal notranslate"><span class="pre">.conf</span></code> file from the <span class="guilabel">Configuration</span> drop-down menu.</p></li>
<li><p>Fill in other configuration options, if applicable, and click <span class="guilabel">Build Configuration</span>.</p></li>
</ol>
</div></blockquote>
</section>
<section id="selecting-a-build-type-from-command-line">
<h4>Selecting a build type from command line<a class="headerlink" href="#selecting-a-build-type-from-command-line" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>To select the build type when building the application from command line, specify the build type by adding the following parameter to the <code class="docutils literal notranslate"><span class="pre">west</span> <span class="pre">build</span></code> command:</p>
<pre class="highlight literal-block">-- -DCONF_FILE=prj_<em>selected_build_type</em>.conf</pre>
<p>For example, you can replace the <em>selected_build_type</em> variable to build the <code class="docutils literal notranslate"><span class="pre">release</span></code> firmware for <code class="docutils literal notranslate"><span class="pre">nrf52840dk_nrf52840</span></code> by running the following command in the project directory:</p>
<div class="highlight highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">west</span> <span class="n">build</span> <span class="o">-</span><span class="n">b</span> <span class="n">nrf52840dk_nrf52840</span> <span class="o">-</span><span class="n">d</span> <span class="n">build_nrf52840dk_nrf52840</span> <span class="o">--</span> <span class="o">-</span><span class="n">DCONF_FILE</span><span class="o">=</span><span class="n">prj_release</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">build_nrf52840dk_nrf52840</span></code> parameter specifies the output directory for the build files.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the selected board does not support the selected build type, the build is interrupted.
For example, if the <code class="docutils literal notranslate"><span class="pre">nus</span></code> build type is not supported by the selected board, the following notification appears:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Configuration file for build type ``nus`` is missing.</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="providing-api-key">
<h3><a class="toc-backref" href="#id29">Providing API key</a><a class="headerlink" href="#providing-api-key" title="Permalink to this heading"></a></h3>
<p>If the URI of the Edge Impulse zip file requires providing an additional API key, you can provide it using the following CMake definition: <code class="xref c c-macro docutils literal notranslate"><span class="pre">EI_API_KEY_HEADER</span></code>.
This definition is set in a similar way as selected build type.
For more detailed information about building the machine learning model in the nRF Connect SDK, see <a class="reference internal" href="../../external_comp/edge_impulse.html#ug-edge-impulse"><span class="std std-ref">Edge Impulse integration</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The nRF Machine Learning application configurations available in the nRF Connect SDK do not require providing an API key to download the model.
The model is downloaded from the web, but no authentication is required.</p>
</div>
</section>
<section id="testing">
<h3><a class="toc-backref" href="#id30">Testing</a><a class="headerlink" href="#testing" title="Permalink to this heading"></a></h3>
<p>After programming the application to your development kit, you can test the nRF Machine Learning application.
You can test running the machine learning model on an embedded device and forwarding data to <a class="reference external" href="https://studio.edgeimpulse.com/login">Edge Impulse studio</a>.
The detailed test steps for the Development Kits and the Thingy:53 are described in the following subsections.</p>
<section id="application-logs">
<h4>Application logs<a class="headerlink" href="#application-logs" title="Permalink to this heading"></a></h4>
<p>In most of the provided debug configurations, the application provides logs through the RTT.
See <a class="reference internal" href="../../getting_started/testing.html#testing-rtt-connect"><span class="std std-ref">Connecting using RTT</span></a> for detailed instructions about accessing the logs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Thingy:53 in the <code class="docutils literal notranslate"><span class="pre">debug</span></code> configuration provides logs through the USB CDC ACM serial.
See <a class="reference internal" href="../../working_with_nrf/nrf53/thingy53.html#ug-thingy53"><span class="std std-ref">Developing with Thingy:53</span></a> for detailed information about working with the Thingy:53.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">rtt</span></code> configuration to have the Thingy:53 use RTT for logs.</p>
</div>
</section>
<section id="testing-with-thingy-53">
<h4>Testing with Thingy:53<a class="headerlink" href="#testing-with-thingy-53" title="Permalink to this heading"></a></h4>
<p>After programming the application, perform the following steps to test the nRF Machine Learning application on the Thingy:</p>
<ol class="arabic simple">
<li><p>Turn on the Thingy.
The application starts in a mode that runs the machine learning model.
The RGB LED is blinking, because no gesture has been recognized by the machine learning model yet.</p></li>
<li><p>Tap the device.
The <code class="docutils literal notranslate"><span class="pre">tap</span></code> gesture is recognized by the machine learning model.
The LED color changes to blue and the LED stays turned on.</p></li>
<li><p>Move the device up and down.
The <code class="docutils literal notranslate"><span class="pre">updown</span></code> gesture is recognized by the machine learning model.
The LED color changes to green and the LED stays turned on.</p></li>
<li><p>Rotate the device.
The <code class="docutils literal notranslate"><span class="pre">rotate</span></code> gesture is recognized by the machine learning model.
The LED color changes to red and the LED stays turned on.</p></li>
<li><p>Shake the device.
The machine learning model detects an anomaly.
The LED color changes to purple and the LED stays turned on.</p></li>
<li><p>Press and hold the button for more than 5 seconds to switch to the data forwarding mode.
After the mode is switched, the LED color changes to red and the LED starts blinking very slowly.</p></li>
<li><p>Program the <a class="reference internal" href="../../samples/bluetooth/central_uart/README.html#central-uart"><span class="std std-ref">Bluetooth: Central UART</span></a> sample to a compatible development kit, for example the nRF52840 Development Kit.</p></li>
<li><p>Turn on the programmed device.
After a brief delay, the Bluetooth® connection between the sample and the Thingy is established.
The Thingy forwards the sensor readouts over NUS.
The LED on the Thingy starts to blink rapidly.</p></li>
<li><p>Connect to the Bluetooth® Central UART sample with a terminal emulator (for example, PuTTY).
See <a class="reference internal" href="../../getting_started/testing.html#putty"><span class="std std-ref">How to connect with PuTTY</span></a> for the required settings.</p></li>
<li><p>Observe the sensor readouts represented as comma-separated values.
Every line represents a single sensor readout.
The Thingy forwards sensor readouts over NUS to the Central UART sample.
The sample forwards the data to the host over UART.</p></li>
<li><p>Turn off PuTTY to ensure that only one program has access to data on UART.</p></li>
</ol>
<p>Optionally, you can also connect to the device using <a class="reference external" href="https://docs.edgeimpulse.com/docs/cli-data-forwarder">Edge Impulse’s data forwarder</a> and forward data to <a class="reference external" href="https://studio.edgeimpulse.com/login">Edge Impulse studio</a> (after logging in).
See <a class="reference internal" href="#forwarding-data-to-edge-impulse-studio">Forwarding data to Edge Impulse studio</a> for details.</p>
</section>
<section id="testing-with-the-nrf52840-or-nrf53-dk">
<h4>Testing with the nRF52840 or nRF53 DK<a class="headerlink" href="#testing-with-the-nrf52840-or-nrf53-dk" title="Permalink to this heading"></a></h4>
<p>After programming the application, perform the following steps to test the nRF Machine Learning application on the Development Kit:</p>
<ol class="arabic simple">
<li><p>Turn on the development kit.
The application starts in a mode that runs the machine learning model.
Initially, <strong>LED2</strong> displays the LED effect representing <code class="docutils literal notranslate"><span class="pre">sine</span></code> wave (1 blink) and <strong>LED1</strong> is breathing, because the signal was not yet recognized by the machine learning model.
After a brief delay, the machine learning model recognizes the simulated signal.
<strong>LED1</strong> and <strong>LED2</strong> display the same LED effect.</p></li>
<li><p>Press <strong>Button 3</strong> to change the generated acceleration signal.
Right after the signal change, effects displayed by LEDs are different.
After a brief delay, the machine learning model recognizes the <code class="docutils literal notranslate"><span class="pre">triangle</span></code> wave and the same effect (2 blinks) is displayed by both LEDs.</p></li>
<li><p>Press <strong>Button 3</strong> to again change generated acceleration signal.
The <code class="docutils literal notranslate"><span class="pre">square</span></code> wave (3 blinks) is displayed only by the <strong>LED2</strong>.
This signal is marked as anomaly by the machine learning model and <strong>LED1</strong> starts breathing.</p></li>
<li><p>Press and hold <strong>Button 1</strong> for more than 5 seconds to switch to the data forwarding mode.
After the mode is switched, <strong>LED1</strong> starts to blink rapidly.</p></li>
<li><p>Connect to the development kit with a terminal emulator (for example, PuTTY).
See <a class="reference internal" href="../../getting_started/testing.html#putty"><span class="std std-ref">How to connect with PuTTY</span></a> for the required settings.</p></li>
<li><p>Observe the sensor readouts represented as comma-separated values.
Every line represents a single sensor readout.</p></li>
<li><p>Turn off PuTTY to ensure that only one program will access data on UART.</p></li>
</ol>
<p>Optionally, you can also connect to the device using <a class="reference external" href="https://docs.edgeimpulse.com/docs/cli-data-forwarder">Edge Impulse’s data forwarder</a> and forward data to <a class="reference external" href="https://studio.edgeimpulse.com/login">Edge Impulse studio</a> (after logging in).
See <a class="reference internal" href="#forwarding-data-to-edge-impulse-studio">Forwarding data to Edge Impulse studio</a> for details.</p>
</section>
<section id="forwarding-data-to-edge-impulse-studio">
<h4>Forwarding data to Edge Impulse studio<a class="headerlink" href="#forwarding-data-to-edge-impulse-studio" title="Permalink to this heading"></a></h4>
<p>To start forwarding data to Edge Impulse studio:</p>
<ol class="arabic">
<li><p>Make sure you meet the <a class="reference internal" href="#data-forwarding-requirements">Data forwarding requirements</a> before forwarding data to Edge Impulse studio.</p></li>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">edge-impulse-data-forwarder</span></code> Edge Impulse command line tool.</p></li>
<li><p>Log in to <a class="reference external" href="https://studio.edgeimpulse.com/login">Edge Impulse studio</a> and perform the following steps:</p>
<ol class="loweralpha">
<li><p>Select the <span class="guilabel">Data acquisition</span> tab.</p></li>
<li><p>In the <strong>Record new data</strong> panel, set the desired values and click <span class="guilabel">Start sampling</span>.</p>
<figure class="align-default" id="id8">
<a class="reference internal image-reference" href="../../_images/ei_data_acquisition.png"><img alt="Sampling under Data acquisition in Edge Impulse studio" src="../../_images/ei_data_acquisition.png" style="width: 946.0px; height: 453.5px;" /></a>
<figcaption>
<p><span class="caption-text">Sampling under Data acquisition in Edge Impulse studio</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</li>
<li><p>Observe the received sample data on the raw data graph under the panel.
The observed signal depends on the acceleration readouts.</p>
<figure class="align-default" id="id9">
<a class="reference internal image-reference" href="../../_images/ei_start_sampling.png"><img alt="Sampling example" src="../../_images/ei_start_sampling.png" style="width: 949.5px; height: 483.0px;" /></a>
<figcaption>
<p><span class="caption-text">Sampling example</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</li>
</ol>
</li>
</ol>
</section>
</section>
</section>
<section id="porting-guide">
<h2><a class="toc-backref" href="#id31">Porting guide</a><a class="headerlink" href="#porting-guide" title="Permalink to this heading"></a></h2>
<p>You can port the nRF Machine Learning application to any board available in the nRF Connect SDK or Zephyr.
To do so, create the board-specific directory in <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/configuration/</span></code> and add the application configuration files there.
See the <a class="reference internal" href="#nrf-machine-learning-app-configuration"><span class="std std-ref">Configuration</span></a> for detailed information about the nRF Machine Learning application configuration.</p>
</section>
<section id="application-internal-modules">
<span id="nrf-machine-learning-app-internal-modules"></span><h2><a class="toc-backref" href="#id32">Application internal modules</a><a class="headerlink" href="#application-internal-modules" title="Permalink to this heading"></a></h2>
<p>The nRF Machine Learning application uses modules available in <a class="reference internal" href="../../libraries/caf/index.html#lib-caf"><span class="std std-ref">Common Application Framework</span></a> (CAF), a set of generic modules based on Application Event Manager and available to all applications and a set of dedicated internal modules.
See <a class="reference internal" href="#firmware-architecture">Firmware architecture</a> for more information.</p>
<p>The nRF Machine Learning application uses the following modules available in CAF:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../libraries/caf/ble_adv.html#caf-ble-adv"><span class="std std-ref">CAF: Bluetooth LE advertising module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/ble_bond.html#caf-ble-bond"><span class="std std-ref">CAF: Bluetooth LE bond module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/ble_smp.html#caf-ble-smp"><span class="std std-ref">CAF: Simple Management Protocol module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/ble_state.html#caf-ble-state"><span class="std std-ref">CAF: Bluetooth LE state module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/buttons.html#caf-buttons"><span class="std std-ref">CAF: Buttons module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/click_detector.html#caf-click-detector"><span class="std std-ref">CAF: Click detector module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/leds.html#caf-leds"><span class="std std-ref">CAF: LEDs module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/power_manager.html#caf-power-manager"><span class="std std-ref">CAF: Power manager module</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/sensor_manager.html#caf-sensor-manager"><span class="std std-ref">CAF: Sensor manager module</span></a></p></li>
</ul>
<p>See the module pages for more information about the modules and their configuration.</p>
<p>The nRF Machine Learning application also uses the following dedicated application modules:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ei_data_forwarder_bt_nus</span></code></dt><dd><p>The module forwards the sensor readouts over NUS to the connected Bluetooth Central.
The sensor data is forwarded only if the connection is secured and connection interval is within the limit defined by <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_BT_PERIPHERAL_PREF_MAX_INT</span></code> and <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_BT_PERIPHERAL_PREF_MAX_INT</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ei_data_forwarder_uart</span></code></dt><dd><p>The module forwards the sensor readouts over UART.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">led_state</span></code></dt><dd><p>The module displays the application state using LEDs.
The LED effects used to display the state of data forwarding, the machine learning results, and the state of the simulated signal are defined in <code class="file docutils literal notranslate"><span class="pre">led_state_def.h</span></code> file located in the application configuration directory.
The common LED effects are used to represent the machine learning results and the simulated sensor signal.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ml_runner</span></code></dt><dd><p>The module uses <a class="reference internal" href="../../libraries/others/ei_wrapper.html#ei-wrapper"><span class="std std-ref">Edge Impulse wrapper</span></a> API to control running the machine learning model.
It provides the prediction results using <a class="reference internal" href="#c.ml_result_event" title="ml_result_event"><code class="xref c c-struct docutils literal notranslate"><span class="pre">ml_result_event</span></code></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ml_app_mode</span></code></dt><dd><p>The module controls Application mode. It switches between running the machine learning model and forwarding the data.
The change is triggered by a long press of the button defined in the module’s configuration.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">sensor_sim_ctrl</span></code></dt><dd><p>The module controls parameters of the generated simulated sensor signal.
It switches between predefined sets of parameters for the simulated signal.
The parameters of the generated signals are defined by the <code class="file docutils literal notranslate"><span class="pre">sensor_sim_ctrl_def.h</span></code> file located in the application configuration directory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">usb_state</span></code></dt><dd><p>The module enables USB.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ei_data_forwarder_bt_nus</span></code> and <code class="docutils literal notranslate"><span class="pre">ei_data_forwarder_uart</span></code> modules stop forwarding the sensor readouts if they receive a <a class="reference internal" href="../../libraries/caf/caf_overview.html#c.sensor_event" title="sensor_event"><code class="xref c c-struct docutils literal notranslate"><span class="pre">sensor_event</span></code></a> that cannot be forwarded and needs to be dropped.
This could happen, for example, if the selected sensor sampling frequency is too high for the used implementation of the Edge Impulse data forwarder.
Data forwarding is stopped to make sure that dropping samples is noticed by the user.
If you switch to running the machine learning model and then switch back to data forwarding, the data will be again forwarded to the host.</p>
</div>
</section>
<section id="dependencies">
<h2><a class="toc-backref" href="#id33">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this heading"></a></h2>
<p>The application uses the following Zephyr drivers and libraries:</p>
<ul class="simple">
<li><p><span class="xref std std-ref">zephyr:sensor_api</span></p></li>
<li><p><span class="xref std std-ref">zephyr:uart_api</span></p></li>
<li><p><span class="xref std std-ref">zephyr:mcu_mgr</span></p></li>
</ul>
<p>The application uses the following nRF Connect SDK libraries and drivers:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../libraries/others/app_event_manager.html#app-event-manager"><span class="std std-ref">Application Event Manager</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/caf/index.html#lib-caf"><span class="std std-ref">Common Application Framework</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/others/ei_wrapper.html#ei-wrapper"><span class="std std-ref">Edge Impulse wrapper</span></a></p></li>
<li><p><a class="reference internal" href="../../libraries/bluetooth_services/services/nus.html#nus-service-readme"><span class="std std-ref">Nordic UART Service (NUS)</span></a></p></li>
</ul>
<p>The sample also uses the following secure firmware component:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../app_dev/tfm/index.html#ug-tfm"><span class="std std-ref">Trusted Firmware-M</span></a></p></li>
</ul>
<p>In addition, you can use the <a class="reference internal" href="../../samples/bluetooth/central_uart/README.html#central-uart"><span class="std std-ref">Bluetooth: Central UART</span></a> sample together with the application.
The sample is used to receive data over NUS and forward it to the host over UART.</p>
</section>
<section id="api-documentation">
<h2><a class="toc-backref" href="#id34">API documentation</a><a class="headerlink" href="#api-documentation" title="Permalink to this heading"></a></h2>
<p>Following are the API elements used by the application.</p>
<section id="edge-impulse-data-forwarder-event">
<h3><a class="toc-backref" href="#id35">Edge Impulse Data Forwarder Event</a><a class="headerlink" href="#edge-impulse-data-forwarder-event" title="Permalink to this heading"></a></h3>
<div class="line-block">
<div class="line">Header file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/ei_data_forwarder_event.h</span></code></div>
<div class="line">Source file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/ei_data_forwarder_event.c</span></code></div>
</div>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__ei__data__forwarder__event"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">ei_data_forwarder_event</span></span></dt>
<dd><p>Edge Impulse Data Forwarder Event. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="c enum">
<dt class="sig sig-object c" id="c.ei_data_forwarder_state">
<span class="target" id="group__ei__data__forwarder__event_1gad2753de99db4c77e1f02f0f60f48c274"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ei_data_forwarder_state</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_state" title="Permalink to this definition"></a><br /></dt>
<dd><p>Edge Impulse data forwarder states. </p>
<p><em>Values:</em></p>
<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_DISABLED">
<span class="target" id="group__ei__data__forwarder__event_1ggad2753de99db4c77e1f02f0f60f48c274a28a5bc3dfd396241a59370cab3a8ab3e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EI_DATA_FORWARDER_STATE_DISABLED</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_DISABLED" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_DISCONNECTED">
<span class="target" id="group__ei__data__forwarder__event_1ggad2753de99db4c77e1f02f0f60f48c274a0c84fa8e12ce7306f2d67fc6f249c734"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EI_DATA_FORWARDER_STATE_DISCONNECTED</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_DISCONNECTED" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_CONNECTED">
<span class="target" id="group__ei__data__forwarder__event_1ggad2753de99db4c77e1f02f0f60f48c274af719f8b13dfb1401cb9fdd7f59495dde"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EI_DATA_FORWARDER_STATE_CONNECTED</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_CONNECTED" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_TRANSMITTING">
<span class="target" id="group__ei__data__forwarder__event_1ggad2753de99db4c77e1f02f0f60f48c274a44ca1f6efb8eb8c09688b5228f8e8b55"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EI_DATA_FORWARDER_STATE_TRANSMITTING</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_TRANSMITTING" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_COUNT">
<span class="target" id="group__ei__data__forwarder__event_1ggad2753de99db4c77e1f02f0f60f48c274acd7b3f67177e2e81d7fef4643a0623b8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EI_DATA_FORWARDER_STATE_COUNT</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_state.EI_DATA_FORWARDER_STATE_COUNT" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.ei_data_forwarder_event">
<span class="target" id="structei__data__forwarder__event"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ei_data_forwarder_event</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_event" title="Permalink to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;ei_data_forwarder_event.h&gt;</em></div>
<p>Edge Impulse data forwarder event. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.ei_data_forwarder_event.header">
<span class="target" id="structei__data__forwarder__event_1af80f0a34d61f6e0a689bea8ef81eba13"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">app_event_header</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">header</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_event.header" title="Permalink to this definition"></a><br /></dt>
<dd><p>Event header. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.ei_data_forwarder_event.state">
<span class="target" id="structei__data__forwarder__event_1aa44388b552bce740d5d312fe3d0eaa55"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><a class="reference internal" href="#c.ei_data_forwarder_state" title="ei_data_forwarder_state"><span class="n"><span class="pre">ei_data_forwarder_state</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">state</span></span></span><a class="headerlink" href="#c.ei_data_forwarder_event.state" title="Permalink to this definition"></a><br /></dt>
<dd><p>Edge Impulse data forwarder state. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="machine-learning-application-mode-event">
<h3><a class="toc-backref" href="#id36">Machine Learning Application Mode Event</a><a class="headerlink" href="#machine-learning-application-mode-event" title="Permalink to this heading"></a></h3>
<div class="line-block">
<div class="line">Header file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/ml_app_mode_event.h</span></code></div>
<div class="line">Source file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/ml_app_mode_event.c</span></code></div>
</div>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__ml__app__mode__event"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">ml_app_mode_event</span></span></dt>
<dd><p>Machine Learning Application Mode Event. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="c enum">
<dt class="sig sig-object c" id="c.ml_app_mode">
<span class="target" id="group__ml__app__mode__event_1ga71bae7830ebaf8593464962cfcd98629"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ml_app_mode</span></span></span><a class="headerlink" href="#c.ml_app_mode" title="Permalink to this definition"></a><br /></dt>
<dd><p>Machine learning application modes. </p>
<p><em>Values:</em></p>
<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ml_app_mode.ML_APP_MODE_MODEL_RUNNING">
<span class="target" id="group__ml__app__mode__event_1gga71bae7830ebaf8593464962cfcd98629ac529fad0381ccb5bceb9a6b66d27a6d2"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ML_APP_MODE_MODEL_RUNNING</span></span></span><a class="headerlink" href="#c.ml_app_mode.ML_APP_MODE_MODEL_RUNNING" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ml_app_mode.ML_APP_MODE_DATA_FORWARDING">
<span class="target" id="group__ml__app__mode__event_1gga71bae7830ebaf8593464962cfcd98629a4f6abdb8834dd5e7748910fc53166141"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ML_APP_MODE_DATA_FORWARDING</span></span></span><a class="headerlink" href="#c.ml_app_mode.ML_APP_MODE_DATA_FORWARDING" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.ml_app_mode.ML_APP_MODE_COUNT">
<span class="target" id="group__ml__app__mode__event_1gga71bae7830ebaf8593464962cfcd98629aae2dc3ab4a798d9999714ae5ba083e15"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ML_APP_MODE_COUNT</span></span></span><a class="headerlink" href="#c.ml_app_mode.ML_APP_MODE_COUNT" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.ml_app_mode_event">
<span class="target" id="structml__app__mode__event"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ml_app_mode_event</span></span></span><a class="headerlink" href="#c.ml_app_mode_event" title="Permalink to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;ml_app_mode_event.h&gt;</em></div>
<p>Machine learning application mode event. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.ml_app_mode_event.header">
<span class="target" id="structml__app__mode__event_1abc2d11e254ac2c9399b6da851024738e"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">app_event_header</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">header</span></span></span><a class="headerlink" href="#c.ml_app_mode_event.header" title="Permalink to this definition"></a><br /></dt>
<dd><p>Event header. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.ml_app_mode_event.mode">
<span class="target" id="structml__app__mode__event_1a62eff7f1e808a522e57ac58e13320909"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><a class="reference internal" href="#c.ml_app_mode" title="ml_app_mode"><span class="n"><span class="pre">ml_app_mode</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mode</span></span></span><a class="headerlink" href="#c.ml_app_mode_event.mode" title="Permalink to this definition"></a><br /></dt>
<dd><p>Machine learning application mode. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="machine-learning-result-event">
<h3><a class="toc-backref" href="#id37">Machine Learning Result Event</a><a class="headerlink" href="#machine-learning-result-event" title="Permalink to this heading"></a></h3>
<div class="line-block">
<div class="line">Header file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/ml_result_event.h</span></code></div>
<div class="line">Source file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/ml_result_event.c</span></code></div>
</div>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__ml__result__event"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">ml_result_event</span></span></dt>
<dd><p>Machine Learning Result Event. </p>
<dl class="c struct">
<dt class="sig sig-object c" id="c.ml_result_event">
<span class="target" id="structml__result__event"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ml_result_event</span></span></span><a class="headerlink" href="#c.ml_result_event" title="Permalink to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;ml_result_event.h&gt;</em></div>
<p>Machine learning classification result event. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.ml_result_event.header">
<span class="target" id="structml__result__event_1a5078ab570d29ccc0e64c1411158c97dd"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">app_event_header</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">header</span></span></span><a class="headerlink" href="#c.ml_result_event.header" title="Permalink to this definition"></a><br /></dt>
<dd><p>Event header. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.ml_result_event.label">
<span class="target" id="structml__result__event_1a0c6de0765a978e1730a261402a88c064"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">label</span></span></span><a class="headerlink" href="#c.ml_result_event.label" title="Permalink to this definition"></a><br /></dt>
<dd><p>Classification label. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.ml_result_event.value">
<span class="target" id="structml__result__event_1ac451a76c4c5fb655443bd2d03da4dcad"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value</span></span></span><a class="headerlink" href="#c.ml_result_event.value" title="Permalink to this definition"></a><br /></dt>
<dd><p>Classification value. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.ml_result_event.anomaly">
<span class="target" id="structml__result__event_1ad80b2a112a7ae9dc0e3e4e56ad20313a"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">anomaly</span></span></span><a class="headerlink" href="#c.ml_result_event.anomaly" title="Permalink to this definition"></a><br /></dt>
<dd><p>Anomaly value. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="sensor-simulator-event">
<h3><a class="toc-backref" href="#id38">Sensor Simulator Event</a><a class="headerlink" href="#sensor-simulator-event" title="Permalink to this heading"></a></h3>
<div class="line-block">
<div class="line">Header file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/sensor_sim_event.h</span></code></div>
<div class="line">Source file: <code class="file docutils literal notranslate"><span class="pre">applications/machine_learning/src/events/sensor_sim_event.c</span></code></div>
</div>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__sensor__sim__event"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">sensor_sim_event</span></span></dt>
<dd><p>Simulated Sensor Event. </p>
<dl class="c struct">
<dt class="sig sig-object c" id="c.sensor_sim_event">
<span class="target" id="structsensor__sim__event"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sensor_sim_event</span></span></span><a class="headerlink" href="#c.sensor_sim_event" title="Permalink to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;sensor_sim_event.h&gt;</em></div>
<p>Simulated sensor event. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.sensor_sim_event.header">
<span class="target" id="structsensor__sim__event_1ab76dd095377259398be2cc4c9799a6a7"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">app_event_header</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">header</span></span></span><a class="headerlink" href="#c.sensor_sim_event.header" title="Permalink to this definition"></a><br /></dt>
<dd><p>Event header. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.sensor_sim_event.label">
<span class="target" id="structsensor__sim__event_1a7e6225c23ac068daade4d461fc2926ce"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">label</span></span></span><a class="headerlink" href="#c.sensor_sim_event.label" title="Permalink to this definition"></a><br /></dt>
<dd><p>Label of generated signal. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../matter_weather_station/README.html" class="btn btn-neutral float-right" title="Thingy:53: Matter weather station" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../nrf5340_audio/README.html" class="btn btn-neutral" title="nRF5340 Audio" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>