<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CAF: Buttons module &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../_static/js/ncs.js"
></script>
<script src="../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CAF: Power manager keep alive module for buttons" href="buttons_pm_keep_alive.html" />
    <link rel="prev" title="CAF: Bluetooth state power manager module" href="ble_state_pm.html" />
<link
  href="../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../protocols.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples.html">Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers.html">Drivers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bin/index.html">Binary libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth_services/index.html">Bluetooth libraries and services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bootloader/index.html">Bootloader libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Common Application Framework</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="caf_overview.html">Common Application Framework overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_adv.html">CAF: Bluetooth LE advertising module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_bond.html">CAF: Bluetooth LE bond module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_smp.html">CAF: Simple Management Protocol module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_state.html">CAF: Bluetooth LE state module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_state_pm.html">CAF: Bluetooth state power manager module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">CAF: Buttons module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation-details">Implementation details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="buttons_pm_keep_alive.html">CAF: Power manager keep alive module for buttons</a></li>
<li class="toctree-l3"><a class="reference internal" href="click_detector.html">CAF: Click detector module</a></li>
<li class="toctree-l3"><a class="reference internal" href="leds.html">CAF: LEDs module</a></li>
<li class="toctree-l3"><a class="reference internal" href="net_state.html">CAF: Network state module</a></li>
<li class="toctree-l3"><a class="reference internal" href="power_manager.html">CAF: Power manager module</a></li>
<li class="toctree-l3"><a class="reference internal" href="sensor_data_aggregator.html">CAF: Sensor data aggregator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="sensor_manager.html">CAF: Sensor manager module</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings_loader.html">CAF: Settings loader module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../debug/index.html">Debug libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dfu/index.html">DFU libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gazell/index.html">Gazell libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modem/index.html">Modem libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpsl/index.html">Multiprotocol Service Layer libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Libraries for networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nfc/index.html">Libraries for NFC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nrf_rpc/index.html">nRF RPC libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../others/index.html">Other libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Shell libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tfm/index.html">TF-M libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zigbee/index.html">Libraries for Zigbee</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Libraries</a></li>
          <li class="breadcrumb-item"><a href="index.html">Common Application Framework</a></li>
      <li class="breadcrumb-item active">CAF: Buttons module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/libraries/caf/buttons.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="caf-buttons-module">
<span id="caf-buttons"></span><h1>CAF: Buttons module<a class="headerlink" href="#caf-buttons-module" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#configuration" id="id7">Configuration</a></p></li>
<li><p><a class="reference internal" href="#implementation-details" id="id8">Implementation details</a></p>
<ul>
<li><p><a class="reference internal" href="#key-id" id="id9">Key ID</a></p></li>
<li><p><a class="reference internal" href="#power-management-states" id="id10">Power management states</a></p></li>
</ul>
</li>
</ul>
</div>
<p>The buttons module of the <a class="reference internal" href="index.html#lib-caf"><span class="std std-ref">Common Application Framework</span></a> (CAF) is responsible for generating events related to key presses.
The source of events are changes to GPIO pins.
The module can handle both matrix keyboard and buttons directly connected to GPIO pins.</p>
<section id="configuration">
<h2><a class="toc-backref" href="#id7">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>To use the module, you must enable the following Kconfig options:</p>
<ul class="simple">
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS</span></code> - This option enables the buttons module.</p></li>
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_GPIO</span></code> - This option enables Zephyr’s <span class="xref std std-ref">zephyr:gpio_api</span> driver, which is required for interacting with the GPIO pins.</p></li>
</ul>
<p>When defining how buttons are connected, you must create a configuration file with the following arrays:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">row</span></code> contains pins associated with matrix rows.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">col</span></code> contains pins associated with columns, it can be left empty (buttons will be assumed to be directly connected to row pins, one button per pin).</p></li>
</ul>
<p>For example, the file contents should look like follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;caf/gpio_pins.h&gt;</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">gpio_pin</span><span class="w"> </span><span class="n">col</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">pin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">31</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">pin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">gpio_pin</span><span class="w"> </span><span class="n">row</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">pin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w">  </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">pin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w">  </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">pin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">pin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="p">},</span>
<span class="p">};</span>
</pre></div>
</div>
<p>You must define both arrays in this configuration file, and specify its location with the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_DEF_PATH</span></code> Kconfig option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The configuration file should be included only by the configured module.
Do not include the configuration file in other source files.</p>
</div>
<p>The following Kconfig options are available for this module:</p>
<ul class="simple">
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_DEF_PATH</span></code></p></li>
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_PM_EVENTS</span></code></p></li>
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_SCAN_INTERVAL</span></code></p></li>
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_DEBOUNCE_INTERVAL</span></code></p></li>
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_POLARITY_INVERSED</span></code></p></li>
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_EVENT_LIMIT</span></code></p></li>
</ul>
<p>By default, a button press is indicated by a pin switch from the low to the high state.
You can change this with <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_POLARITY_INVERSED</span></code>, which will cause the application to react to an opposite pin change (from the high to the low state).</p>
</section>
<section id="implementation-details">
<h2><a class="toc-backref" href="#id8">Implementation details</a><a class="headerlink" href="#implementation-details" title="Permalink to this heading"></a></h2>
<p>Depending on the configuration, the module can use from two to four states.</p>
<figure class="align-default" id="id6">
<img alt="State transitions of the buttons module" src="../../_images/caf_buttons_states.svg" /><figcaption>
<p><span class="caption-text">State transitions of the buttons module</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>By default, the module uses the following states:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">STATE_SCANNING</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">STATE_ACTIVE</span></code></p></li>
</ul>
<p>After initialization, the module starts in <code class="docutils literal notranslate"><span class="pre">STATE_SCANNING</span></code> and performs initial scan of configured pins.
If no buttons are pressed the module switches to <code class="docutils literal notranslate"><span class="pre">STATE_ACTIVE</span></code>.
In this state, the module enables the GPIO interrupts and waits for the pin state to change.</p>
<p>Whenever a button is pressed, the module switches to <code class="docutils literal notranslate"><span class="pre">STATE_SCANNING</span></code>.
When the switch occurs, the module submits a work with a delay set to <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_DEBOUNCE_INTERVAL</span></code>.
The work scans the keyboard matrix, or directly connected buttons (depends on configuration).
If any button state change occurs, the module sends an event with the <a class="reference internal" href="caf_overview.html#c.button_event.key_id" title="button_event.key_id"><code class="xref c c-member docutils literal notranslate"><span class="pre">button_event.key_id</span></code></a> of that button.</p>
<ul class="simple">
<li><p>If the button is kept pressed while the scanning is performed, the work will be resubmitted with a delay set to <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_SCAN_INTERVAL</span></code>.</p></li>
<li><p>If no button is pressed, the module switches back to <code class="docutils literal notranslate"><span class="pre">STATE_ACTIVE</span></code>.</p></li>
</ul>
<section id="key-id">
<h3><a class="toc-backref" href="#id9">Key ID</a><a class="headerlink" href="#key-id" title="Permalink to this heading"></a></h3>
<p>The <a class="reference internal" href="caf_overview.html#c.button_event.key_id" title="button_event.key_id"><code class="xref c c-member docutils literal notranslate"><span class="pre">button_event.key_id</span></code></a> is an unique 2-byte value that depends on the module configuration described in the configuration file.</p>
<p>The following table breaks down the <a class="reference internal" href="caf_overview.html#c.button_event.key_id" title="button_event.key_id"><code class="xref c c-member docutils literal notranslate"><span class="pre">button_event.key_id</span></code></a> bits.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 15%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>key_id</p></th>
</tr>
<tr class="row-even"><th class="head"><p>0 .. 6</p></th>
<th class="head"><p>7 .. 13</p></th>
<th class="head"><p>14</p></th>
<th class="head"><p>15</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Row idx</p></td>
<td><p>Col idx</p></td>
<td colspan="2"><p>Reserved</p></td>
</tr>
</tbody>
</table>
<p>In this <a class="reference internal" href="caf_overview.html#c.button_event.key_id" title="button_event.key_id"><code class="xref c c-member docutils literal notranslate"><span class="pre">button_event.key_id</span></code></a> value:</p>
<ul class="simple">
<li><p>The first seven least significant bits (<code class="docutils literal notranslate"><span class="pre">Row</span> <span class="pre">idx</span></code>) encode the index of the <code class="docutils literal notranslate"><span class="pre">row</span></code> array that corresponds to the GPIO port and the pin to which the button’s row is connected.</p></li>
<li><p>The next seven bits (<code class="docutils literal notranslate"><span class="pre">Col</span> <span class="pre">idx</span></code>) encode the index of the <code class="docutils literal notranslate"><span class="pre">col</span></code> array that corresponds to the GPIO port and the pin to which the button’s column is connected.
If the buttons are directly connected they are denoted only by <code class="docutils literal notranslate"><span class="pre">row</span></code> array index, <code class="docutils literal notranslate"><span class="pre">col</span></code> array index bits are set to zero.</p></li>
<li><p>The last two bits are reserved for application-specific usage.</p></li>
</ul>
<p>For example, if the configuration file looks as described in the <a class="reference internal" href="#configuration">Configuration</a> section of this documentation, an event <a class="reference internal" href="caf_overview.html#c.button_event" title="button_event"><code class="xref c c-struct docutils literal notranslate"><span class="pre">button_event</span></code></a> with the <a class="reference internal" href="caf_overview.html#c.button_event.key_id" title="button_event.key_id"><code class="xref c c-member docutils literal notranslate"><span class="pre">button_event.key_id</span></code></a> value equal to <code class="docutils literal notranslate"><span class="pre">0x0083</span></code> indicates the following information:</p>
<ul class="simple">
<li><p>The button row pin is connected to the GPIO that is at index 3 in the <code class="docutils literal notranslate"><span class="pre">row</span></code> array from the configuration file.
That is, the row port and pin are <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">14</span></code>, respectively.</p></li>
<li><p>The button column pin is connected to the GPIO that is at index 1 in the <code class="docutils literal notranslate"><span class="pre">col</span></code> array from the configuration file.
That is, the column port and pin are <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">24</span></code>, respectively.</p></li>
</ul>
</section>
<section id="power-management-states">
<h3><a class="toc-backref" href="#id10">Power management states</a><a class="headerlink" href="#power-management-states" title="Permalink to this heading"></a></h3>
<p>If the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_CAF_BUTTONS_PM_EVENTS</span></code> Kconfig option is enabled, the module can react to power management events and submit <code class="docutils literal notranslate"><span class="pre">wake_up_event</span></code>.
In that case, the following additional states are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">STATE_SUSPENDING</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">STATE_IDLE</span></code></p></li>
</ul>
<p>The power management events that module can react to are the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">power_down_event</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wake_up_event</span></code></p></li>
</ul>
<p>If a <code class="docutils literal notranslate"><span class="pre">power_down_event</span></code> comes while the module is in the <code class="docutils literal notranslate"><span class="pre">STATE_SCANNING</span></code> state, the module switches to <code class="docutils literal notranslate"><span class="pre">STATE_SUSPENDING</span></code> and remains in this state until no button is pressed.
Then, it switches to <code class="docutils literal notranslate"><span class="pre">STATE_IDLE</span></code>.</p>
<p>If a <code class="docutils literal notranslate"><span class="pre">power_down_event</span></code> comes while the module is in the <code class="docutils literal notranslate"><span class="pre">STATE_ACTIVE</span></code> state, the module switches to <code class="docutils literal notranslate"><span class="pre">STATE_IDLE</span></code> immediately.
Similarly, as in <code class="docutils literal notranslate"><span class="pre">STATE_ACTIVE</span></code>, in <code class="docutils literal notranslate"><span class="pre">STATE_IDLE</span></code> the module enables the GPIO interrupts and waits for the pin state to change.
However, in <code class="docutils literal notranslate"><span class="pre">STATE_IDLE</span></code> the module can also invoke <code class="docutils literal notranslate"><span class="pre">wake_up_event</span></code> and send it to all subscribing modules.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="buttons_pm_keep_alive.html" class="btn btn-neutral float-right" title="CAF: Power manager keep alive module for buttons" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ble_state_pm.html" class="btn btn-neutral" title="CAF: Bluetooth state power manager module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>