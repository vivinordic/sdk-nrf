<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Event Manager Proxy &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../_static/js/ncs.js"
></script>
<script src="../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Fatal error handler" href="fatal_error.html" />
    <link rel="prev" title="Enhanced ShockBurst" href="esb.html" />
<link
  href="../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../protocols.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples.html">Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers.html">Drivers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bin/index.html">Binary libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth_services/index.html">Bluetooth libraries and services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bootloader/index.html">Bootloader libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caf/index.html">Common Application Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debug/index.html">Debug libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dfu/index.html">DFU libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gazell/index.html">Gazell libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modem/index.html">Modem libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpsl/index.html">Multiprotocol Service Layer libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Libraries for networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nfc/index.html">Libraries for NFC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nrf_rpc/index.html">nRF RPC libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Other libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="adp536x.html">adp536x</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_event_manager.html">Application Event Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_event_manager_profiler_tracer.html">Application Event Manager profiler tracer</a></li>
<li class="toctree-l3"><a class="reference internal" href="contin_array.html">Continuous array</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_fifo.html">Data FIFO</a></li>
<li class="toctree-l3"><a class="reference internal" href="date_time.html">Date-Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="dk_buttons_and_leds.html">DK Buttons and LEDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="dm.html">Distance Measurement</a></li>
<li class="toctree-l3"><a class="reference internal" href="ei_wrapper.html">Edge Impulse wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="emds.html">Emergency data storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="esb.html">Enhanced ShockBurst</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Event Manager Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation-details">Implementation details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limitations">Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-documentation">API documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fatal_error.html">Fatal error handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="flash_map_pm.html">Partition Manager flash map</a></li>
<li class="toctree-l3"><a class="reference internal" href="flash_patch.html">Flash patch</a></li>
<li class="toctree-l3"><a class="reference internal" href="fprotect.html">Hardware flash write protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="fw_info.html">Firmware information</a></li>
<li class="toctree-l3"><a class="reference internal" href="hw_id.html">Hardware ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="hw_unique_key.html">Hardware unique key</a></li>
<li class="toctree-l3"><a class="reference internal" href="identity_key.html">Identity key</a></li>
<li class="toctree-l3"><a class="reference internal" href="memfault_ncs.html">Memfault</a></li>
<li class="toctree-l3"><a class="reference internal" href="nrf_profiler.html">nRF Profiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcm_mix.html">Pulse Code Modulation audio mixer</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcm_stream_channel_modifier.html">PCM Stream Channel Modifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="qos.html">Quality of Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="ram_pwrdn.html">RAM power-down</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfloat.html">Short float (SFLOAT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="st25r3911b_nfc.html">NFC Reader ST25R3911B</a></li>
<li class="toctree-l3"><a class="reference internal" href="supl_os_client.html">SUPL client and SUPL client OS integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="tone.html">Tone generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="wave_gen.html">Wave generator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Shell libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tfm/index.html">TF-M libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zigbee/index.html">Libraries for Zigbee</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Libraries</a></li>
          <li class="breadcrumb-item"><a href="index.html">Other libraries</a></li>
      <li class="breadcrumb-item active">Event Manager Proxy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/libraries/others/event_manager_proxy.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="event-manager-proxy">
<span id="id1"></span><h1>Event Manager Proxy<a class="headerlink" href="#event-manager-proxy" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#configuration" id="id8">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#additional-configuration" id="id9">Additional configuration</a></p></li>
<li><p><a class="reference internal" href="#implementing-the-proxy" id="id10">Implementing the proxy</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#implementation-details" id="id11">Implementation details</a></p>
<ul>
<li><p><a class="reference internal" href="#initialization-hook-usage" id="id12">Initialization hook usage</a></p></li>
<li><p><a class="reference internal" href="#tracing-hook-usage" id="id13">Tracing hook usage</a></p></li>
<li><p><a class="reference internal" href="#subscribing-to-remote-events" id="id14">Subscribing to remote events</a></p></li>
<li><p><a class="reference internal" href="#sending-the-event-to-the-remote-core" id="id15">Sending the event to the remote core</a></p></li>
<li><p><a class="reference internal" href="#passing-the-event-from-the-remote-core" id="id16">Passing the event from the remote core</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#limitations" id="id17">Limitations</a></p></li>
<li><p><a class="reference internal" href="#api-documentation" id="id18">API documentation</a></p></li>
</ul>
</div>
<p>The Event Manager Proxy is a library that allows to exchange Event Manager events between cores.
It connects two separate instances of Event Manager on different cores by passing registered messages using the IPC service.</p>
<p>See the <a class="reference internal" href="../../samples/event_manager_proxy/README.html#event-manager-proxy-sample"><span class="std std-ref">Event Manager Proxy</span></a> sample for an example of how to use this library.</p>
<section id="configuration">
<h2><a class="toc-backref" href="#id8">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>To use the Event Manager Proxy, enable the <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_EVENT_MANAGER_PROXY</span></code> Kconfig option.
This option depends on <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_IPC_SERVICE</span></code> Kconfig option.
Make sure that the IPC Service is configured together with the used backend.</p>
<p>When Event Manager Proxy is enabled, the required hooks in <a class="reference internal" href="app_event_manager.html#app-event-manager"><span class="std std-ref">Application Event Manager</span></a> are also enabled.</p>
<section id="additional-configuration">
<h3><a class="toc-backref" href="#id9">Additional configuration</a><a class="headerlink" href="#additional-configuration" title="Permalink to this heading"></a></h3>
<p>You can also set the following Kconfig options when working with Event Manager Proxy:</p>
<ul class="simple">
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_EVENT_MANAGER_PROXY_CH_COUNT</span></code> - This Kconfig sets the number of IPC instances that would be used.
This option is related to the number of cores between which the events are exchanged.
For example, having two cores means that there is one exchange taking place, and so you need one IPC instance.</p></li>
<li><p><code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_EVENT_MANAGER_PROXY_BOND_TIMEOUT_MS</span></code> - This Kconfig sets the timeout value of the bonding.</p></li>
</ul>
</section>
<section id="implementing-the-proxy">
<h3><a class="toc-backref" href="#id10">Implementing the proxy</a><a class="headerlink" href="#implementing-the-proxy" title="Permalink to this heading"></a></h3>
<p>When compiling the code that uses Event Manager Proxy, make sure that the event definitions shared between the cores are compiled for both cores.
The declarations should be accessible during code compilation of both cores.</p>
<p>The application that wishes to use Event Manager Proxy requires a special initialization process.
To implement an Event Manager Proxy, you must complete the following steps:</p>
<ol class="arabic">
<li><p>Initialize Event Manager Proxy together with the <a class="reference internal" href="app_event_manager.html#app-event-manager"><span class="std std-ref">Application Event Manager</span></a>.
The code should look as follows:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Initialize Event Manager and Event Manager Proxy */</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event_manager_init</span><span class="p">();</span>
<span class="cm">/* Error handling */</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Add all remote IPC instances.
The code should look as follows:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event_manager_proxy_add_remote</span><span class="p">(</span><span class="n">ipc1_instance</span><span class="p">);</span>
<span class="cm">/* Error handling */</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event_manager_proxy_add_remote</span><span class="p">(</span><span class="n">ipc2_instance</span><span class="p">);</span>
<span class="cm">/* Error handling */</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Use <a class="reference internal" href="#c.event_manager_proxy_subscribe" title="event_manager_proxy_subscribe"><code class="xref c c-func docutils literal notranslate"><span class="pre">event_manager_proxy_subscribe()</span></code></a> function by passing all the required arguments for the submitter to pass the selected event.
The auxiliary macro <a class="reference internal" href="#c.EVENT_MANAGER_PROXY_SUBSCRIBE" title="EVENT_MANAGER_PROXY_SUBSCRIBE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">EVENT_MANAGER_PROXY_SUBSCRIBE</span></code></a> prepares all the argument identifiers using the event definition.
The code should look as follows:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;event1_definition_file.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;event2_definition_file.h&gt;</span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVENT_MANAGER_PROXY_SUBSCRIBE</span><span class="p">(</span><span class="n">ipc1_instance</span><span class="p">,</span><span class="w"> </span><span class="n">event1</span><span class="p">);</span>
<span class="cm">/* Error handling */</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVENT_MANAGER_PROXY_SUBSCRIBE</span><span class="p">(</span><span class="n">ipc2_instance</span><span class="p">,</span><span class="w"> </span><span class="n">event2</span><span class="p">);</span>
<span class="cm">/* Error handling */</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Configure the Event Manager Proxy into an active state when all the events are subscribed.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event_manager_proxy_start</span><span class="p">();</span>
<span class="cm">/* Error handling */</span>
</pre></div>
</div>
</div></blockquote>
<p>Now no more configuration messages should be passed between cores.
Only subscribed events are transmitted.</p>
</li>
<li><p>Use <a class="reference internal" href="#c.event_manager_proxy_start" title="event_manager_proxy_start"><code class="xref c c-func docutils literal notranslate"><span class="pre">event_manager_proxy_start()</span></code></a> function on both the cores to transmit the events between both cores.
If you want to be sure that the link between cores is active before continuing, use the <a class="reference internal" href="#c.event_manager_proxy_wait_for_remotes" title="event_manager_proxy_wait_for_remotes"><code class="xref c c-func docutils literal notranslate"><span class="pre">event_manager_proxy_wait_for_remotes()</span></code></a> function.
This function blocks until all registered instances report their readiness.</p></li>
</ol>
<p>A call to <a class="reference internal" href="#c.event_manager_proxy_wait_for_remotes" title="event_manager_proxy_wait_for_remotes"><code class="xref c c-func docutils literal notranslate"><span class="pre">event_manager_proxy_wait_for_remotes()</span></code></a> is not required.
The function is used if you want to send an event that is to be transmitted to all the registered remotes.</p>
<p>After the link is initialized, the subscribed events from the remote core appear in the local event queue.
The events are then processed like any other local messages.</p>
</section>
</section>
<section id="implementation-details">
<h2><a class="toc-backref" href="#id11">Implementation details</a><a class="headerlink" href="#implementation-details" title="Permalink to this heading"></a></h2>
<p>The proxy uses some of the Event Manager hooks to connect with the manager.</p>
<section id="initialization-hook-usage">
<h3><a class="toc-backref" href="#id12">Initialization hook usage</a><a class="headerlink" href="#initialization-hook-usage" title="Permalink to this heading"></a></h3>
<p>The Application Event Manager provides an initialization hook for any module that relies on the Application Event Manager initialization before the first event is processed.
The hook function should be declared in the <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">hook(void)</span></code> format.
If the hook function returns a non-zero value, the initialization process is interrupted and a related error is returned.</p>
<p>To register the initialization hook, use the macro <a class="reference internal" href="app_event_manager.html#c.APP_EVENT_MANAGER_HOOK_POSTINIT_REGISTER" title="APP_EVENT_MANAGER_HOOK_POSTINIT_REGISTER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_MANAGER_HOOK_POSTINIT_REGISTER</span></code></a>.
For details, refer to <a class="reference internal" href="app_event_manager.html#app-event-manager-api"><span class="std std-ref">API documentation</span></a>.</p>
<p>The Event Manager Proxy uses the hook to append itself to the initialization procedure.</p>
</section>
<section id="tracing-hook-usage">
<h3><a class="toc-backref" href="#id13">Tracing hook usage</a><a class="headerlink" href="#tracing-hook-usage" title="Permalink to this heading"></a></h3>
<p>The Application Event Manager uses flexible mechanism to implement hooks when an event is submitted, before it is processed, and after its processing.
The tracing hooks are originally designed to implement event tracing, but you can use them for other purposes as well.
The registered hook function should be declared in the <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">hook(const</span> <span class="pre">struct</span> <span class="pre">app_event_header</span> <span class="pre">*aeh)</span></code> format.</p>
<p>The following macros are implemented to register event tracing hooks:</p>
<ul class="simple">
<li><p><a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_ON_SUBMIT_REGISTER_FIRST" title="APP_EVENT_HOOK_ON_SUBMIT_REGISTER_FIRST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_ON_SUBMIT_REGISTER_FIRST</span></code></a>, <a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_ON_SUBMIT_REGISTER" title="APP_EVENT_HOOK_ON_SUBMIT_REGISTER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_ON_SUBMIT_REGISTER</span></code></a>, <a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_ON_SUBMIT_REGISTER_LAST" title="APP_EVENT_HOOK_ON_SUBMIT_REGISTER_LAST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_ON_SUBMIT_REGISTER_LAST</span></code></a></p></li>
<li><p><a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_PREPROCESS_REGISTER_FIRST" title="APP_EVENT_HOOK_PREPROCESS_REGISTER_FIRST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_PREPROCESS_REGISTER_FIRST</span></code></a>, <a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_PREPROCESS_REGISTER" title="APP_EVENT_HOOK_PREPROCESS_REGISTER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_PREPROCESS_REGISTER</span></code></a>, <a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_PREPROCESS_REGISTER_LAST" title="APP_EVENT_HOOK_PREPROCESS_REGISTER_LAST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_PREPROCESS_REGISTER_LAST</span></code></a></p></li>
<li><p><a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_POSTPROCESS_REGISTER_FIRST" title="APP_EVENT_HOOK_POSTPROCESS_REGISTER_FIRST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_POSTPROCESS_REGISTER_FIRST</span></code></a>, <a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_POSTPROCESS_REGISTER" title="APP_EVENT_HOOK_POSTPROCESS_REGISTER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_POSTPROCESS_REGISTER</span></code></a>, <a class="reference internal" href="app_event_manager.html#c.APP_EVENT_HOOK_POSTPROCESS_REGISTER_LAST" title="APP_EVENT_HOOK_POSTPROCESS_REGISTER_LAST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">APP_EVENT_HOOK_POSTPROCESS_REGISTER_LAST</span></code></a></p></li>
</ul>
<p>For details, refer to <a class="reference internal" href="app_event_manager.html#app-event-manager-api"><span class="std std-ref">API documentation</span></a>.</p>
<p>The Event Manager Proxy uses only a post-process hook to send the event after processing the local core to the remote core that is registered as a listener.</p>
</section>
<section id="subscribing-to-remote-events">
<h3><a class="toc-backref" href="#id14">Subscribing to remote events</a><a class="headerlink" href="#subscribing-to-remote-events" title="Permalink to this heading"></a></h3>
<p>A core that wishes to listen to events from the remote core sends <code class="docutils literal notranslate"><span class="pre">SUBSCRIBE</span></code> command to that core during the initialization process.
The <code class="docutils literal notranslate"><span class="pre">SUBSCRIBE</span></code> command uses <a class="reference internal" href="#c.event_manager_proxy_subscribe" title="event_manager_proxy_subscribe"><code class="xref c c-func docutils literal notranslate"><span class="pre">event_manager_proxy_subscribe()</span></code></a> function, which passes following arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">local_event_id</span></code> - This argument represents the local core ID that wishes to receive when the event is post-processed on the remote core.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remote_event_name</span></code> - This argument represents the name of the event to be searched for.</p></li>
</ul>
<p>The remote core during the command processing searches for an event with the given name and registers the given event ID in an array of events.
The created array of events directly reflects the array of event types.
This way, the complexity of searching the remote event ID connected to the currently processed event has <code class="docutils literal notranslate"><span class="pre">O(1)</span></code> complexity.
The most time consuming search is realized during initialization, where events are searched by name with <code class="docutils literal notranslate"><span class="pre">O(N)</span></code> complexity.</p>
</section>
<section id="sending-the-event-to-the-remote-core">
<h3><a class="toc-backref" href="#id15">Sending the event to the remote core</a><a class="headerlink" href="#sending-the-event-to-the-remote-core" title="Permalink to this heading"></a></h3>
<p>After the event is processed locally, the event post-process hook in the Event Manager Proxy is executed.
The proxy gets the event index and then checks the matched position in the remote array.
If the event is registered for this event for any of added remote IPC instance, the event is copied as-is.
The event ID is replaced by the ID requested by the remote and is transmitted to the remote in the same form.
This way, the remote can copy the event as-is and use the event as the remote’s local event.</p>
</section>
<section id="passing-the-event-from-the-remote-core">
<h3><a class="toc-backref" href="#id16">Passing the event from the remote core</a><a class="headerlink" href="#passing-the-event-from-the-remote-core" title="Permalink to this heading"></a></h3>
<p>Once the remote and local core started Event Manager Proxy by calling the <a class="reference internal" href="#c.event_manager_proxy_start" title="event_manager_proxy_start"><code class="xref c c-func docutils literal notranslate"><span class="pre">event_manager_proxy_start()</span></code></a> function, every piece of incoming data is treated as a single event.
A new event is allocated by <code class="xref c c-func docutils literal notranslate"><span class="pre">event_manager_alloc()</span></code> function and the event is submitted to the event queue by the <code class="xref c c-func docutils literal notranslate"><span class="pre">_event_submit()</span></code> function.
From that moment, the event is treated similarly as any other locally generated event.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If any of the shared events between the cores provide any kind of memory pointer, the pointed memory must be available for the target core if the core is to access the shared events.</p>
</div>
</section>
</section>
<section id="limitations">
<h2><a class="toc-backref" href="#id17">Limitations</a><a class="headerlink" href="#limitations" title="Permalink to this heading"></a></h2>
<p>The event passed through the Event Manager Proxy is treated and processed the same way as any locally generated event.
The core that sources the event must not subscribe to the same event in another core.
If it does, once the core receives such an event generated remotely, it would resend the event automatically from that local core to the ones that subscribed to it.
We would run into a dangerous situation where two cores subscribe to the same event.
Once generated, such an event would be continuously resent between the cores.
The currently proposed approach is to create special events for each core even if they look the same, they must have different codes.</p>
</section>
<section id="api-documentation">
<span id="event-manager-proxy-api"></span><h2><a class="toc-backref" href="#id18">API documentation</a><a class="headerlink" href="#api-documentation" title="Permalink to this heading"></a></h2>
<div class="line-block">
<div class="line">Header file: <code class="file docutils literal notranslate"><span class="pre">include/event_manager_proxy.h</span></code></div>
<div class="line">Source files: <code class="file docutils literal notranslate"><span class="pre">subsys/event_manager_proxy/</span></code></div>
</div>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__event__manager__proxy"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">event_manager_proxy</span></span></dt>
<dd><p>Event Manager Proxy. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.EVENT_MANAGER_PROXY_SUBSCRIBE">
<span class="target" id="group__event__manager__proxy_1gaca3033f9ddb719309a6703546918a9f0"></span><span class="sig-name descname"><span class="n"><span class="pre">EVENT_MANAGER_PROXY_SUBSCRIBE</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">instance</span></span>, <span class="n"><span class="pre">ename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.EVENT_MANAGER_PROXY_SUBSCRIBE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Subscribe for the remote event. </p>
<p>Register the listener for the event from the remote core. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The instance used for IPC service to transfer data between cores. </p></li>
<li><p><strong>ename</strong> – Name of the event. The event name has to be the same on remote and local cores. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>See <a class="reference internal" href="#group__event__manager__proxy_1gaa0b37caf8ac560a5f84acce34334e5ae"><span class="std std-ref">event_manager_proxy_subscribe</span></a>. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.event_manager_proxy_add_remote">
<span class="target" id="group__event__manager__proxy_1gadbc0285baec71f036cdbffdcedcd5be4"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">event_manager_proxy_add_remote</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">instance</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.event_manager_proxy_add_remote" title="Permalink to this definition"></a><br /></dt>
<dd><p>Add remote core communication channel. </p>
<p>This function registers endpoint used to communication with another core.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The instance used for IPC service to transfer data between cores. </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>-EALREADY</strong> – Given remote instance was added already. </p></li>
<li><p><strong>-ENOMEM</strong> – No place for the new endpoint. See<span> <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_EVENT_MANAGER_PROXY_CH_COUNT</span></code> </span>. </p></li>
<li><p><strong>-EIO</strong> – Comes from IPC service, see ipc_service_open_instance or ipc_service_register_endpoint. </p></li>
<li><p><strong>-EINVAL</strong> – Comes from IPC service, see ipc_service_open_instance or ipc_service_register_endpoint. </p></li>
<li><p><strong>-EBUSY</strong> – Comes from IPC service, see ipc_service_register_endpoint.</p></li>
<li><p><strong>0</strong> – On success. </p></li>
<li><p><strong>other</strong> – errno codes depending on the IPC service backend implementation. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.event_manager_proxy_subscribe">
<span class="target" id="group__event__manager__proxy_1gaa0b37caf8ac560a5f84acce34334e5ae"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">event_manager_proxy_subscribe</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">instance</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">event_type</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">local_event_id</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">remote_event_name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.event_manager_proxy_subscribe" title="Permalink to this definition"></a><br /></dt>
<dd><p>Subscribe for the remote event. </p>
<p>This function registers the local event proxy to remote event proxy to listen selected event.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function may wait for the IPC endpoint to bond. To be sure that it will be available to bond write the code this way that all the remotes are added first by <a class="reference internal" href="#group__event__manager__proxy_1gadbc0285baec71f036cdbffdcedcd5be4"><span class="std std-ref">event_manager_proxy_add_remote</span></a> and then start to add listeners. In other case if the other core adds more than one remote, we run into risk that we will wait for the endpoint to bond while the remote core waits for other endpoint to bond and never configures the requested endpoint.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – Remote IPC instance. </p></li>
<li><p><strong>local_event_id</strong> – The id of the event we wish to receive for the event on the remote core. </p></li>
<li><p><strong>remote_event_name</strong> – The name of the event to register.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – On success. </p></li>
<li><p><strong>-EACCES</strong> – Function called after <a class="reference internal" href="#group__event__manager__proxy_1gad737d9244f8f9df12d1c0a2bf1a89de4"><span class="std std-ref">event_manager_proxy_start</span></a>. </p></li>
<li><p><strong>-EPIPE</strong> – The remote core did not bond in during timeout period. No communication. </p></li>
<li><p><strong>-ETIME</strong> – Timeout while waiting for the response from the other core. </p></li>
<li><p><strong>other</strong> – errno code. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.event_manager_proxy_start">
<span class="target" id="group__event__manager__proxy_1gad737d9244f8f9df12d1c0a2bf1a89de4"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">event_manager_proxy_start</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.event_manager_proxy_start" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start events transfer. </p>
<p>This function sends start command to all added remote cores. This command finalizes initialization process, therefore the functions <a class="reference internal" href="#group__event__manager__proxy_1gadbc0285baec71f036cdbffdcedcd5be4"><span class="std std-ref">event_manager_proxy_add_remote</span></a> and <a class="reference internal" href="#group__event__manager__proxy_1gaa0b37caf8ac560a5f84acce34334e5ae"><span class="std std-ref">event_manager_proxy_subscribe</span></a> cannot be used anymore.</p>
<dl class="field-list simple">
<dt class="field-odd">Return values</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>0</strong> – On success. </p></li>
<li><p><strong>-EPIPE</strong> – The remote core did not bond in during timeout period. No communication. </p></li>
<li><p><strong>other</strong> – errno code. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.event_manager_proxy_wait_for_remotes">
<span class="target" id="group__event__manager__proxy_1gabafb9a3283216697574ce8cbbf6b915c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">event_manager_proxy_wait_for_remotes</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">k_timeout_t</span></span><span class="w"> </span><span class="n"><span class="pre">timeout</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.event_manager_proxy_wait_for_remotes" title="Permalink to this definition"></a><br /></dt>
<dd><p>Wait for all the remote cores to report their readiness. </p>
<p>This function stops the current thread if there is any remote that did not finish its initialization.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Call this function only after <a class="reference internal" href="#group__event__manager__proxy_1gad737d9244f8f9df12d1c0a2bf1a89de4"><span class="std std-ref">event_manager_proxy_start</span></a>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function may be called multiple times.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> – Waiting period for all the remote cores to finish theirs initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – On success. </p></li>
<li><p><strong>-ETIME</strong> – Timeout reached. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fatal_error.html" class="btn btn-neutral float-right" title="Fatal error handler" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="esb.html" class="btn btn-neutral" title="Enhanced ShockBurst" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>