<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SUPL client and SUPL client OS integration &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../_static/js/ncs.js"
></script>
<script src="../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tone generator" href="tone.html" />
    <link rel="prev" title="NFC Reader ST25R3911B" href="st25r3911b_nfc.html" />
<link
  href="../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../protocols.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples.html">Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers.html">Drivers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bin/index.html">Binary libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth_services/index.html">Bluetooth libraries and services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bootloader/index.html">Bootloader libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caf/index.html">Common Application Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debug/index.html">Debug libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dfu/index.html">DFU libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gazell/index.html">Gazell libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modem/index.html">Modem libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpsl/index.html">Multiprotocol Service Layer libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Libraries for networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nfc/index.html">Libraries for NFC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nrf_rpc/index.html">nRF RPC libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Other libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="adp536x.html">adp536x</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_event_manager.html">Application Event Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_event_manager_profiler_tracer.html">Application Event Manager profiler tracer</a></li>
<li class="toctree-l3"><a class="reference internal" href="contin_array.html">Continuous array</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_fifo.html">Data FIFO</a></li>
<li class="toctree-l3"><a class="reference internal" href="date_time.html">Date-Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="dk_buttons_and_leds.html">DK Buttons and LEDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="dm.html">Distance Measurement</a></li>
<li class="toctree-l3"><a class="reference internal" href="ei_wrapper.html">Edge Impulse wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="emds.html">Emergency data storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="esb.html">Enhanced ShockBurst</a></li>
<li class="toctree-l3"><a class="reference internal" href="event_manager_proxy.html">Event Manager Proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fatal_error.html">Fatal error handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="flash_map_pm.html">Partition Manager flash map</a></li>
<li class="toctree-l3"><a class="reference internal" href="flash_patch.html">Flash patch</a></li>
<li class="toctree-l3"><a class="reference internal" href="fprotect.html">Hardware flash write protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="fw_info.html">Firmware information</a></li>
<li class="toctree-l3"><a class="reference internal" href="hw_id.html">Hardware ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="hw_unique_key.html">Hardware unique key</a></li>
<li class="toctree-l3"><a class="reference internal" href="identity_key.html">Identity key</a></li>
<li class="toctree-l3"><a class="reference internal" href="memfault_ncs.html">Memfault</a></li>
<li class="toctree-l3"><a class="reference internal" href="nrf_profiler.html">nRF Profiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcm_mix.html">Pulse Code Modulation audio mixer</a></li>
<li class="toctree-l3"><a class="reference internal" href="pcm_stream_channel_modifier.html">PCM Stream Channel Modifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="qos.html">Quality of Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="ram_pwrdn.html">RAM power-down</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfloat.html">Short float (SFLOAT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="st25r3911b_nfc.html">NFC Reader ST25R3911B</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">SUPL client and SUPL client OS integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#secure-user-plane-location">Secure User-Plane Location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#supl-client-library">SUPL client library</a></li>
<li class="toctree-l4"><a class="reference internal" href="#supl-client-os-integration-library">SUPL client OS integration library</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tone.html">Tone generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="wave_gen.html">Wave generator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Shell libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tfm/index.html">TF-M libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zigbee/index.html">Libraries for Zigbee</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Libraries</a></li>
          <li class="breadcrumb-item"><a href="index.html">Other libraries</a></li>
      <li class="breadcrumb-item active">SUPL client and SUPL client OS integration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/libraries/others/supl_os_client.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="supl-client-and-supl-client-os-integration">
<span id="supl-client"></span><h1>SUPL client and SUPL client OS integration<a class="headerlink" href="#supl-client-and-supl-client-os-integration" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#secure-user-plane-location" id="id8">Secure User-Plane Location</a></p>
<ul>
<li><p><a class="reference internal" href="#supl-payload" id="id9">SUPL payload</a></p></li>
<li><p><a class="reference internal" href="#supl-session-and-transaction-type" id="id10">SUPL session and transaction type</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#supl-client-library" id="id11">SUPL client library</a></p>
<ul>
<li><p><a class="reference internal" href="#downloading-and-installing" id="id12">Downloading and installing</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id13">Configuration</a></p></li>
<li><p><a class="reference internal" href="#resource-initialization-and-ownership" id="id14">Resource initialization and ownership</a></p></li>
<li><p><a class="reference internal" href="#api-callback-functions" id="id15">API callback functions</a></p></li>
<li><p><a class="reference internal" href="#supl-session" id="id16">SUPL session</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#supl-client-os-integration-library" id="id17">SUPL client OS integration library</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id18">SUPL session</a></p></li>
<li><p><a class="reference internal" href="#api-documentation" id="id19">API documentation</a></p></li>
</ul>
</li>
</ul>
</div>
<p>This section documents both the Secure User-Plane Location (SUPL) client library and the SUPL client OS integration library.</p>
<p>The Secure User-Plane Location (SUPL) client library is an OS-independent library that is distributed separately with a different license than the nRF Connect SDK.
This library can be used to receive A-GPS data from a SUPL server using the SUPL protocol.</p>
<p>The SUPL client OS integration library is a source code library distributed with the nRF Connect SDK.
This library is used to integrate the SUPL client library with an nRF Connect SDK application.</p>
<p>The SUPL client is used with a 3rd party SUPL server.
For example, Google hosts a SUPL server (supl.google.com), but for commercial use a license is required.</p>
<section id="secure-user-plane-location">
<h2><a class="toc-backref" href="#id8">Secure User-Plane Location</a><a class="headerlink" href="#secure-user-plane-location" title="Permalink to this heading"></a></h2>
<p>SUPL enables the transfer of assistance and network-based positioning data of a SUPL Enabled Terminal (SET), such as an nRF9160 DK or a Thingy:91, over an IP User Plane bearer.
See <a class="reference external" href="https://www.openmobilealliance.org/release/SUPL/V1_0-20060127-C/OMA-AD-SUPL-V1_0-20060127-C.pdf#page=16">SUPL context model</a> for more information on the SUPL architecture.
SUPL is designed to support future positioning technologies.
The SUPL version supported by the SUPL client library is 2.0.4.</p>
<p>SUPL uses <a class="reference external" href="https://en.wikipedia.org/wiki/Assisted_GPS">A-GPS</a> for obtaining GPS satellite data, overcoming limitations of a standalone GNSS module.</p>
<p>A standalone GNSS module downloads orbital data (like <a class="reference external" href="https://en.wikipedia.org/wiki/Ephemeris">Ephemeris</a> and the <a class="reference external" href="https://en.wikipedia.org/wiki/GPS_signals#Almanac">Almanac</a>) from satellites to calculate the current position of a device.
It has the following limitations:</p>
<ul class="simple">
<li><p>Typically, the data download from the satellites takes a long time and the first position is calculated in 30-40 seconds.</p></li>
<li><p>Any loss of signal requires the whole process to be restarted.</p></li>
</ul>
<p>An A-GPS server is a cached server that stores the orbital data.
This information can be downloaded at a fast rate since an A-GPS capable device supports mobile radio-network bearers with high data rate such as LTE.</p>
<section id="supl-payload">
<h3><a class="toc-backref" href="#id9">SUPL payload</a><a class="headerlink" href="#supl-payload" title="Permalink to this heading"></a></h3>
<p><a class="reference external" href="https://www.etsi.org/deliver/etsi_ts/136300_136399/136355/11.01.00_60/ts_136355v110100p.pdf#page=12">LTE Positioning Protocol (LPP)</a> is the supported SUPL payload format.</p>
<p>LPP is a point-to-point protocol used between a location server (for example, a <a class="reference external" href="https://en.wikipedia.org/wiki/Service_Location_Protocol">Secure Location Protocol (SLP)</a> server) and a target device (for example, SET) to position the device using position-based information obtained from reference sources.
A SET is a logical part of a device that supports communication with a SUPL network.</p>
</section>
<section id="supl-session-and-transaction-type">
<h3><a class="toc-backref" href="#id10">SUPL session and transaction type</a><a class="headerlink" href="#supl-session-and-transaction-type" title="Permalink to this heading"></a></h3>
<p>A typical SUPL client session is SET-based, that is, the position is calculated based on SET.
See <a class="reference external" href="https://www.openmobilealliance.org/release/SUPL/V2_0_4-20181213-A/OMA-TS-ULP-V2_0_4-20181213-A.pdf#page=128">SET-initiated SUPL collaboration</a> for more information.</p>
<p>Each LPP session consists of one or more LPP transactions.
Each LPP transaction corresponds to a single operation such as capability exchange, assistance data transfer, or location information transfer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The SUPL client library supports only assistance data transfer as the transaction type.</p>
</div>
<p>The following image shows the steps in the SUPL client connection session.</p>
<p class="mscgen">
msc {
hscale = &quot;1.1&quot;;
SET,SLP;
--- [label=&quot;Data connection setup&quot;];
SET=&gt;SLP      [label=&quot;SUPL START (session-id, lid, SET capabilities)&quot;];
SET&lt;=SLP      [label=&quot;SUPL RESPONSE (session-id, posmethod)&quot;];
SET=&gt;SLP      [label=&quot;SUPL POS INIT (session-id, lid, SET capabilities)&quot;];
SET..SLP [linecolor=&quot;#00a9ce&quot;, textcolor=&quot;#00a9ce&quot;, label=&quot;\nloop 1..N times&quot;];
SET&lt;=SLP      [label=&quot;SUPL POS (session-id, LPP)&quot;];
...;
SET..SLP [linecolor=&quot;#00a9ce&quot;];
SET&lt;&lt;SLP      [label=&quot;SUPL END (session-id)&quot;];
--- [label=&quot;Data connection teardown&quot;];
}
</p>
</section>
</section>
<section id="supl-client-library">
<span id="supl-client-lib"></span><h2><a class="toc-backref" href="#id11">SUPL client library</a><a class="headerlink" href="#supl-client-library" title="Permalink to this heading"></a></h2>
<p>The SUPL client library must be downloaded separately and integrated into the nRF Connect SDK by the user.
Before you download the library, read through the license on the webpage.
You must accept the license before you can download the library.</p>
<section id="downloading-and-installing">
<span id="download-supl"></span><h3><a class="toc-backref" href="#id12">Downloading and installing</a><a class="headerlink" href="#downloading-and-installing" title="Permalink to this heading"></a></h3>
<p>You can download the SUPL client library from the <a class="reference external" href="https://www.nordicsemi.com/Software-and-tools/Development-Kits/nRF9160-DK/Download#supl-c">nRF9160 DK product page</a>.</p>
<p>Download the nRF9160 SiP SUPL client library zip file and extract it into the <code class="file docutils literal notranslate"><span class="pre">nrf/ext/lib/bin/</span></code> folder.
Make sure to maintain the folder structure that is used in the zip file.</p>
</section>
<section id="configuration">
<h3><a class="toc-backref" href="#id13">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h3>
<p>To enable the SUPL client library, set <code class="xref kconfig kconfig-option docutils literal notranslate"><span class="pre">CONFIG_SUPL_CLIENT_LIB</span></code> to <code class="docutils literal notranslate"><span class="pre">y</span></code>.
See <a class="reference internal" href="../../getting_started/modifying.html#configure-application"><span class="std std-ref">Configuring your application</span></a> for information on how to change configuration options.</p>
</section>
<section id="resource-initialization-and-ownership">
<h3><a class="toc-backref" href="#id14">Resource initialization and ownership</a><a class="headerlink" href="#resource-initialization-and-ownership" title="Permalink to this heading"></a></h3>
<p>Two buffers are used in the SUPL communication session.
These buffers, namely the primary and secondary buffers, are owned by the user of the SUPL client library.
The sizes of the buffers are defined by the <code class="docutils literal notranslate"><span class="pre">LIBSUPL_PRI_BUF_SIZE</span></code> and <code class="docutils literal notranslate"><span class="pre">LIBSUPL_SEC_BUF_SIZE</span></code> parameters.
These parameters are defined in the <code class="docutils literal notranslate"><span class="pre">supl_session.h</span></code> header file.</p>
<p>The SUPL client library implements the following functionalities:</p>
<ul class="simple">
<li><p>Send messages to the SUPL server</p></li>
<li><p>Receive messages from the SUPL server</p></li>
<li><p>Send A-GPS data to the GNSS module</p></li>
</ul>
<p>These functionalities are implemented using a set of callback functions.
Both the buffers and the pointers to the callback functions are passed to the SUPL client library through the <code class="xref c c-func docutils literal notranslate"><span class="pre">supl_client_init()</span></code> function.</p>
</section>
<section id="api-callback-functions">
<h3><a class="toc-backref" href="#id15">API callback functions</a><a class="headerlink" href="#api-callback-functions" title="Permalink to this heading"></a></h3>
<p>Callback functions are needed to achieve platform independence.
If your application uses the SUPL client library, you must implement these callback functions.
For an example of the implementation, see the <a class="reference internal" href="../../samples/nrf9160/gnss/README.html#gnss-sample"><span class="std std-ref">nRF9160: GNSS</span></a> sample.
The implementation is located in the <code class="file docutils literal notranslate"><span class="pre">samples/nrf9160/gnss/src/</span></code> directory.
The various callback functions implemented in the SUPL client library and their purposes are listed below.</p>
<dl class="simple">
<dt>A-GPS handler</dt><dd><p>Callback function to handle nRF assistance data types defined in <a class="reference external" href="https://developer.nordicsemi.com/nRF_Connect_SDK/doc/latest/nrfxlib/nrf_modem/doc/api.html#a-gps-data-types">A-GPS data types</a>.
This callback writes the A-GPS data to the GNSS module.
The <a class="reference external" href="https://www.etsi.org/deliver/etsi_ts/136300_136399/136355/11.01.00_60/ts_136355v110100p.pdf#page=12">LTE Positioning Protocol (LPP)</a> data contained within the SUPL payload is converted to nRF A-GPS data structures defined in <code class="file docutils literal notranslate"><span class="pre">nrf_modem_gnss.h</span></code> that can be written directly using the GNSS API.</p>
</dd>
<dt>SUPL logger</dt><dd><p>Callback function to output the SUPL client library debug messages.
Callback implementation is optional.
If the callback function is not implemented, the library does not display debug messages.</p>
</dd>
<dt>Millisecond counter</dt><dd><p>Callback function for millisecond counter.
Callback implementation is optional.
If the callback function is not implemented, the library assumes 1 second receive timeout and estimates SUPL level timeouts based on that.</p>
</dd>
<dt>SUPL read</dt><dd><p>Callback function for receiving incoming data from the SUPL server.</p>
</dd>
<dt>SUPL write</dt><dd><p>Callback function for sending outgoing data to the SUPL server.</p>
</dd>
</dl>
</section>
<section id="supl-session">
<h3><a class="toc-backref" href="#id16">SUPL session</a><a class="headerlink" href="#supl-session" title="Permalink to this heading"></a></h3>
<p>The SUPL communication spans the following events and message transfers:</p>
<ul class="simple">
<li><p>Receiving an event from the GNSS module requesting to update A-GPS data</p></li>
<li><p>Executing subsequent message transfers until the completion of the A-GPS session</p></li>
<li><p>Pushing data into the GNSS module</p></li>
</ul>
<p>The following message sequence chart (MSC) describes the flow of communication in a SUPL session.</p>
<figure class="align-default">
<img alt="SUPL Session MSC" src="../../_images/supl_msc.svg" /></figure>
<p id="supl-session-msc-desc">The various steps in the communication session are described below:</p>
<ol class="arabic">
<li><p>The application receives a request from the GNSS to start a SUPL session.
GNSS sends the <code class="xref c c-macro docutils literal notranslate"><span class="pre">NRF_MODEM_GNSS_EVT_AGPS_REQ</span></code> event when it needs fresh A-GPS data.</p></li>
<li><p>If the LTE modem is deactivated, the user must enable the LTE modem.
When the modem is enabled, it initiates a TCP socket to connect to the SUPL server.
In the SUPL session MSC above, the application opens a TCP socket to connect to the SUPL server.</p></li>
<li><p>In order to start a SUPL session, the application must first initialize the SUPL client library.
This is done by calling the <a class="reference internal" href="#c.supl_init" title="supl_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">supl_init()</span></code></a> function of the SUPL client OS integration library.
The function sets up the API and the buffers required for initializing the SUPL client library and invokes the <code class="xref c c-func docutils literal notranslate"><span class="pre">supl_client_init()</span></code> function with these parameters.</p></li>
<li><p>The application can then begin the SUPL session by calling the <a class="reference internal" href="#c.supl_session" title="supl_session"><code class="xref c c-func docutils literal notranslate"><span class="pre">supl_session()</span></code></a> function with a copy of the <code class="xref c c-type docutils literal notranslate"><span class="pre">nrf_modem_gnss_agps_data_frame</span></code> data that was received through the A-GPS data request event from the GNSS module.
The SUPL client OS integration library generates the following parameters that are necessary for the session:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">supl_session_ctx_t</span></code> structure from the A-GPS request event data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lte_params_t</span></code> structure from the data read from the LTE modem</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">device_id</span></code> from device IP address</p></li>
</ul>
</li>
<li><p>The SUPL client OS integration library then starts the SUPL session by calling the <code class="xref c c-func docutils literal notranslate"><span class="pre">supl_client_session()</span></code> function from the SUPL client library with the <code class="docutils literal notranslate"><span class="pre">supl_session_ctx_t</span></code> parameter.
The application does not return from this function until the SUPL session is finished or the <code class="xref c c-func docutils literal notranslate"><span class="pre">supl_client_abort()</span></code> function is called.</p></li>
<li><p>The <code class="xref c c-func docutils literal notranslate"><span class="pre">supl_client_session()</span></code> function forms the entry point for the SUPL session.
There is no specific limit on the number of subsequent SUPL sessions that can be executed from this entry point.
See the documentation on the <a class="reference external" href="https://www.openmobilealliance.org/release/SUPL/V2_0_4-20181213-A/OMA-TS-ULP-V2_0_4-20181213-A.pdf#page=129">SET-Initiated Non-Roaming Successful Case (Proxy mode)</a> for more information on the SUPL session.
The callback functions used for data transfer are listed below:</p>
<blockquote>
<div><ul class="simple">
<li><p>SUPL write (<code class="xref c c-type docutils literal notranslate"><span class="pre">supl_write_t</span></code>): callback for sending outgoing data to the SUPL server</p></li>
<li><p>SUPL read (<code class="xref c c-type docutils literal notranslate"><span class="pre">supl_read_t</span></code>): callback for receiving incoming data from the SUPL server</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The decoded SUPL data is sent to the GNSS module using the A-GPS handler (<code class="xref c c-func docutils literal notranslate"><span class="pre">agps_handler_t()</span></code>) callback function.</p></li>
<li><p>After the application returns from the <code class="xref c c-func docutils literal notranslate"><span class="pre">supl_client_session()</span></code> function, the TCP socket is no longer used by the SUPL client library and can be closed.</p></li>
</ol>
</section>
</section>
<section id="supl-client-os-integration-library">
<h2><a class="toc-backref" href="#id17">SUPL client OS integration library</a><a class="headerlink" href="#supl-client-os-integration-library" title="Permalink to this heading"></a></h2>
<p>The SUPL client OS module integrates the SUPL client library into the nRF Connect SDK.</p>
<section id="id1">
<h3><a class="toc-backref" href="#id18">SUPL session</a><a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>Before starting a SUPL session, the application must initialize the SUPL client library by calling the <a class="reference internal" href="#c.supl_init" title="supl_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">supl_init()</span></code></a> function of the SUPL client OS integration library.
Once the library is initialized, any number of subsequent SUPL sessions can be executed with the same set of initialized parameters.</p>
<p>To start the SUPL session, the application must call the <a class="reference internal" href="#c.supl_session" title="supl_session"><code class="xref c c-func docutils literal notranslate"><span class="pre">supl_session()</span></code></a> function of the SUPL client OS integration library.
The library then creates the necessary parameters and starts the SUPL session in the SUPL client library.
The SUPL client OS integration library abstracts the details of the <a class="reference internal" href="#supl-client-lib"><span class="std std-ref">SUPL client library</span></a> away from the user.</p>
<p>See steps 3, 4 and 5 in the <a class="reference internal" href="#supl-session-msc-desc"><span class="std std-ref">SUPL session MSC description</span></a> for more information.</p>
</section>
<section id="api-documentation">
<h3><a class="toc-backref" href="#id19">API documentation</a><a class="headerlink" href="#api-documentation" title="Permalink to this heading"></a></h3>
<div class="line-block">
<div class="line">Header file: <code class="file docutils literal notranslate"><span class="pre">include/supl_os_client.h</span></code></div>
<div class="line">Source files: <code class="file docutils literal notranslate"><span class="pre">lib/supl/</span></code></div>
</div>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__supl__os"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">supl_os</span></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.supl_session">
<span class="target" id="group__supl__os_1ga29bcf93a1731f09636d0a524e9014752"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">supl_session</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">nrf_modem_gnss_agps_data_frame</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">agps_request</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.supl_session" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start a SUPL session. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agps_request</strong> – <strong>[in]</strong> This contain the information about the AGPS data that the GNSS module is requesting from the server.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 SUPL session was successful. &lt;0 SUPL session failed. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.supl_init">
<span class="target" id="group__supl__os_1ga74812fffa5178f38a33c6ee177d46460"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">supl_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">supl_api</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">api</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.supl_init" title="Permalink to this definition"></a><br /></dt>
<dd><p>Setup the API and the buffers required by the SUPL client library. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>api</strong> – <strong>[in]</strong> Function pointers to the API required by SUPL client library to work.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 SUPL client library was initialized successfully. &lt;0 Failed to initialize the SUPL client library. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tone.html" class="btn btn-neutral float-right" title="Tone generator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="st25r3911b_nfc.html" class="btn btn-neutral" title="NFC Reader ST25R3911B" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>