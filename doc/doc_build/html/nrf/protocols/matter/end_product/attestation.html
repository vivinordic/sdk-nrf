<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matter Device Attestation &mdash; nRF Connect SDK 2.3.99 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/nrf.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" /> 
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=G-ZPVZRKFQJR"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
        <script data-culture="EN" id="CookieConsent" type="text/javascript" src="https://policy.app.cookieinformation.com/uc.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
<script
  type="text/javascript"
  src="../../../_static/js/ncs.js"
></script>
<script src="../../../_static/js/bootstrap.bundle.min.js"></script>

    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Matter Distributed Compliance Ledger" href="dcl.html" />
    <link rel="prev" title="Factory provisioning in Matter" href="factory_provisioning.html" />
<link
  href="../../../_static/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="shortcut icon"
  href="../../../_static/images/favicon.ico"
/>

</head>

<body class="wy-body-for-nav">
<div class="announcement"></div>
<div class="d-print-none ncs-header">
  <div class="container-xl ncs-header-top">
    <div class="row h-100">
      <div class="d-none d-md-block col-2">
        <div class="bg-white py-4 px-3 ml-2 ncs-header-logo">
          <img
            class="ncs-header-logo"
            src="../../../_static/images/nordic-logo.png"
            alt=""
          />
        </div>
      </div>
      <div
        class="col-8 col-md-7 pl-md-4 d-flex align-self-center justify-content-center"
      >
        <form class="w-75" action="../../../search.html" method="get">
          <div class="form-group">
            <input
              type="text"
              name="q"
              class="ncs-search-input form-control"
              placeholder="Search all docs..."
            />
          </div>
        </form>
      </div>
      <div class="col-4 col-md-3 d-md-block p-3 text-end">
        <div class="dropdown">
          <button
            class="btn dropdown-toggle ncs-btn-versions"
            type="button"
            id="dropdownMenuButton1"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <span class="d-none d-md-inline">nRF Connect SDK</span>
            <span id="ncsversion" class="d-inline"></span>
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ncs-header-nav">
    <div class="container-xl">
      <div class="row">
        <div class="col col-12 d-flex justify-content-center">
          <nav class="navbar navbar-dark navbar-expand-lg p-0">
            <span class="navbar-brand d-block d-lg-none py-2 pl-1"
              >Documentation sets</span
            >
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNavAltMarkup"
              aria-controls="navbarNavAltMarkup"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <ul class="navbar-nav">
                <li class="nav-item active py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrf/index.html"
                    >nRF Connect SDK</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfx/index.html"
                    >nrfx</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../nrfxlib/README.html"
                    >nrfxlib</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../zephyr/index.html"
                    >Zephyr Project</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../mcuboot/wrapper.html"
                    >MCUboot</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../tfm/index.html"
                    >Trusted Firmware-M</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../matter/index.html"
                    >Matter</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="nav-item  py-1 px-3">
                  <a
                    class="nav-link"
                    href="../../../../kconfig/index.html"
                    >Kconfig Reference</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> nRF Connect SDK
          </a>
              <div class="version">
                2.3.99
              </div>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_model.html">Development model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app_dev.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecosystem_integration.html">Ecosystems integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf91.html">Working with nRF91 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf70.html">Working with nRF70 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf53.html">Working with nRF53 Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nrf52.html">Working with nRF52 Series</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../protocols.html">Protocols</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../ble/index.html">Bluetooth LE Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bt_mesh/index.html">Bluetooth mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../esb/index.html">Enhanced ShockBurst (ESB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gazell/index.html">Gazell</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Matter</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../overview/index.html">Matter overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/index.html">Getting started with Matter</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">How to create Matter end product</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="prerequisites.html">Matter device development prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="factory_provisioning.html">Factory provisioning in Matter</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Matter Device Attestation</a></li>
<li class="toctree-l4"><a class="reference internal" href="dcl.html">Matter Distributed Compliance Ledger</a></li>
<li class="toctree-l4"><a class="reference internal" href="certification.html">Matter certification</a></li>
<li class="toctree-l4"><a class="reference internal" href="bootloader.html">Bootloader configuration in Matter</a></li>
<li class="toctree-l4"><a class="reference internal" href="security.html">Securing production devices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../multiprotocol/index.html">Multiprotocol support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nfc/index.html">Near Field Communication (NFC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../thread/index.html">Thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wifi/index.html">Wi-Fi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../zigbee/index.html">Zigbee</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples.html">Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../libraries/index.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software_maturity.html">Software maturity levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation.html">About this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../../protocols.html">Protocols</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Matter</a></li>
          <li class="breadcrumb-item"><a href="index.html">How to create Matter end product</a></li>
      <li class="breadcrumb-item active">Matter Device Attestation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/protocols/matter/end_product/attestation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="matter-device-attestation">
<span id="ug-matter-device-attestation"></span><h1>Matter Device Attestation<a class="headerlink" href="#matter-device-attestation" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#device-attestation-within-commissioning" id="id11">Device Attestation within commissioning</a></p></li>
<li><p><a class="reference internal" href="#device-attestation-certificates" id="id12">Device Attestation certificates</a></p>
<ul>
<li><p><a class="reference internal" href="#public-key-infrastructure" id="id13">Public Key Infrastructure</a></p></li>
<li><p><a class="reference internal" href="#distributed-compliance-ledger" id="id14">Distributed Compliance Ledger</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#providing-device-with-device-attestation-data" id="id15">Providing device with Device Attestation data</a></p>
<ul>
<li><p><a class="reference internal" href="#getting-preliminary-device-attestation-data" id="id16">Getting preliminary Device Attestation data</a></p></li>
<li><p><a class="reference internal" href="#generating-factory-data" id="id17">Generating factory data</a></p></li>
<li><p><a class="reference internal" href="#requirements-for-secured-communication" id="id18">Requirements for secured communication</a></p></li>
<li><p><a class="reference internal" href="#device-attestation-data-overview" id="id19">Device Attestation data overview</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#device-attestation-procedure" id="id20">Device Attestation procedure</a></p></li>
<li><p><a class="reference internal" href="#testing-device-attestation-during-development" id="id21">Testing Device Attestation during development</a></p></li>
</ul>
</div>
<p>Device Attestation (DA) is a process of verifying if a Matter device is certified and is produced by a manufacturer that is member of <a class="reference external" href="https://csa-iot.org">Connectivity Standards Alliance</a>.
The goal is to ensure no counterfeit devices join the Matter network and that the device being checked is genuine.
The Device Attestation process is based on the chain-of-trust concept and is mandatory for all Matter devices.</p>
<section id="device-attestation-within-commissioning">
<h2><a class="toc-backref" href="#id11">Device Attestation within commissioning</a><a class="headerlink" href="#device-attestation-within-commissioning" title="Permalink to this heading"></a></h2>
<p>The Device Attestation verification process takes place during commissioning.
Before the commissioner can provision the new device to the Matter fabric (network), it must check the certificates of the device and obtain information about it.
To do this, the commissioner first establishes an encrypted session with the commissionee using Passcode-Authenticated Session Establishment (PASE) to ensure confidentiality of the communication.
It then proceeds to verify the device certificates.</p>
<p>To read more about Matter commissioning, see <a class="reference internal" href="../overview/commissioning.html#ug-matter-network-topologies-commissioning"><span class="std std-ref">Matter network commissioning</span></a>.</p>
</section>
<section id="device-attestation-certificates">
<span id="ug-matter-device-attestation-cert"></span><h2><a class="toc-backref" href="#id12">Device Attestation certificates</a><a class="headerlink" href="#device-attestation-certificates" title="Permalink to this heading"></a></h2>
<p>During the Device Attestation procedure, the commissioner checks the certificates on the device, among other things.
These certificates form a chain in which they mutually rely on each other.</p>
<p>All certificates come from Matter certification authorities (CAs).
The primary source of Matter certification authority policies is Connectivity Standards Alliance’s Test and Certification Oversight Committee (TCOC), which develops them in accordance with <a class="reference external" href="https://csa-iot.org/wp-content/uploads/2021/12/07-4842-14-ptsc-certification-policy.pdf">Connectivity Standards Alliance Certification Policy</a>.</p>
<p>CSA assigns the status of Product Attestation Authority (PAA) to selected organizations, which become root certificate authorities for the Device Attestation procedure.
Each PAA owns a key pair, which consists of a private and a public key, and the self-signed PAA certificate.
The private key is used by PAA to sign the certificates of the Product Attestation Intermediate (PAI), an entity that is directly in charge of issuing Device Attestation Certificates (DACs).
Each of PAI certificates is created in the form of Certificate Signing Request by the PAI and presented to the PAA, which sings it with its private key.</p>
<p>The PAI certificate is located at the middle level in the certification chain.
It also includes private and public keys assigned, and it is signed by the higher level PAA certificate that it originates from.
The PAI private key is used to sign the Device Attestation Certificates (DAC).
While a single PAI can only issue DACs belonging to a single device vendor, a single device vendor can operate multiple PAIs, for example in order to issue certificates for different product families.</p>
<figure class="align-default" id="id7">
<img alt="Device Attestation certification authorities" src="../../../_images/matter_device_attestation_ca.svg" /><figcaption>
<p><span class="caption-text">Device Attestation certification authorities</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="public-key-infrastructure">
<span id="ug-matter-device-attestation-cert-pki"></span><h3><a class="toc-backref" href="#id13">Public Key Infrastructure</a><a class="headerlink" href="#public-key-infrastructure" title="Permalink to this heading"></a></h3>
<p>The PAA, PAI, and DAC certificates form the Public Key Infrastructure (PKI), a security structure in which the authenticity of an entity is confirmed by another entity, and each such certificate chain ends with one of the PAA certificates.
The ownership of a certificate is proved using the associated private key.
This is the main reason for keeping the private keys protected.</p>
</section>
<section id="distributed-compliance-ledger">
<span id="ug-matter-device-attestation-cert-dcl"></span><h3><a class="toc-backref" href="#id14">Distributed Compliance Ledger</a><a class="headerlink" href="#distributed-compliance-ledger" title="Permalink to this heading"></a></h3>
<p>CSA’s TCOC also maintains the Distributed Compliance Ledger, a database for storing information about the certification status of different vendors.
It is the distribution point of PAA certificates.</p>
<figure class="align-default" id="id8">
<img alt="Device Attestation certification authorities with PKI and DCL" src="../../../_images/matter_device_attestation_ca_dcl_pki.svg" /><figcaption>
<p><span class="caption-text">Device Attestation certification authorities with PKI and DCL</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>To read more about DCL and how to use it, see the <a class="reference internal" href="dcl.html#ug-matter-device-dcl"><span class="std std-ref">Matter Distributed Compliance Ledger</span></a> page.</p>
</section>
</section>
<section id="providing-device-with-device-attestation-data">
<span id="ug-matter-device-attestation-device-data"></span><h2><a class="toc-backref" href="#id15">Providing device with Device Attestation data</a><a class="headerlink" href="#providing-device-with-device-attestation-data" title="Permalink to this heading"></a></h2>
<p>To pass the Device Attestation procedure, a Matter device that wants to join a Matter fabric must include a set of information required for the Device Attestation procedure.
This needs to be provided by the manufacturer.</p>
<section id="getting-preliminary-device-attestation-data">
<h3><a class="toc-backref" href="#id16">Getting preliminary Device Attestation data</a><a class="headerlink" href="#getting-preliminary-device-attestation-data" title="Permalink to this heading"></a></h3>
<p>To generate the required data, the manufacturer needs to get the following information from CSA:</p>
<ul class="simple">
<li><p>Vendor ID (VID) - A unique 16-bit number that identifies the manufacturer.
This can be obtained from CSA when the manufacturer becomes one of <a class="reference external" href="https://csa-iot.org/members/">Connectivity Standards Alliance members</a>.</p></li>
<li><p>Certification Declaration (CD) - A cryptographic document created by the CSA for each device type, used to confirm that a given type of device was certified.</p></li>
</ul>
<p>Once the manufacturer obtains this information, it uses it to generate the factory data or provides the information directly to the device (Certificate Declaration).
The manufacturer also needs to assign a unique 16-bit Product ID (PID) number to identify its product.</p>
<figure class="align-default" id="id9">
<img alt="Simplified view of Device Attestation information from manufacturer" src="../../../_images/matter_device_attestation_manufacturer_info.svg" /><figcaption>
<p><span class="caption-text">Simplified view of Device Attestation information from manufacturer</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The factory data must include PAI and DAC certificates, and the private key for DAC.
To generate these certificates for the factory data, the manufacturer can use one of the following options.</p>
<section id="generating-dac-with-pki-provider-option-1">
<h4>Generating DAC with PKI provider (option 1)<a class="headerlink" href="#generating-dac-with-pki-provider-option-1" title="Permalink to this heading"></a></h4>
<p>The manufacturer can request PAI and DAC from one of the PKI providers who are <a class="reference external" href="https://csa-iot.org/members/">Connectivity Standards Alliance members</a>.
This way, the manufacturer does not have to set up its own Certification Authority chain and can use a trusted source of certification that complies with the PKI certification policy.
The PKI provider’s PAA certificate does not contain any specific VID, which lets the provider serve multiple manufacturers.
The manufacturer’s PAI certificate generated from the PKI provider’s PAA certificate has the VID of the manufacturer and can be used to issue and sign DAC.</p>
</section>
<section id="generating-dac-using-own-pki-option-2">
<h4>Generating DAC using own PKI (option 2)<a class="headerlink" href="#generating-dac-using-own-pki-option-2" title="Permalink to this heading"></a></h4>
<p>The manufacturer can set up its own <a class="reference internal" href="#ug-matter-device-attestation-cert-pki"><span class="std std-ref">Public Key Infrastructure</span></a> to generate PAI and DAC certificates using its own existing PKI.
The rules for setting own PKI are outlined in the <a class="reference external" href="https://github.com/CHIP-Specifications/connectedhomeip-spec/blob/master/policies/matter_certificate_policy.adoc">Matter Certification Policy</a> document (authorized access required).
Setting up own PKI lets the manufacturer obtain the following certificates:</p>
<ul class="simple">
<li><p>Own PAA - Provided that the manufacturer has a certification authority with root in the DCL.
The PAA can have the VID embedded (VID-scoped PAA) or not (Non-Vendor Scoped PAA).</p></li>
<li><p>Own PAI - Provided that the manufacturer has sufficient and secure supply chain logistics that can provide DACs to a large number of devices, as each device has a unique DAC.</p></li>
</ul>
</section>
<section id="generating-dac-with-platform-vendor-option-3">
<h4>Generating DAC with platform vendor (option 3)<a class="headerlink" href="#generating-dac-with-platform-vendor-option-3" title="Permalink to this heading"></a></h4>
<p>This solution lets the device manufacturer develop products with SoCs that come with baked-in DACs.
In such case, the VID and the PID of the manufacturer will differ from the VID and the PID of the DAC.
The Certification Declaration will specify the DAC owner in the <code class="docutils literal notranslate"><span class="pre">dac_origin_vid</span></code> and <code class="docutils literal notranslate"><span class="pre">dac_origin_pid</span></code> fields.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Nordic Semiconductor does not currently offer this option.</p>
</div>
</section>
</section>
<section id="generating-factory-data">
<span id="ug-matter-device-attestation-device-data-generating"></span><h3><a class="toc-backref" href="#id17">Generating factory data</a><a class="headerlink" href="#generating-factory-data" title="Permalink to this heading"></a></h3>
<p>After the manufacturer obtains VID, PID, CD, PAI, and DAC, it can gather them in the factory data that is written to the device during the manufacturing process.
The device stores the factory data in the factory data partition, separately from the firmware.
This is because the factory data is different for each device instance, while the firmware stays the same for the entire device line.
Using a separate partition lets the manufacturer to apply write protection on device boot.
Dedicating a separate partition for this purpose lets avoid recertification when the device’s final application changes.</p>
<p>For information about how to generate the factory data, read the detailed <span class="xref std std-doc">matter:nrfconnect_factory_data_configuration</span> guide in the Matter documentation.</p>
</section>
<section id="requirements-for-secured-communication">
<h3><a class="toc-backref" href="#id18">Requirements for secured communication</a><a class="headerlink" href="#requirements-for-secured-communication" title="Permalink to this heading"></a></h3>
<p>Before the commissioner can verify the DAC information, it must establish a secure PASE session, which is required for sending commissioning messages, including the <a class="reference internal" href="#device-attestation-procedure">Device Attestation procedure</a>.</p>
<p>The Verifier is used for this purpose.
This is one of the input values of the underlying SPAKE2+ protocol.
It is a cryptographic key that is created by the manufacturer using Salt, Iteration Count, and Passcode values, and saved to the device as part of its factory data.</p>
</section>
<section id="device-attestation-data-overview">
<h3><a class="toc-backref" href="#id19">Device Attestation data overview</a><a class="headerlink" href="#device-attestation-data-overview" title="Permalink to this heading"></a></h3>
<p>Once all the required Device Attestation data is obtained, the manufacturer’s device will contain the following information unique to it:</p>
<dl>
<dt>Device Attestation Certificate</dt><dd><p>A Device Attestation Certificate (DAC) is used for the Device Attestation process and to perform commissioning into a fabric.
The DAC is a DER-encoded X.509v3-compliant certificate, as defined in RFC 5280.
It is created using the Product Attestation Intermediate certificate and contains information about Vendor ID and Product ID for the given device.</p>
</dd>
<dt>Private key that matches DAC</dt><dd><p>A private key associated with the DAC, unique to the device.
This key must be protected from leaking and maximum security must be guaranteed when generating it as part of the factory data.</p>
</dd>
<dt>Product Attestation Intermediate certificate</dt><dd><p>A Product Attestation Intermediate (PAI) certificate is a type of document issued by the Product Attestation Authority (PAA).
It is used to create the DAC of the device and is provided with the factory data.</p>
</dd>
<dt>Verifier</dt><dd><p>The Verifier itself is not a part of the DAC.
See <a class="reference internal" href="#requirements-for-secured-communication">Requirements for secured communication</a>.</p>
</dd>
<dt>Certification Declaration</dt><dd><p>A cryptographic document created by the CSA for each device type, used to confirm that a given type of device was certified.
It contains a series of information required for Device Attestation, including Vendor ID, Certificate ID, certification type, optional information related to DAC, and other.
CD is included in the attestation information packet send by the commissionee during the <a class="reference internal" href="#device-attestation-procedure">Device Attestation procedure</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CD information is not located in the factory data, but in the application itself.</p>
</div>
</dd>
</dl>
<p>These are the elements that are checked and validated by the commissioner at the start of the commissioning procedure.</p>
</section>
</section>
<section id="device-attestation-procedure">
<h2><a class="toc-backref" href="#id20">Device Attestation procedure</a><a class="headerlink" href="#device-attestation-procedure" title="Permalink to this heading"></a></h2>
<p>The following figure shows the complete overview of the Device Attestation data, with its different actors, dependencies, and stages.</p>
<figure class="align-default" id="id10">
<img alt="Device Attestation procedure overview" src="../../../_images/matter_device_attestation.svg" /><figcaption>
<p><span class="caption-text">Device Attestation procedure overview</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The procedure is structured into the following steps:</p>
<ol class="arabic simple">
<li><p>The commissioner generates a random 32-byte attestation nonce.</p></li>
<li><p>The commissioner sends the attestation nonce to the commissionee and requests the attestation information using an appropriate command.</p></li>
<li><p>The commissionee returns the attestation information packet to the commissioner using an appropriate command.
The packet is signed and encoded, and contains the following information:</p>
<ul class="simple">
<li><p>Certification Declaration</p></li>
<li><p>Attestation nonce</p></li>
<li><p>Timestamp</p></li>
<li><p>Optional firmware information</p></li>
</ul>
</li>
<li><p>The commissioner validates the information received from the commissionee.
During the validation, the commissioner confirms the attestation information received against information contained on the device.
For example, the Vendor ID from the attestation information packet is vetted against the Vendor ID in the DAC and the Basic Information cluster, the Certificate ID from the CD is verified against the entry in the DCL, and so on.
For the detailed list of what information undergoes verification, see chapter 6.2.3.1 (Attestation Validation Information) in the <a class="reference external" href="https://csa-iot.org/developer-resource/specifications-download-request/">Matter Core Specification</a>.</p></li>
</ol>
<p>A device that passes the Device Attestation procedure has been verified as an authentic Matter device.
The commissioner can then proceed to the next stage of <a class="reference internal" href="../overview/commissioning.html#ug-matter-network-topologies-commissioning"><span class="std std-ref">Matter network commissioning</span></a>, which may succeed or not.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The DAC is never removed from the device and stays on the device for later use, for example for commissioning onto a new network.
It can be overwritten only with the change of the factory data.</p>
</div>
</section>
<section id="testing-device-attestation-during-development">
<h2><a class="toc-backref" href="#id21">Testing Device Attestation during development</a><a class="headerlink" href="#testing-device-attestation-during-development" title="Permalink to this heading"></a></h2>
<p>If you want to test Device Attestation during development, you can generate the factory data for integration testing.
Read the detailed <span class="xref std std-doc">matter:nrfconnect_factory_data_configuration</span> guide in the Matter documentation for more information.</p>
<p>The factory data created for integration testing is not to be included in final end products.</p>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dcl.html" class="btn btn-neutral float-right" title="Matter Distributed Compliance Ledger" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="factory_provisioning.html" class="btn btn-neutral" title="Factory provisioning in Matter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2023, Nordic Semiconductor.
      Last updated on Mar 20, 2023.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../../_static/images/nordic-logo.png" border="0"/></a>
</td>
</tr>
</table>
  </div> 


</footer>

<div id="scroll-container">
  <button type="button" id="scroll-btn" class="btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="#fff"/></svg>
  </button>
</div>

<script>
  const scrollBtn = document.querySelector("#scroll-btn");

  document.addEventListener("scroll", () => {
    if (window.scrollY > 400) {
          scrollBtn.style.visibility = "visible";
      } else {
          scrollBtn.style.visibility = "hidden";
      }
  });

  scrollBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> nRF Connect SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version ncs">
        <a href="../../../../nrf/index.html">nRF Connect SDK</a>
      </div>
      
      <div class="rst-other-version nrfx">
        <a href="../../../../nrfx/index.html">nrfx</a>
      </div>
      
      <div class="rst-other-version nrfxlib">
        <a href="../../../../nrfxlib/README.html">nrfxlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version tfm">
        <a href="../../../../tfm/index.html">Trusted Firmware-M</a>
      </div>
      
      <div class="rst-other-version matter">
        <a href="../../../../matter/index.html">Matter</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>